<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mmrm">
<title>Package Introduction • mmrm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Package Introduction">
<meta property="og:description" content="mmrm">
<meta property="og:image" content="https://openpharma.github.io/mmrm/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.12</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Introduction</h6>
    <a class="dropdown-item" href="../articles/introduction.html">Package Introduction</a>
    <a class="dropdown-item" href="../articles/methodological_introduction.html">Mixed Models for Repeated Measures</a>
    <a class="dropdown-item" href="../articles/mmrm_review_methods.html">Comparison with other software</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Covariance Structures</h6>
    <a class="dropdown-item" href="../articles/covariance.html">Covariance Structures</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Degrees of Freedom and Testing</h6>
    <a class="dropdown-item" href="../articles/hypothesis_testing.html">Details of Hypothesis Testing</a>
    <a class="dropdown-item" href="../articles/between_within.html">Between-Within</a>
    <a class="dropdown-item" href="../articles/kenward.html">Kenward-Roger</a>
    <a class="dropdown-item" href="../articles/satterthwaite.html">Satterthwaite</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Coefficient Covariance</h6>
    <a class="dropdown-item" href="../articles/coef_vcov.html">Coefficients Covariance Matrix Adjustment</a>
    <a class="dropdown-item" href="../articles/empirical_wls.html">Details of Weighted Least Square Empirical Covariance</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Algorithm Details</h6>
    <a class="dropdown-item" href="../articles/algorithm.html">Model Fitting Algorithm</a>
    <a class="dropdown-item" href="../articles/predict.html">Prediction and Simulation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Developers</h6>
    <a class="dropdown-item" href="../articles/package_structure.html">Package Structure</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<!-- start dropdown for versions --> <li class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle"
          data-bs-toggle="dropdown" role="button"
          aria-expanded="false" aria-haspopup="true"
          id="dropdown-versions">Versions</a> <div class="dropdown-menu" aria-labelledby="dropdown-versions"> <a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.13">v0.3.13</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.12">v0.3.12</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.11">v0.3.11</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.10">v0.3.10</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.7">v0.3.7</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.6">v0.3.6</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.5">v0.3.5</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.4">v0.3.4</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.3">v0.3.3</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.2">v0.3.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.1">v0.3.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.0">v0.3.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.2.2">v0.2.2</a> </div></li>
<!-- end dropdown for versions -->
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-reports">Reports</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-reports">
    <a class="dropdown-item" href="../coverage-report/">Coverage report</a>
    <a class="dropdown-item" href="../unit-test-report/">Unit test report</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/openpharma/mmrm">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Package Introduction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/mmrm/blob/HEAD/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="common-usage">Common usage<a class="anchor" aria-label="anchor" href="#common-usage"></a>
</h2>
<p>A minimal call of <code><a href="../reference/mmrm.html">mmrm()</a></code>, consisting of only formula and
data arguments will produce an object of class <code>mmrm</code>,
<code>mmrm_fit</code>, and <code>mmrm_tmb</code>.</p>
<p>Here we fit a mmrm model with <code>us</code> (unstructured)
covariance structure specified, as well as the defaults of
<code>reml = TRUE</code> and <code>control = mmrm_control()</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://openpharma.github.io/mmrm/">mmrm</a></span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The code specifies an MMRM with the given covariates and an
unstructured covariance matrix for the timepoints (also called visits in
the clinical trial context, here given by <code>AVISIT</code>) within
the subjects (here <code>USUBJID</code>). While by default this uses
restricted maximum likelihood (REML), it is also possible to use ML, see
<code><a href="../reference/mmrm.html">?mmrm</a></code>.</p>
<p>Printing the object will show you output which should be familiar to
anyone who has used any popular modeling functions such as
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">stats::lm()</a></code>, <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code>,
<code><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html" class="external-link">glmmTMB::glmmTMB()</a></code>, and <code><a href="https://rdrr.io/pkg/lme4/man/nlmer.html" class="external-link">lme4::nlmer()</a></code>. From
this print out we see the function call, the data used, the covariance
structure with number of variance parameters, as well as the likelihood
method, and model deviance achieved. Additionally the user is provided a
printout of the estimated coefficients and the model convergence
information:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    3386.45</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                   30.77747548                    1.53049977 </span></span>
<span><span class="co">#&gt;                     RACEWhite                     SEXFemale </span></span>
<span><span class="co">#&gt;                    5.64356535                    0.32606192 </span></span>
<span><span class="co">#&gt;                      ARMCDTRT                    AVISITVIS2 </span></span>
<span><span class="co">#&gt;                    3.77423004                    4.83958845 </span></span>
<span><span class="co">#&gt;                    AVISITVIS3                    AVISITVIS4 </span></span>
<span><span class="co">#&gt;                   10.34211288                   15.05389826 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS2           ARMCDTRT:AVISITVIS3 </span></span>
<span><span class="co">#&gt;                   -0.04192625                   -0.69368537 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                    0.62422703 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method then provides the coefficients
table with Satterthwaite degrees of freedom as well as the covariance
matrix estimate:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Method:      Satterthwaite</span></span>
<span><span class="co">#&gt; Vcov Method: Asymptotic</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model selection criteria:</span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance </span></span>
<span><span class="co">#&gt;   3406.4   3439.3  -1693.2   3386.4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                                Estimate Std. Error        df t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)                    30.77748    0.88656 218.80000  34.715  &lt; 2e-16</span></span>
<span><span class="co">#&gt; RACEBlack or African American   1.53050    0.62448 168.67000   2.451 0.015272</span></span>
<span><span class="co">#&gt; RACEWhite                       5.64357    0.66561 157.14000   8.479 1.56e-14</span></span>
<span><span class="co">#&gt; SEXFemale                       0.32606    0.53195 166.13000   0.613 0.540744</span></span>
<span><span class="co">#&gt; ARMCDTRT                        3.77423    1.07415 145.55000   3.514 0.000589</span></span>
<span><span class="co">#&gt; AVISITVIS2                      4.83959    0.80172 143.88000   6.037 1.27e-08</span></span>
<span><span class="co">#&gt; AVISITVIS3                     10.34211    0.82269 155.56000  12.571  &lt; 2e-16</span></span>
<span><span class="co">#&gt; AVISITVIS4                     15.05390    1.31281 138.47000  11.467  &lt; 2e-16</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS2            -0.04193    1.12932 138.56000  -0.037 0.970439</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS3            -0.69369    1.18765 158.17000  -0.584 0.559996</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS4             0.62423    1.85085 129.72000   0.337 0.736463</span></span>
<span><span class="co">#&gt;                                  </span></span>
<span><span class="co">#&gt; (Intercept)                   ***</span></span>
<span><span class="co">#&gt; RACEBlack or African American *  </span></span>
<span><span class="co">#&gt; RACEWhite                     ***</span></span>
<span><span class="co">#&gt; SEXFemale                        </span></span>
<span><span class="co">#&gt; ARMCDTRT                      ***</span></span>
<span><span class="co">#&gt; AVISITVIS2                    ***</span></span>
<span><span class="co">#&gt; AVISITVIS3                    ***</span></span>
<span><span class="co">#&gt; AVISITVIS4                    ***</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS2              </span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS3              </span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS4              </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariance estimate:</span></span>
<span><span class="co">#&gt;         VIS1    VIS2    VIS3    VIS4</span></span>
<span><span class="co">#&gt; VIS1 40.5537 14.3960  4.9747 13.3867</span></span>
<span><span class="co">#&gt; VIS2 14.3960 26.5715  2.7855  7.4745</span></span>
<span><span class="co">#&gt; VIS3  4.9747  2.7855 14.8979  0.9082</span></span>
<span><span class="co">#&gt; VIS4 13.3867  7.4745  0.9082 95.5568</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="common-customizations">Common customizations<a class="anchor" aria-label="anchor" href="#common-customizations"></a>
</h2>
<p>From the high-level <a href="https://openpharma.github.io/mmrm/main/reference/mmrm.html"><code>mmrm()</code></a>
interface, common changes to the default function call can be
specified.</p>
<div class="section level3">
<h3 id="control-function">Control Function<a class="anchor" aria-label="anchor" href="#control-function"></a>
</h3>
<p>For fine control, <a href="https://openpharma.github.io/mmrm/main/reference/mmrm_control.html"><code>mmrm_control()</code></a>
is provided. This function allows the user to choose the adjustment
method for the degrees of freedom and the coefficients covariance
matrix, specify optimization routines, number of cores to be used on
Unix systems for trying several optimizers in parallel, provide a vector
of starting parameter values, decide the action to be taken when the
defined design matrix is singular, not drop unobserved visit levels. For
example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mmrm_control.html">mmrm_control</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"Kenward-Roger"</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L-BFGS-B"</span>, <span class="st">"BFGS"</span><span class="op">)</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  accept_singular <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop_visit_levels <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note that this control list can either be passed via the
<code>control</code> argument to <code>mmrm</code>, or selected controls
can be directly specified in the <code>mmrm</code> call. We will see
this below.</p>
<div class="section level4">
<h4 id="starting-values">Starting Values<a class="anchor" aria-label="anchor" href="#starting-values"></a>
</h4>
<p>The starting values will affect the optimization result. A better
starting value usually can make the optimization more efficient. In
<code>mmrm</code> we provide two starting value functions, one is
<code>std_start</code> and the other is <code>emp_start</code>.
<code>std_start</code> will try to use the identity matrix as the
covariance, however there are convergence problems for <code>ar1</code>
and <code>ar1h</code> if the identity matrix is provided, thus for these
two covariance structures we use <span class="math inline">\(\rho=0.5\)</span> instead. <code>emp_start</code>
will try to use the empirical covariance matrix of the residuals of the
ordinary least squares model as the starting value for unstructured
covariance structure. If some timepoints are missing from data, identity
matrix will be used for that submatrix. The correlation between existing
and non-existing timepoints are set to 0.</p>
<p>As the starting values will affect the result, please be cautious on
choosing the starting values.</p>
<div class="section level5">
<h5 id="example-of-default-starting-value-fails">Example of Default Starting Value Fails<a class="anchor" aria-label="anchor" href="#example-of-default-starting-value-fails"></a>
</h5>
<p>Here we provide an example where the <code>std_start</code> fails. In
the following code chunk, we will create a dummy dataset for mmrm
analysis.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gen_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">n</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    <span class="va">mu</span> <span class="op">=</span> <span class="op">-</span><span class="fl">100</span> <span class="op">/</span> <span class="fl">52</span>,</span>
<span>    <span class="va">delta</span> <span class="op">=</span> <span class="fl">50</span> <span class="op">/</span> <span class="fl">52</span>,</span>
<span>    <span class="va">mua</span> <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>    <span class="va">sigmaa</span> <span class="op">=</span> <span class="fl">300</span>,</span>
<span>    <span class="va">sigmab</span> <span class="op">=</span> <span class="fl">60</span>,</span>
<span>    <span class="va">corab</span> <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    <span class="va">sigma</span> <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    <span class="va">times</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">6</span>, <span class="fl">12</span>, <span class="fl">24</span>, <span class="fl">36</span>, <span class="fl">52</span>, <span class="fl">70</span>, <span class="fl">88</span>, <span class="fl">104</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">nt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    pts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">nt</span><span class="op">)</span>,</span>
<span>    trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Treatment"</span>, <span class="st">"Placebo"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">nt</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">n</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">covab</span> <span class="op">&lt;-</span> <span class="va">corab</span> <span class="op">*</span> <span class="va">sigmaa</span> <span class="op">*</span> <span class="va">sigmab</span> <span class="co"># cov between a and b</span></span>
<span>  <span class="va">cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sigmaa</span><span class="op">^</span><span class="fl">2</span>, <span class="va">covab</span>, <span class="va">covab</span>, <span class="va">sigmab</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Cov matrix for the slope and intercept</span></span>
<span>  <span class="va">si</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mua</span>, <span class="va">mu</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">cov</span><span class="op">)</span>,</span>
<span>    <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mua</span>, <span class="va">mu</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">cov</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">nt</span><span class="op">)</span></span>
<span>  <span class="va">out</span><span class="op">$</span><span class="va">fev1</span> <span class="op">&lt;-</span> <span class="va">si</span><span class="op">[</span><span class="va">idx</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">si</span><span class="op">[</span><span class="va">idx</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">times</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">nt</span> <span class="op">*</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span>  <span class="va">out</span><span class="op">$</span><span class="va">trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">trt</span><span class="op">)</span></span>
<span>  <span class="va">out</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span>  <span class="va">out</span><span class="op">$</span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">pts</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">gen_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>In the generated data, the variance is not in the same scale across
visits.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">fev1</span>, <span class="va">out</span><span class="op">$</span><span class="va">time</span><span class="op">)</span>, <span class="va">sd</span>, FUN.VALUE <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;         0         2         6        12        24        36        52        70 </span></span>
<span><span class="co">#&gt;  278.6079  319.0589  482.4172  799.9107 1491.1440 2194.5776 3140.0768 4204.9355 </span></span>
<span><span class="co">#&gt;        88       104 </span></span>
<span><span class="co">#&gt; 5272.6041 6221.2195</span></span></code></pre></div>
<p>Using <code>emp_start</code> as the starting value, <code>mmrm</code>
will converge fast.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span><span class="va">fev1</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">*</span> <span class="va">time</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">time</span> <span class="op">|</span> <span class="va">pts</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">out</span>, start <span class="op">=</span> <span class="va">emp_start</span><span class="op">)</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     fev1 ~ trt * time + us(time | pts)</span></span>
<span><span class="co">#&gt; Data:        out (used 2000 observations from 200 subjects with maximum 10 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (55 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    19154.63</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;          (Intercept)         trtTreatment                time2 </span></span>
<span><span class="co">#&gt;         1962.6980059           11.3831958            0.2130684 </span></span>
<span><span class="co">#&gt;                time6               time12               time24 </span></span>
<span><span class="co">#&gt;           -1.6901336           -1.1984277           -7.3954489 </span></span>
<span><span class="co">#&gt;               time36               time52               time70 </span></span>
<span><span class="co">#&gt;          -11.4078895          -15.8040920          -22.5556524 </span></span>
<span><span class="co">#&gt;               time88              time104   trtTreatment:time2 </span></span>
<span><span class="co">#&gt;          -28.2068895          -33.6608067            6.0436315 </span></span>
<span><span class="co">#&gt;   trtTreatment:time6  trtTreatment:time12  trtTreatment:time24 </span></span>
<span><span class="co">#&gt;           27.3686373           49.4246567          107.3638488 </span></span>
<span><span class="co">#&gt;  trtTreatment:time36  trtTreatment:time52  trtTreatment:time70 </span></span>
<span><span class="co">#&gt;          161.4310444          233.6438342          316.7387101 </span></span>
<span><span class="co">#&gt;  trtTreatment:time88 trtTreatment:time104 </span></span>
<span><span class="co">#&gt;          397.9895967          471.8871913 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
<p>However, if we use <code>std_start</code>, there will be convergence
problems. We can also force a specific optimization algorithm and add
control details, here e.g. choosing <code>nlminb</code> with increased
maximum number of function evaluations and iterations.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  <span class="va">fev1</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">*</span> <span class="va">time</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">time</span> <span class="op">|</span> <span class="va">pts</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">out</span>,</span>
<span>  start <span class="op">=</span> <span class="va">std_start</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="st">"nlminb"</span>,</span>
<span>  optimizer_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>eval.max <span class="op">=</span> <span class="fl">1000</span>, iter.max <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="reml-or-ml">REML or ML<a class="anchor" aria-label="anchor" href="#reml-or-ml"></a>
</h3>
<p>Users can specify if REML should be used (default) or if ML should be
used in optimization.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  reml <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_ml</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   ML</span></span>
<span><span class="co">#&gt; Deviance:    3397.934</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                    30.9663423                     1.5086851 </span></span>
<span><span class="co">#&gt;                     RACEWhite                      ARMCDTRT </span></span>
<span><span class="co">#&gt;                     5.6133151                     3.7761037 </span></span>
<span><span class="co">#&gt;                    AVISITVIS2                    AVISITVIS3 </span></span>
<span><span class="co">#&gt;                     4.8270155                    10.3353319 </span></span>
<span><span class="co">#&gt;                    AVISITVIS4           ARMCDTRT:AVISITVIS2 </span></span>
<span><span class="co">#&gt;                    15.0487715                    -0.0156154 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS3           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                    -0.6663598                     0.6317222 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="optimizer">Optimizer<a class="anchor" aria-label="anchor" href="#optimizer"></a>
</h3>
<p>Users can specify which optimizer should be used, changing from the
default of four optimizers, which starts with <code>L-BFGS-B</code> and
proceeds through the other choices if optimization fails to converge.
Other choices are <code>BFGS</code>, <code>CG</code>,
<code>nlminb</code> and other user-defined custom optimizers.</p>
<p><code>L-BFGS-B</code>, <code>BFGS</code> and <code>CG</code> are all
implemented with <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim()</a></code> and the Hessian is not
used, while <code>nlminb</code> is using <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb()</a></code>
which in turn uses both the gradient and the Hessian (by default but can
be switch off) for the optimization.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="st">"BFGS"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_opt</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    3387.373</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                   30.96768936                    1.50467465 </span></span>
<span><span class="co">#&gt;                     RACEWhite                      ARMCDTRT </span></span>
<span><span class="co">#&gt;                    5.61310613                    3.77554452 </span></span>
<span><span class="co">#&gt;                    AVISITVIS2                    AVISITVIS3 </span></span>
<span><span class="co">#&gt;                    4.82858600                   10.33317622 </span></span>
<span><span class="co">#&gt;                    AVISITVIS4           ARMCDTRT:AVISITVIS2 </span></span>
<span><span class="co">#&gt;                   15.05257117                   -0.01735504 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS3           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                   -0.66752133                    0.63095590 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: No message provided.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="covariance-structure">Covariance Structure<a class="anchor" aria-label="anchor" href="#covariance-structure"></a>
</h3>
<p>Covariance structures supported by the <code>mmrm</code> are being
continuously developed. For a complete list and description please visit
the <a href="covariance.html">covariance vignette</a>. Below we see the
function call for homogeneous compound symmetry (<code>cs</code>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">cs</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  reml <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_cs</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + cs(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  compound symmetry (2 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   ML</span></span>
<span><span class="co">#&gt; Deviance:    3536.989</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                    31.4207077                     0.5357237 </span></span>
<span><span class="co">#&gt;                     RACEWhite                      ARMCDTRT </span></span>
<span><span class="co">#&gt;                     5.4546329                     3.4305212 </span></span>
<span><span class="co">#&gt;                    AVISITVIS2                    AVISITVIS3 </span></span>
<span><span class="co">#&gt;                     4.8326353                    10.2395076 </span></span>
<span><span class="co">#&gt;                    AVISITVIS4           ARMCDTRT:AVISITVIS2 </span></span>
<span><span class="co">#&gt;                    15.0672680                     0.2801641 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS3           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                    -0.5894964                     0.7939750 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
<p>The time points have to be unique for each subject. That is, there
cannot be time points with multiple observations for any subject. The
rationale is that these observations would need to be correlated, but it
is not possible within the currently implemented covariance structure
framework to do that correctly. Moreover, for non-spatial covariance
structures, the time variable must be coded as a factor.</p>
</div>
<div class="section level3">
<h3 id="weighting">Weighting<a class="anchor" aria-label="anchor" href="#weighting"></a>
</h3>
<p>Users can perform weighted MMRM by specifying a numeric vector
<code>weights</code> with positive values.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  weights <span class="op">=</span> <span class="va">fev_data</span><span class="op">$</span><span class="va">WEIGHT</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_wt</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Weights:     fev_data$WEIGHT</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    3476.526</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                   31.20065229                    1.18452837 </span></span>
<span><span class="co">#&gt;                     RACEWhite                      ARMCDTRT </span></span>
<span><span class="co">#&gt;                    5.36525917                    3.39695951 </span></span>
<span><span class="co">#&gt;                    AVISITVIS2                    AVISITVIS3 </span></span>
<span><span class="co">#&gt;                    4.85890820                   10.03942420 </span></span>
<span><span class="co">#&gt;                    AVISITVIS4           ARMCDTRT:AVISITVIS2 </span></span>
<span><span class="co">#&gt;                   14.79354054                    0.03418184 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS3           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                    0.01308088                    0.86701567 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="grouped-covariance-structure">Grouped Covariance Structure<a class="anchor" aria-label="anchor" href="#grouped-covariance-structure"></a>
</h3>
<p>Grouped covariance structures are supported by the<code>mmrm</code>
package. Covariance matrices for each group are identically structured
(unstructured, compound symmetry, etc) but the estimates are allowed to
vary across groups. We use the form
<code>cs(time | group / subject)</code> to specify the group
variable.</p>
<p>Here is an example of how we use <code>ARMCD</code> as group
variable.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">cs</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">ARMCD</span> <span class="op">/</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  reml <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/mmrm_tmb_methods.html">VarCorr</a></span><span class="op">(</span><span class="va">fit_cs</span><span class="op">)</span></span>
<span><span class="co">#&gt; $PBO</span></span>
<span><span class="co">#&gt;           VIS1      VIS2      VIS3      VIS4</span></span>
<span><span class="co">#&gt; VIS1 37.823638  3.601296  3.601296  3.601296</span></span>
<span><span class="co">#&gt; VIS2  3.601296 37.823638  3.601296  3.601296</span></span>
<span><span class="co">#&gt; VIS3  3.601296  3.601296 37.823638  3.601296</span></span>
<span><span class="co">#&gt; VIS4  3.601296  3.601296  3.601296 37.823638</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TRT</span></span>
<span><span class="co">#&gt;          VIS1     VIS2     VIS3     VIS4</span></span>
<span><span class="co">#&gt; VIS1 49.58110 10.98112 10.98112 10.98112</span></span>
<span><span class="co">#&gt; VIS2 10.98112 49.58110 10.98112 10.98112</span></span>
<span><span class="co">#&gt; VIS3 10.98112 10.98112 49.58110 10.98112</span></span>
<span><span class="co">#&gt; VIS4 10.98112 10.98112 10.98112 49.58110</span></span></code></pre></div>
<p>We can see that the estimated covariance matrices are different in
different <code>ARMCD</code> groups.</p>
</div>
<div class="section level3">
<h3 id="adjustment-method">Adjustment Method<a class="anchor" aria-label="anchor" href="#adjustment-method"></a>
</h3>
<p>In additional to the residual and Between-Within degrees of freedom,
both Satterthwaite and Kenward-Roger adjustment methods are available.
The default is Satterthwaite adjustment of the degrees of freedom. To
use e.g. the Kenward-Roger adjustment of the degrees of freedom as well
as the coefficients covariance matrix, use the <code>method</code>
argument:</p>
<p>A list of all allowed <code>method</code> is</p>
<ol style="list-style-type: decimal">
<li>“Kenward-Roger”</li>
<li>“Satterthwaite”</li>
<li>“Residual”</li>
<li>“Between-Within”</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_kr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Kenward-Roger"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note that this requires <code>reml = TRUE</code>, i.e. Kenward-Roger
adjustment is not possible when using maximum likelihood inference.
While this adjustment choice is not visible in the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>
result of the fitted model (because the initial model fit is not
affected by the choice of the adjustment method), looking at the
<code>summary</code> we see the method and the correspondingly adjusted
standard errors and degrees of freedom:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_kr</span><span class="op">)</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Method:      Kenward-Roger</span></span>
<span><span class="co">#&gt; Vcov Method: Kenward-Roger</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model selection criteria:</span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance </span></span>
<span><span class="co">#&gt;   3407.4   3440.2  -1693.7   3387.4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                                Estimate Std. Error        df t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)                    30.96770    0.83335 187.91000  37.160  &lt; 2e-16</span></span>
<span><span class="co">#&gt; RACEBlack or African American   1.50465    0.62901 169.95000   2.392  0.01784</span></span>
<span><span class="co">#&gt; RACEWhite                       5.61310    0.67139 158.87000   8.360 2.98e-14</span></span>
<span><span class="co">#&gt; ARMCDTRT                        3.77556    1.07910 146.27000   3.499  0.00062</span></span>
<span><span class="co">#&gt; AVISITVIS2                      4.82859    0.80408 143.66000   6.005 1.49e-08</span></span>
<span><span class="co">#&gt; AVISITVIS3                     10.33317    0.82303 155.66000  12.555  &lt; 2e-16</span></span>
<span><span class="co">#&gt; AVISITVIS4                     15.05256    1.30180 138.39000  11.563  &lt; 2e-16</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS2            -0.01737    1.13154 138.39000  -0.015  0.98777</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS3            -0.66753    1.18714 158.21000  -0.562  0.57470</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS4             0.63094    1.83319 129.64000   0.344  0.73127</span></span>
<span><span class="co">#&gt;                                  </span></span>
<span><span class="co">#&gt; (Intercept)                   ***</span></span>
<span><span class="co">#&gt; RACEBlack or African American *  </span></span>
<span><span class="co">#&gt; RACEWhite                     ***</span></span>
<span><span class="co">#&gt; ARMCDTRT                      ***</span></span>
<span><span class="co">#&gt; AVISITVIS2                    ***</span></span>
<span><span class="co">#&gt; AVISITVIS3                    ***</span></span>
<span><span class="co">#&gt; AVISITVIS4                    ***</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS2              </span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS3              </span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS4              </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariance estimate:</span></span>
<span><span class="co">#&gt;         VIS1    VIS2    VIS3    VIS4</span></span>
<span><span class="co">#&gt; VIS1 40.7335 14.2740  5.1411 13.5288</span></span>
<span><span class="co">#&gt; VIS2 14.2740 26.2243  2.6391  7.3219</span></span>
<span><span class="co">#&gt; VIS3  5.1411  2.6391 14.9497  1.0341</span></span>
<span><span class="co">#&gt; VIS4 13.5288  7.3219  1.0341 95.6006</span></span></code></pre></div>
<p>For one-dimensional contrasts as in the coefficients table above, the
degrees of freedom are the same for Kenward-Roger and Satterthwaite.
However, Kenward-Roger uses adjusted standard errors, hence the p-values
are different.</p>
<p>Note that if you would like to match SAS results for an unstructured
covariance model, you can use the linear Kenward-Roger
approximation:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_kr_lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Kenward-Roger"</span>,</span>
<span>  vcov <span class="op">=</span> <span class="st">"Kenward-Roger-Linear"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This is due to the different parametrization of the unstructured
covariance matrix, see the <a href="kenward.html#parameterization-methods-and-kenward-roger">Kenward-Roger
vignette</a> for details.</p>
</div>
<div class="section level3">
<h3 id="variance-covariance-for-coefficients">Variance-covariance for Coefficients<a class="anchor" aria-label="anchor" href="#variance-covariance-for-coefficients"></a>
</h3>
<p>There are multiple variance-covariance estimator available for the
coefficients, including:</p>
<ol style="list-style-type: decimal">
<li>“Asymptotic”</li>
<li>“Empirical” (Cluster Robust Sandwich)</li>
<li>“Empirical-Jackknife”</li>
<li>“Empirical-Bias-Reduced”</li>
<li>“Kenward-Roger”</li>
<li>“Kenward-Roger-Linear”</li>
</ol>
<p>Please note that, not all combinations of variance-covariance for
coefficients and method of degrees of freedom are possible,
e.g. “Kenward-Roger” and “Kenward-Roger-Linear” are available only when
the degrees of freedom method is “Kenward-Roger”.</p>
<p>Details can be found in <a href="coef_vcov.html">Coefficients
Covariance Matrix Adjustment vignette</a> and <a href="empirical_wls.html">Weighted Least Square Empirical
Covariance</a>.</p>
<p>An example of using other variance-covariance is:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Satterthwaite"</span>,</span>
<span>  vcov <span class="op">=</span> <span class="st">"Empirical"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="keeping-unobserved-visits">Keeping Unobserved Visits<a class="anchor" aria-label="anchor" href="#keeping-unobserved-visits"></a>
</h3>
<p>Sometimes not all possible time points are observed in a given data
set. When using a structured covariance matrix, e.g. with
auto-regressive structure, then it can be relevant to keep the correct
distance between the observed time points.</p>
<p>Consider the following example where we have deliberately removed the
<code>VIS3</code> observations from our initial example data set
<code>fev_data</code> to obtain <code>sparse_data</code>. We first fit
the model where we do not drop the visit level explicitly, using the
<code>drop_visit_levels = FALSE</code> choice. Second we fit the model
by default without this option.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sparse_data</span> <span class="op">&lt;-</span> <span class="va">fev_data</span><span class="op">[</span><span class="va">fev_data</span><span class="op">$</span><span class="va">AVISIT</span> <span class="op">!=</span> <span class="st">"VIS3"</span>, <span class="op">]</span></span>
<span><span class="va">sparse_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="fu">ar1</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">sparse_data</span>,</span>
<span>  drop_visit_levels <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropped_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="fu">ar1</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">sparse_data</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; In AVISIT there are dropped visits: VIS3</span></span></code></pre></div>
<p>We see that we get a message about the dropped visit level by
default. Now we can compare the estimated correlation matrices:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="fu"><a href="../reference/mmrm_tmb_methods.html">VarCorr</a></span><span class="op">(</span><span class="va">sparse_result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;            VIS1      VIS2      VIS3       VIS4</span></span>
<span><span class="co">#&gt; VIS1 1.00000000 0.4051834 0.1641736 0.06652042</span></span>
<span><span class="co">#&gt; VIS2 0.40518341 1.0000000 0.4051834 0.16417360</span></span>
<span><span class="co">#&gt; VIS3 0.16417360 0.4051834 1.0000000 0.40518341</span></span>
<span><span class="co">#&gt; VIS4 0.06652042 0.1641736 0.4051834 1.00000000</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="fu"><a href="../reference/mmrm_tmb_methods.html">VarCorr</a></span><span class="op">(</span><span class="va">dropped_result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;            VIS1      VIS2       VIS4</span></span>
<span><span class="co">#&gt; VIS1 1.00000000 0.1468464 0.02156386</span></span>
<span><span class="co">#&gt; VIS2 0.14684640 1.0000000 0.14684640</span></span>
<span><span class="co">#&gt; VIS4 0.02156386 0.1468464 1.00000000</span></span></code></pre></div>
<p>We see that when using the default, second result, we just drop the
<code>VIS3</code> from the covariance matrix. As a consequence, we model
the correlation between <code>VIS2</code> and <code>VIS4</code> the same
as the correlation between <code>VIS1</code> and <code>VIS2</code>.
Hence we get a smaller correlation estimate here compared to the first
result, which includes <code>VIS3</code> explicitly.</p>
</div>
</div>
<div class="section level2">
<h2 id="extraction-of-model-features">Extraction of model features<a class="anchor" aria-label="anchor" href="#extraction-of-model-features"></a>
</h2>
<p>Similar to model objects created in other packages, components of
<code>mmrm</code> and <code>mmrm_tmb</code> objects can be accessed with
standard methods. Additionally, <a href="https://openpharma.github.io/mmrm/main/reference/component.html"><code>component()</code></a>
is provided to allow deeper and more precise access for those interested
in digging through model output. Complete documentation of standard
model output methods supported for <code>mmrm_tmb</code> objects <a href="https://openpharma.github.io/mmrm/main/reference/mmrm_tmb_methods.html">can
be found at the package website.</a></p>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>The <code>summary</code> method for <code>mmrm</code> objects
provides easy access to frequently needed model components.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p>From this summary object, you can easily retrieve the coefficients
table.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_summary</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="co">#&gt;                                  Estimate Std. Error       df     t value</span></span>
<span><span class="co">#&gt; (Intercept)                   30.96769899  0.8293349 187.9132 37.34040185</span></span>
<span><span class="co">#&gt; RACEBlack or African American  1.50464863  0.6206596 169.9454  2.42427360</span></span>
<span><span class="co">#&gt; RACEWhite                      5.61309565  0.6630909 158.8700  8.46504747</span></span>
<span><span class="co">#&gt; ARMCDTRT                       3.77555734  1.0762774 146.2690  3.50797778</span></span>
<span><span class="co">#&gt; AVISITVIS2                     4.82858803  0.8017144 143.6593  6.02282805</span></span>
<span><span class="co">#&gt; AVISITVIS3                    10.33317002  0.8224414 155.6572 12.56401918</span></span>
<span><span class="co">#&gt; AVISITVIS4                    15.05255715  1.3128602 138.3916 11.46546844</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS2           -0.01737409  1.1291645 138.3926 -0.01538668</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS3           -0.66753189  1.1865359 158.2106 -0.56258887</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS4            0.63094392  1.8507884 129.6377  0.34090549</span></span>
<span><span class="co">#&gt;                                   Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)                   7.122411e-89</span></span>
<span><span class="co">#&gt; RACEBlack or African American 1.638725e-02</span></span>
<span><span class="co">#&gt; RACEWhite                     1.605553e-14</span></span>
<span><span class="co">#&gt; ARMCDTRT                      6.001485e-04</span></span>
<span><span class="co">#&gt; AVISITVIS2                    1.366921e-08</span></span>
<span><span class="co">#&gt; AVISITVIS3                    1.927523e-25</span></span>
<span><span class="co">#&gt; AVISITVIS4                    8.242709e-22</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS2           9.877459e-01</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS3           5.745112e-01</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS4           7.337266e-01</span></span></code></pre></div>
<p>Other model parameters and metadata available in the summary object
is as follows:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fit_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 15</span></span>
<span><span class="co">#&gt;  $ cov_type        : chr "us"</span></span>
<span><span class="co">#&gt;  $ reml            : logi TRUE</span></span>
<span><span class="co">#&gt;  $ n_groups        : int 1</span></span>
<span><span class="co">#&gt;  $ n_theta         : int 10</span></span>
<span><span class="co">#&gt;  $ n_subjects      : int 197</span></span>
<span><span class="co">#&gt;  $ n_timepoints    : int 4</span></span>
<span><span class="co">#&gt;  $ n_obs           : int 537</span></span>
<span><span class="co">#&gt;  $ beta_vcov       : num [1:10, 1:10] 0.688 -0.207 -0.163 -0.569 -0.422 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:10] "(Intercept)" "RACEBlack or African American" "RACEWhite" "ARMCDTRT" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:10] "(Intercept)" "RACEBlack or African American" "RACEWhite" "ARMCDTRT" ...</span></span>
<span><span class="co">#&gt;  $ varcor          : num [1:4, 1:4] 40.73 14.27 5.14 13.53 14.27 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:4] "VIS1" "VIS2" "VIS3" "VIS4"</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:4] "VIS1" "VIS2" "VIS3" "VIS4"</span></span>
<span><span class="co">#&gt;  $ method          : chr "Satterthwaite"</span></span>
<span><span class="co">#&gt;  $ vcov            : chr "Asymptotic"</span></span>
<span><span class="co">#&gt;  $ coefficients    : num [1:10, 1:5] 30.97 1.5 5.61 3.78 4.83 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:10] "(Intercept)" "RACEBlack or African American" "RACEWhite" "ARMCDTRT" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "Estimate" "Std. Error" "df" "t value" ...</span></span>
<span><span class="co">#&gt;  $ n_singular_coefs: int 0</span></span>
<span><span class="co">#&gt;  $ aic_list        :List of 4</span></span>
<span><span class="co">#&gt;   ..$ AIC     : num 3407</span></span>
<span><span class="co">#&gt;   ..$ BIC     : num 3440</span></span>
<span><span class="co">#&gt;   ..$ logLik  : num -1694</span></span>
<span><span class="co">#&gt;   ..$ deviance: num 3387</span></span>
<span><span class="co">#&gt;  $ call            : language mmrm(formula = FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID), data = fev_data)</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "summary.mmrm"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="residuals">Residuals<a class="anchor" aria-label="anchor" href="#residuals"></a>
</h3>
<p>The <code>residuals</code> method for <code>mmrm</code> objects can
be used to provide three different types of residuals:</p>
<ol style="list-style-type: decimal">
<li>Response or raw residuals - the difference between the observed and
fitted or predicted value. MMRMs can allow for heteroscedasticity, so
these residuals should be interpreted with caution.</li>
</ol>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span>
<span><span class="va">residuals_resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Pearson residuals - the raw residuals scaled by the estimated
standard deviation of the response. This residual type is better suited
to identifying outlying observations and the appropriateness of the
covariance structure, compared to the raw residuals.</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">residuals_pearson</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Normalized or scaled residuals - the raw residuals are
‘de-correlated’ based on the Cholesky decomposition of the
variance-covariance matrix. These residuals should approximately follow
the standard normal distribution, and therefore can be used to check for
normality (<span class="citation">@galecki2013linear</span>).</li>
</ol>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">residuals_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"normalized"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="broom-extensions">
<code>broom</code> extensions<a class="anchor" aria-label="anchor" href="#broom-extensions"></a>
</h3>
<p><code>mmrm</code> also contains S3 methods methods for
<code>tidy</code>, <code>glance</code> and <code>augment</code> which
were introduced by <a href="https://broom.tidymodels.org/" class="external-link"><code>broom</code></a>. Note that
these methods will work also without loading the <code>broom</code>
package. Please see <code><a href="../reference/mmrm_tidiers.html">?mmrm_tidiers</a></code> for the detailed
documentation.</p>
<p>For example, we can apply the <code>tidy</code> method to return a
summary table of coefficient estimates:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 6</span></span></span>
<span><span class="co">#&gt;    term                          estimate std.error    df statistic  p.value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> (Intercept)                    31.0        0.829  188.   37.3    7.12<span style="color: #949494;">e</span><span style="color: #BB0000;">-89</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> RACEBlack or African American   1.50       0.621  170.    2.42   1.64<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> RACEWhite                       5.61       0.663  159.    8.47   1.61<span style="color: #949494;">e</span><span style="color: #BB0000;">-14</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> ARMCDTRT                        3.78       1.08   146.    3.51   6.00<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> AVISITVIS2                      4.83       0.802  144.    6.02   1.37<span style="color: #949494;">e</span><span style="color: #BB0000;">- 8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> AVISITVIS3                     10.3        0.822  156.   12.6    1.93<span style="color: #949494;">e</span><span style="color: #BB0000;">-25</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> AVISITVIS4                     15.1        1.31   138.   11.5    8.24<span style="color: #949494;">e</span><span style="color: #BB0000;">-22</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> ARMCDTRT:AVISITVIS2            -<span style="color: #BB0000;">0.017</span><span style="color: #BB0000; text-decoration: underline;">4</span>     1.13   138.   -<span style="color: #BB0000;">0.015</span><span style="color: #BB0000; text-decoration: underline;">4</span> 9.88<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> ARMCDTRT:AVISITVIS3            -<span style="color: #BB0000;">0.668</span>      1.19   158.   -<span style="color: #BB0000;">0.563</span>  5.75<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> ARMCDTRT:AVISITVIS4             0.631      1.85   130.    0.341  7.34<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span></code></pre></div>
<p>We can also specify some details to request confidence intervals of
specific confidence level:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span>conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 8</span></span></span>
<span><span class="co">#&gt;    term           estimate std.error    df statistic  p.value conf.low conf.high</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> (Intercept)     31.0        0.829  188.   37.3    7.12<span style="color: #949494;">e</span><span style="color: #BB0000;">-89</span>   29.6       32.3 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> ARMCDTRT         3.78       1.08   146.    3.51   6.00<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>    1.99       5.56</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> ARMCDTRT:AVIS…  -<span style="color: #BB0000;">0.017</span><span style="color: #BB0000; text-decoration: underline;">4</span>     1.13   138.   -<span style="color: #BB0000;">0.015</span><span style="color: #BB0000; text-decoration: underline;">4</span> 9.88<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span>   -<span style="color: #BB0000;">1.89</span>       1.85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> ARMCDTRT:AVIS…  -<span style="color: #BB0000;">0.668</span>      1.19   158.   -<span style="color: #BB0000;">0.563</span>  5.75<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span>   -<span style="color: #BB0000;">2.63</span>       1.30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> ARMCDTRT:AVIS…   0.631      1.85   130.    0.341  7.34<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span>   -<span style="color: #BB0000;">2.44</span>       3.70</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> AVISITVIS2       4.83       0.802  144.    6.02   1.37<span style="color: #949494;">e</span><span style="color: #BB0000;">- 8</span>    3.50       6.16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> AVISITVIS3      10.3        0.822  156.   12.6    1.93<span style="color: #949494;">e</span><span style="color: #BB0000;">-25</span>    8.97      11.7 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> AVISITVIS4      15.1        1.31   138.   11.5    8.24<span style="color: #949494;">e</span><span style="color: #BB0000;">-22</span>   12.9       17.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> RACEBlack or …   1.50       0.621  170.    2.42   1.64<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span>    0.478      2.53</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> RACEWhite        5.61       0.663  159.    8.47   1.61<span style="color: #949494;">e</span><span style="color: #BB0000;">-14</span>    4.52       6.71</span></span></code></pre></div>
<p>Or we can apply the <code>glance</code> method to return a summary
table of goodness of fit statistics:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;     AIC   BIC logLik deviance</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="text-decoration: underline;">3</span>407. <span style="text-decoration: underline;">3</span>440. -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">694.</span>    <span style="text-decoration: underline;">3</span>387.</span></span></code></pre></div>
<p>Finally, we can use the <code>augment</code> method to return a
merged <code>tibble</code> of the data, fitted values and residuals:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 537 × 8</span></span></span>
<span><span class="co">#&gt;    .rownames  FEV1 RACE                     ARMCD AVISIT USUBJID .fitted  .resid</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         2  40.0 Black or African Americ… TRT   VIS2   PT1        40.0  -<span style="color: #BB0000;">1.09</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         4  20.5 Black or African Americ… TRT   VIS4   PT1        20.5 -<span style="color: #BB0000;">31.4</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         6  31.5 Asian                    PBO   VIS2   PT2        31.5  -<span style="color: #BB0000;">4.34</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         7  36.9 Asian                    PBO   VIS3   PT2        36.9  -<span style="color: #BB0000;">4.42</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         8  48.8 Asian                    PBO   VIS4   PT2        48.8   2.79 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>        10  36.0 Black or African Americ… PBO   VIS2   PT3        36.0  -<span style="color: #BB0000;">1.31</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>        12  37.2 Black or African Americ… PBO   VIS4   PT3        37.2 -<span style="color: #BB0000;">10.4</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>        13  33.9 Asian                    TRT   VIS1   PT4        33.9  -<span style="color: #BB0000;">0.851</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>        14  33.7 Asian                    TRT   VIS2   PT4        33.7  -<span style="color: #BB0000;">5.81</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        16  54.5 Asian                    TRT   VIS4   PT4        54.5   4.02 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 527 more rows</span></span></span></code></pre></div>
<p>Also here we can specify details for the prediction intervals and
type of residuals via the arguments:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span>interval <span class="op">=</span> <span class="st">"confidence"</span>, type.residuals <span class="op">=</span> <span class="st">"normalized"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 537 × 11</span></span></span>
<span><span class="co">#&gt;    .rownames  FEV1 RACE       ARMCD AVISIT USUBJID .fitted .lower .upper .se.fit</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         2  40.0 Black or … TRT   VIS2   PT1        40.0   40.0   40.0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         4  20.5 Black or … TRT   VIS4   PT1        20.5   20.5   20.5       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         6  31.5 Asian      PBO   VIS2   PT2        31.5   31.5   31.5       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         7  36.9 Asian      PBO   VIS3   PT2        36.9   36.9   36.9       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         8  48.8 Asian      PBO   VIS4   PT2        48.8   48.8   48.8       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>        10  36.0 Black or … PBO   VIS2   PT3        36.0   36.0   36.0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>        12  37.2 Black or … PBO   VIS4   PT3        37.2   37.2   37.2       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>        13  33.9 Asian      TRT   VIS1   PT4        33.9   33.9   33.9       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>        14  33.7 Asian      TRT   VIS2   PT4        33.7   33.7   33.7       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        16  54.5 Asian      TRT   VIS4   PT4        54.5   54.5   54.5       0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 527 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: .resid &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-components">Other components<a class="anchor" aria-label="anchor" href="#other-components"></a>
</h3>
<p>Specific model quantities not supported by methods can be retrieved
with the <a href="https://openpharma.github.io/mmrm/main/reference/component.html"><code>component()</code></a>
function. The default will output all supported components.</p>
<p>For example, a user may want information about convergence:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/component.html">component</a></span><span class="op">(</span><span class="va">fit</span>, name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"convergence"</span>, <span class="st">"evaluations"</span>, <span class="st">"conv_message"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $convergence</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $evaluations</span></span>
<span><span class="co">#&gt; function gradient </span></span>
<span><span class="co">#&gt;       17       17 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $conv_message</span></span>
<span><span class="co">#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"</span></span></code></pre></div>
<p>or the original low-level call:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/component.html">component</a></span><span class="op">(</span><span class="va">fit</span>, name <span class="op">=</span> <span class="st">"call"</span><span class="op">)</span></span>
<span><span class="co">#&gt; mmrm(formula = FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID), </span></span>
<span><span class="co">#&gt;     data = fev_data)</span></span></code></pre></div>
<p>the user could also ask for all provided components by not specifying
the <code>name</code> argument.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/component.html">component</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="lower-level-functions">Lower level functions<a class="anchor" aria-label="anchor" href="#lower-level-functions"></a>
</h2>
<div class="section level3">
<h3 id="low-level-mmrm">Low-level mmrm<a class="anchor" aria-label="anchor" href="#low-level-mmrm"></a>
</h3>
<p>The lower level function which is called by <a href="https://openpharma.github.io/mmrm/main/reference/mmrm.html"><code>mmrm()</code></a>
is <a href="https://openpharma.github.io/mmrm/main/reference/fit_mmrm.html"><code>fit_mmrm()</code></a>.
This function is exported and can be used directly. It is similar to <a href="https://openpharma.github.io/mmrm/main/reference/mmrm.html"><code>mmrm()</code></a>
but lacks some post-processing and support for Satterthwaite and
Kenward-Roger calculations. It may be useful for other packages that
want to fit the model without the adjustment calculations.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fit_mmrm.html">fit_mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fev_data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  reml <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="../reference/mmrm_control.html">mmrm_control</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Weights:     rep(1, nrow(fev_data))</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    3387.373</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                   30.96769899                    1.50464863 </span></span>
<span><span class="co">#&gt;                     RACEWhite                      ARMCDTRT </span></span>
<span><span class="co">#&gt;                    5.61309565                    3.77555734 </span></span>
<span><span class="co">#&gt;                    AVISITVIS2                    AVISITVIS3 </span></span>
<span><span class="co">#&gt;                    4.82858803                   10.33317002 </span></span>
<span><span class="co">#&gt;                    AVISITVIS4           ARMCDTRT:AVISITVIS2 </span></span>
<span><span class="co">#&gt;                   15.05255715                   -0.01737409 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS3           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                   -0.66753189                    0.63094392 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="hypothesis-testing">Hypothesis testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h2>
<p>This package supports estimation of one- and multi-dimensional
contrasts (t-test and F-test calculation) with the <a href="https://openpharma.github.io/mmrm/main/reference/df_1d.html"><code>df_1d()</code></a>
and <a href="https://openpharma.github.io/mmrm/main/reference/df_md.html"><code>df_md()</code></a>
functions. Both functions utilize the chosen adjustment method from the
initial <code>mmrm</code> call for the calculation of degrees of freedom
and (for Kenward-Roger methods) the variance estimates for the
test-statistics.</p>
<div class="section level3">
<h3 id="one-dimensional-contrasts">One-dimensional contrasts<a class="anchor" aria-label="anchor" href="#one-dimensional-contrasts"></a>
</h3>
<p>Compute the test of a one-dimensional (vector) contrast for a
<code>mmrm</code> object with Satterthwaite degrees of freedom.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">contrast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/component.html">component</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"beta_est"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">contrast</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="fu"><a href="../reference/df_1d.html">df_1d</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">contrast</span><span class="op">)</span></span>
<span><span class="co">#&gt; $est</span></span>
<span><span class="co">#&gt; [1] 5.643565</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $se</span></span>
<span><span class="co">#&gt; [1] 0.6656093</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt; [1] 157.1382</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_stat</span></span>
<span><span class="co">#&gt; [1] 8.478795</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p_val</span></span>
<span><span class="co">#&gt; [1] 1.564869e-14</span></span></code></pre></div>
<p>This works similarly when choosing a Kenward-Roger adjustment:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_kr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Kenward-Roger"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/df_1d.html">df_1d</a></span><span class="op">(</span><span class="va">fit_kr</span>, <span class="va">contrast</span><span class="op">)</span></span>
<span><span class="co">#&gt; $est</span></span>
<span><span class="co">#&gt; [1] 5.643565</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $se</span></span>
<span><span class="co">#&gt; [1] 0.6740941</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt; [1] 157.1382</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_stat</span></span>
<span><span class="co">#&gt; [1] 8.372073</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p_val</span></span>
<span><span class="co">#&gt; [1] 2.931654e-14</span></span></code></pre></div>
<p>We see that because this is a one-dimensional contrast, the degrees
of freedoms are identical for Satterthwaite and Kenward-Roger. However,
the standard errors are different and therefore the p-values are
different.</p>
<p>Additional options for the degrees of freedom <code>method</code> are
Residual and Between-Within.</p>
</div>
<div class="section level3">
<h3 id="multi-dimensional-contrasts">Multi-dimensional contrasts<a class="anchor" aria-label="anchor" href="#multi-dimensional-contrasts"></a>
</h3>
<p>Compute the test of a multi-dimensional (matrix) contrast for the
above defined <code>mmrm</code> object with Satterthwaite degrees of
freedom:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fl">0</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/component.html">component</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"beta_est"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">contrast</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">contrast</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="fu"><a href="../reference/df_md.html">df_md</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">contrast</span><span class="op">)</span></span>
<span><span class="co">#&gt; $num_df</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $denom_df</span></span>
<span><span class="co">#&gt; [1] 165.5553</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $f_stat</span></span>
<span><span class="co">#&gt; [1] 36.91143</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p_val</span></span>
<span><span class="co">#&gt; [1] 5.544575e-14</span></span></code></pre></div>
<p>And for the Kenward-Roger adjustment:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/df_md.html">df_md</a></span><span class="op">(</span><span class="va">fit_kr</span>, <span class="va">contrast</span><span class="op">)</span></span>
<span><span class="co">#&gt; $num_df</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $denom_df</span></span>
<span><span class="co">#&gt; [1] 165.5728</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $f_stat</span></span>
<span><span class="co">#&gt; [1] 35.99422</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p_val</span></span>
<span><span class="co">#&gt; [1] 1.04762e-13</span></span></code></pre></div>
<p>We see that for the multi-dimensional contrast we get slightly
different denominator degrees of freedom for the two adjustment
methods.</p>
<p>Also the simpler Residual and Between-Within <code>method</code>
choices can be used of course together with multidimensional
contrasts.</p>
</div>
<div class="section level3">
<h3 id="support-for-emmeans">Support for emmeans<a class="anchor" aria-label="anchor" href="#support-for-emmeans"></a>
</h3>
<p>This package includes methods that allow <code>mmrm</code> objects to
be used with the <code>emmeans</code> package. <code>emmeans</code>
computes estimated marginal means (also called least-square means) for
the coefficients of the MMRM. For example, in order to see the
least-square means by visit and by treatment arm:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rvlenth.github.io/emmeans/" class="external-link">emmeans</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; mmrm() registered as emmeans extension</span></span>
<span><span class="co">#&gt; Welcome to emmeans.</span></span>
<span><span class="co">#&gt; Caution: You lose important information if you filter this package's results.</span></span>
<span><span class="co">#&gt; See '? untidy'</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lsmeans_by_visit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">fit</span>, <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">|</span> <span class="va">AVISIT</span><span class="op">)</span></span>
<span><span class="va">lsmeans_by_visit</span></span>
<span><span class="co">#&gt; AVISIT = VIS1:</span></span>
<span><span class="co">#&gt;  ARMCD emmean    SE  df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  PBO     33.3 0.755 148     31.8     34.8</span></span>
<span><span class="co">#&gt;  TRT     37.1 0.763 143     35.6     38.6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AVISIT = VIS2:</span></span>
<span><span class="co">#&gt;  ARMCD emmean    SE  df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  PBO     38.2 0.612 147     37.0     39.4</span></span>
<span><span class="co">#&gt;  TRT     41.9 0.602 143     40.7     43.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AVISIT = VIS3:</span></span>
<span><span class="co">#&gt;  ARMCD emmean    SE  df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  PBO     43.7 0.462 130     42.8     44.6</span></span>
<span><span class="co">#&gt;  TRT     46.8 0.509 130     45.7     47.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AVISIT = VIS4:</span></span>
<span><span class="co">#&gt;  ARMCD emmean    SE  df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  PBO     48.4 1.189 134     46.0     50.7</span></span>
<span><span class="co">#&gt;  TRT     52.8 1.188 133     50.4     55.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results are averaged over the levels of: RACE, SEX </span></span>
<span><span class="co">#&gt; Confidence level used: 0.95</span></span></code></pre></div>
<p>Note that the degrees of freedom choice is inherited here from the
initial <code>mmrm</code> fit. Furthermore, we can also obtain the
differences between the treatment arms for each visit by applying
<code><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs()</a></code> on the object returned by <code><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html" class="external-link">emmeans()</a></code>
earlier:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">lsmeans_by_visit</span>, reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; AVISIT = VIS1:</span></span>
<span><span class="co">#&gt;  contrast  estimate    SE  df t.ratio p.value</span></span>
<span><span class="co">#&gt;  TRT - PBO     3.77 1.074 146   3.514  0.0006</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AVISIT = VIS2:</span></span>
<span><span class="co">#&gt;  contrast  estimate    SE  df t.ratio p.value</span></span>
<span><span class="co">#&gt;  TRT - PBO     3.73 0.859 145   4.346  &lt;.0001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AVISIT = VIS3:</span></span>
<span><span class="co">#&gt;  contrast  estimate    SE  df t.ratio p.value</span></span>
<span><span class="co">#&gt;  TRT - PBO     3.08 0.690 131   4.467  &lt;.0001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AVISIT = VIS4:</span></span>
<span><span class="co">#&gt;  contrast  estimate    SE  df t.ratio p.value</span></span>
<span><span class="co">#&gt;  TRT - PBO     4.40 1.681 133   2.617  0.0099</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results are averaged over the levels of: RACE, SEX</span></span></code></pre></div>
<p>(This is similar like the <code>pdiff</code> option in SAS
<code>PROC MIXED</code>.) Note that we use here the <code>reverse</code>
argument to obtain treatment minus placebo results, instead of placebo
minus treatment results.</p>
<p>To further obtain the confidence interval of the least square mean
differences, we can apply <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> on the result returned
by <code><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs()</a></code> .</p>
<p>This is similar to the <code>LSMEANS</code> in SAS, with
<code>CL</code> and <code>DIFF</code> options.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">lsmeans_by_visit</span>, reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; AVISIT = VIS1:</span></span>
<span><span class="co">#&gt;  contrast  estimate    SE  df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  TRT - PBO     3.77 1.074 146     1.65     5.90</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AVISIT = VIS2:</span></span>
<span><span class="co">#&gt;  contrast  estimate    SE  df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  TRT - PBO     3.73 0.859 145     2.03     5.43</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AVISIT = VIS3:</span></span>
<span><span class="co">#&gt;  contrast  estimate    SE  df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  TRT - PBO     3.08 0.690 131     1.72     4.44</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AVISIT = VIS4:</span></span>
<span><span class="co">#&gt;  contrast  estimate    SE  df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  TRT - PBO     4.40 1.681 133     1.07     7.72</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results are averaged over the levels of: RACE, SEX </span></span>
<span><span class="co">#&gt; Confidence level used: 0.95</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="support-for-car">Support for car<a class="anchor" aria-label="anchor" href="#support-for-car"></a>
</h3>
<p>This package includes methods that allow <code>mmrm</code> objects to
be used with the <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova</a></code> function. <code>Anova</code>
conducts type II/III hypothesis testing for the effect in
<code>mmrm</code> models. For example, in order to see if the used
covariates are related to the response:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: carData</span></span>
<span><span class="co">#&gt; mmrm() registered as car::Anova extension</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"II"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Fixed Effect Table (Type II F tests)</span></span>
<span><span class="co">#&gt;              Num Df Denom Df F Statistic   Pr(&gt;=F)    </span></span>
<span><span class="co">#&gt; RACE              2   165.56      36.911 5.545e-14 ***</span></span>
<span><span class="co">#&gt; SEX               1   166.13       0.376    0.5407    </span></span>
<span><span class="co">#&gt; ARMCD             1   169.12      31.421 8.296e-08 ***</span></span>
<span><span class="co">#&gt; AVISIT            3   148.65     142.822 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; ARMCD:AVISIT      3   147.91       0.258    0.8555    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Note that the degrees of freedom choice is inherited here from the
initial <code>mmrm</code> fit. In addition, please note that if you see
results that are slightly different from SAS, it could be because the
reference level is set differently for categorical covariates. We can
also use type III hypothesis testing:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"III"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Fixed Effect Table (Type III F tests)</span></span>
<span><span class="co">#&gt;              Num Df Denom Df F Statistic   Pr(&gt;=F)    </span></span>
<span><span class="co">#&gt; RACE              2   165.56      36.911 5.545e-14 ***</span></span>
<span><span class="co">#&gt; SEX               1   166.13       0.376    0.5407    </span></span>
<span><span class="co">#&gt; ARMCD             1   168.52      31.663 7.502e-08 ***</span></span>
<span><span class="co">#&gt; AVISIT            3   148.12     142.112 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; ARMCD:AVISIT      3   147.91       0.258    0.8555    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="tidymodels">Tidymodels<a class="anchor" aria-label="anchor" href="#tidymodels"></a>
</h2>
<div class="section level3">
<h3 id="tidymodels-1">Tidymodels<a class="anchor" aria-label="anchor" href="#tidymodels-1"></a>
</h3>
<p><code>mmrm</code> is compatible to work in a <code>tidymodels</code>
workflow. The following is an example of how such a workflow would be
constructed.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="direct-fit">Direct fit<a class="anchor" aria-label="anchor" href="#direct-fit"></a>
</h4>
<p>First we define the direct method to fit an <code>mmrm</code> model
using the <code>parsnip</code> package functions
<code>linear_reg()</code> and <code>set_engine()</code>.</p>
<ul>
<li>
<code>linear_reg()</code> defines a model that can predict numeric
values from predictors using a linear function</li>
<li>
<code>set_engine()</code> is used to specify which package or system
will be used to fit the model, along with any arguments specific to that
software. We can set the method to adjust degrees of freedom directly in
the call.</li>
</ul>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">linear_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"mmrm"</span>, method <span class="op">=</span> <span class="st">"Satterthwaite"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">fit</span><span class="op">(</span><span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>, <span class="va">fev_data</span><span class="op">)</span></span>
<span><span class="va">model</span></span>
<span><span class="co">#&gt; parsnip model object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Weights:     weights</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    3387.373</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                   30.96769899                    1.50464863 </span></span>
<span><span class="co">#&gt;                     RACEWhite                      ARMCDTRT </span></span>
<span><span class="co">#&gt;                    5.61309565                    3.77555734 </span></span>
<span><span class="co">#&gt;                    AVISITVIS2                    AVISITVIS3 </span></span>
<span><span class="co">#&gt;                    4.82858803                   10.33317002 </span></span>
<span><span class="co">#&gt;                    AVISITVIS4           ARMCDTRT:AVISITVIS2 </span></span>
<span><span class="co">#&gt;                   15.05255715                   -0.01737409 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS3           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                   -0.66753189                    0.63094392 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
<p>We can also pass in the full <code>mmrm_control</code> object into
the <code>set_engine()</code> call:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_with_control</span> <span class="op">&lt;-</span> <span class="fu">linear_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"mmrm"</span>, control <span class="op">=</span> <span class="fu"><a href="../reference/mmrm_control.html">mmrm_control</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"Satterthwaite"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">fit</span><span class="op">(</span><span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>, <span class="va">fev_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="predictions">Predictions<a class="anchor" aria-label="anchor" href="#predictions"></a>
</h4>
<p>Lastly, we can also obtain predictions with the
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, new_data <span class="op">=</span> <span class="va">fev_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 800 × 1</span></span></span>
<span><span class="co">#&gt;    .pred</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  32.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  40.0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  45.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  20.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  28.0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  31.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  36.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  48.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  30.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  36.0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 790 more rows</span></span></span></code></pre></div>
<p>Note that we need to explicitly pass <code>new_data</code> because
the method definition does not allow to default it to the data set we
used for the model fitting automatically.</p>
<p>By using the <code>type = "numeric"</code> default of
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> as above we cannot further customize the
calculations. We obtain predicted values without confidence intervals or
standard errors.</p>
<p>On the other hand, when using <code>type = "raw"</code> we can
customize the calculations via the <code>opts</code> list:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  new_data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"raw"</span>,</span>
<span>  opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>se.fit <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="st">"prediction"</span>, nsim <span class="op">=</span> <span class="fl">10L</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;          fit        se      lwr      upr</span></span>
<span><span class="co">#&gt; 1   32.47877  5.912741 20.89001 44.06753</span></span>
<span><span class="co">#&gt; 2   39.97105  0.000000 39.97105 39.97105</span></span>
<span><span class="co">#&gt; 3   45.70508  4.035906 37.79485 53.61531</span></span>
<span><span class="co">#&gt; 4   20.48379  0.000000 20.48379 20.48379</span></span>
<span><span class="co">#&gt; 5   28.01243  5.596962 17.04258 38.98227</span></span>
<span><span class="co">#&gt; 6   31.45522  0.000000 31.45522 31.45522</span></span>
<span><span class="co">#&gt; 7   36.87889  0.000000 36.87889 36.87889</span></span>
<span><span class="co">#&gt; 8   48.80809  0.000000 48.80809 48.80809</span></span>
<span><span class="co">#&gt; 9   30.73774  5.707393 19.55145 41.92402</span></span>
<span><span class="co">#&gt; 10  35.98699  0.000000 35.98699 35.98699</span></span>
<span><span class="co">#&gt; 11  42.64153  3.880319 35.03624 50.24681</span></span>
<span><span class="co">#&gt; 12  37.16444  0.000000 37.16444 37.16444</span></span>
<span><span class="co">#&gt; 13  33.89229  0.000000 33.89229 33.89229</span></span>
<span><span class="co">#&gt; 14  33.74637  0.000000 33.74637 33.74637</span></span>
<span><span class="co">#&gt; 15  44.04155  3.809048 36.57595 51.50715</span></span>
<span><span class="co">#&gt; 16  54.45055  0.000000 54.45055 54.45055</span></span>
<span><span class="co">#&gt; 17  32.31386  0.000000 32.31386 32.31386</span></span>
<span><span class="co">#&gt; 18  37.31982  4.727282 28.05451 46.58512</span></span>
<span><span class="co">#&gt; 19  46.79361  0.000000 46.79361 46.79361</span></span>
<span><span class="co">#&gt; 20  41.71154  0.000000 41.71154 41.71154</span></span>
<span><span class="co">#&gt; 21  31.17198  6.125535 19.16615 43.17781</span></span>
<span><span class="co">#&gt; 22  36.63341  5.156900 26.52607 46.74075</span></span>
<span><span class="co">#&gt; 23  39.02423  0.000000 39.02423 39.02423</span></span>
<span><span class="co">#&gt; 24  47.26333  9.838596 27.98004 66.54663</span></span>
<span><span class="co">#&gt; 25  31.93050  0.000000 31.93050 31.93050</span></span>
<span><span class="co">#&gt; 26  32.90947  0.000000 32.90947 32.90947</span></span>
<span><span class="co">#&gt; 27  41.27523  3.770645 33.88490 48.66556</span></span>
<span><span class="co">#&gt; 28  48.28031  0.000000 48.28031 48.28031</span></span>
<span><span class="co">#&gt; 29  32.23021  0.000000 32.23021 32.23021</span></span>
<span><span class="co">#&gt; 30  35.91080  0.000000 35.91080 35.91080</span></span>
<span><span class="co">#&gt; 31  45.54898  0.000000 45.54898 45.54898</span></span>
<span><span class="co">#&gt; 32  53.02877  0.000000 53.02877 53.02877</span></span>
<span><span class="co">#&gt; 33  47.16898  0.000000 47.16898 47.16898</span></span>
<span><span class="co">#&gt; 34  46.64287  0.000000 46.64287 46.64287</span></span>
<span><span class="co">#&gt; 35  50.84665  3.791595 43.41526 58.27804</span></span>
<span><span class="co">#&gt; 36  58.09713  0.000000 58.09713 58.09713</span></span>
<span><span class="co">#&gt; 37  33.21881  6.101077 21.26092 45.17670</span></span>
<span><span class="co">#&gt; 38  37.68412  5.136786 27.61621 47.75204</span></span>
<span><span class="co">#&gt; 39  44.97613  0.000000 44.97613 44.97613</span></span>
<span><span class="co">#&gt; 40  47.67506  9.829325 28.40993 66.94018</span></span>
<span><span class="co">#&gt; 41  44.32755  0.000000 44.32755 44.32755</span></span>
<span><span class="co">#&gt; 42  38.97813  0.000000 38.97813 38.97813</span></span>
<span><span class="co">#&gt; 43  43.72862  0.000000 43.72862 43.72862</span></span>
<span><span class="co">#&gt; 44  46.43393  0.000000 46.43393 46.43393</span></span>
<span><span class="co">#&gt; 45  40.34576  0.000000 40.34576 40.34576</span></span>
<span><span class="co">#&gt; 46  42.76568  0.000000 42.76568 42.76568</span></span>
<span><span class="co">#&gt; 47  40.11155  0.000000 40.11155 40.11155</span></span>
<span><span class="co">#&gt; 48  49.71974  9.688168 30.73129 68.70820</span></span>
<span><span class="co">#&gt; 49  41.46341  5.999508 29.70459 53.22223</span></span>
<span><span class="co">#&gt; 50  45.73510  5.097137 35.74490 55.72531</span></span>
<span><span class="co">#&gt; 51  53.31791  0.000000 53.31791 53.31791</span></span>
<span><span class="co">#&gt; 52  56.07641  0.000000 56.07641 56.07641</span></span>
<span><span class="co">#&gt; 53  32.16382  6.091635 20.22444 44.10321</span></span>
<span><span class="co">#&gt; 54  37.14256  5.127849 27.09216 47.19296</span></span>
<span><span class="co">#&gt; 55  41.90837  0.000000 41.90837 41.90837</span></span>
<span><span class="co">#&gt; 56  47.46284  9.811555 28.23255 66.69314</span></span>
<span><span class="co">#&gt; 57  27.78883  6.120827 15.79223 39.78543</span></span>
<span><span class="co">#&gt; 58  34.13887  5.181902 23.98253 44.29521</span></span>
<span><span class="co">#&gt; 59  34.65663  0.000000 34.65663 34.65663</span></span>
<span><span class="co">#&gt; 60  39.07791  0.000000 39.07791 39.07791</span></span>
<span><span class="co">#&gt; 61  31.18775  5.686639 20.04214 42.33336</span></span>
<span><span class="co">#&gt; 62  35.89612  0.000000 35.89612 35.89612</span></span>
<span><span class="co">#&gt; 63  41.31608  3.862475 33.74577 48.88639</span></span>
<span><span class="co">#&gt; 64  47.67264  0.000000 47.67264 47.67264</span></span>
<span><span class="co">#&gt; 65  22.65440  0.000000 22.65440 22.65440</span></span>
<span><span class="co">#&gt; 66  36.35488  4.868379 26.81303 45.89672</span></span>
<span><span class="co">#&gt; 67  45.20175  3.892415 37.57275 52.83074</span></span>
<span><span class="co">#&gt; 68  40.85376  0.000000 40.85376 40.85376</span></span>
<span><span class="co">#&gt; 69  32.60048  0.000000 32.60048 32.60048</span></span>
<span><span class="co">#&gt; 70  33.64329  0.000000 33.64329 33.64329</span></span>
<span><span class="co">#&gt; 71  44.00451  3.809385 36.53825 51.47076</span></span>
<span><span class="co">#&gt; 72  40.92278  0.000000 40.92278 40.92278</span></span>
<span><span class="co">#&gt; 73  32.14831  0.000000 32.14831 32.14831</span></span>
<span><span class="co">#&gt; 74  46.43604  0.000000 46.43604 46.43604</span></span>
<span><span class="co">#&gt; 75  41.34973  0.000000 41.34973 41.34973</span></span>
<span><span class="co">#&gt; 76  66.30382  0.000000 66.30382 66.30382</span></span>
<span><span class="co">#&gt; 77  42.79902  5.658634 31.70830 53.88974</span></span>
<span><span class="co">#&gt; 78  47.95358  0.000000 47.95358 47.95358</span></span>
<span><span class="co">#&gt; 79  53.97364  0.000000 53.97364 53.97364</span></span>
<span><span class="co">#&gt; 80  56.89204  9.742736 37.79663 75.98746</span></span>
<span><span class="co">#&gt; 81  46.35384  5.685601 35.21027 57.49741</span></span>
<span><span class="co">#&gt; 82  56.64544  0.000000 56.64544 56.64544</span></span>
<span><span class="co">#&gt; 83  49.70872  0.000000 49.70872 49.70872</span></span>
<span><span class="co">#&gt; 84  60.40497  0.000000 60.40497 60.40497</span></span>
<span><span class="co">#&gt; 85  45.98525  0.000000 45.98525 45.98525</span></span>
<span><span class="co">#&gt; 86  51.90911  0.000000 51.90911 51.90911</span></span>
<span><span class="co">#&gt; 87  41.50787  0.000000 41.50787 41.50787</span></span>
<span><span class="co">#&gt; 88  53.42727  0.000000 53.42727 53.42727</span></span>
<span><span class="co">#&gt; 89  23.86859  0.000000 23.86859 23.86859</span></span>
<span><span class="co">#&gt; 90  35.98563  0.000000 35.98563 35.98563</span></span>
<span><span class="co">#&gt; 91  43.60626  0.000000 43.60626 43.60626</span></span>
<span><span class="co">#&gt; 92  44.77520  9.654905 25.85193 63.69846</span></span>
<span><span class="co">#&gt; 93  29.59773  0.000000 29.59773 29.59773</span></span>
<span><span class="co">#&gt; 94  35.50688  0.000000 35.50688 35.50688</span></span>
<span><span class="co">#&gt; 95  55.42944  0.000000 55.42944 55.42944</span></span>
<span><span class="co">#&gt; 96  52.10530  0.000000 52.10530 52.10530</span></span>
<span><span class="co">#&gt; 97  31.69644  0.000000 31.69644 31.69644</span></span>
<span><span class="co">#&gt; 98  32.16159  0.000000 32.16159 32.16159</span></span>
<span><span class="co">#&gt; 99  51.04735  0.000000 51.04735 51.04735</span></span>
<span><span class="co">#&gt; 100 55.85987  0.000000 55.85987 55.85987</span></span>
<span><span class="co">#&gt; 101 49.11706  0.000000 49.11706 49.11706</span></span>
<span><span class="co">#&gt; 102 49.25544  0.000000 49.25544 49.25544</span></span>
<span><span class="co">#&gt; 103 51.72211  0.000000 51.72211 51.72211</span></span>
<span><span class="co">#&gt; 104 69.99128  0.000000 69.99128 69.99128</span></span>
<span><span class="co">#&gt; 105 22.07169  0.000000 22.07169 22.07169</span></span>
<span><span class="co">#&gt; 106 36.35845  4.913836 26.72751 45.98939</span></span>
<span><span class="co">#&gt; 107 46.08393  0.000000 46.08393 46.08393</span></span>
<span><span class="co">#&gt; 108 52.42288  0.000000 52.42288 52.42288</span></span>
<span><span class="co">#&gt; 109 37.69466  0.000000 37.69466 37.69466</span></span>
<span><span class="co">#&gt; 110 44.59400  0.000000 44.59400 44.59400</span></span>
<span><span class="co">#&gt; 111 52.08897  0.000000 52.08897 52.08897</span></span>
<span><span class="co">#&gt; 112 58.22961  0.000000 58.22961 58.22961</span></span>
<span><span class="co">#&gt; 113 37.22824  0.000000 37.22824 37.22824</span></span>
<span><span class="co">#&gt; 114 34.39863  0.000000 34.39863 34.39863</span></span>
<span><span class="co">#&gt; 115 45.88949  3.859316 38.32537 53.45361</span></span>
<span><span class="co">#&gt; 116 36.34012  0.000000 36.34012 36.34012</span></span>
<span><span class="co">#&gt; 117 45.44182  0.000000 45.44182 45.44182</span></span>
<span><span class="co">#&gt; 118 41.54847  0.000000 41.54847 41.54847</span></span>
<span><span class="co">#&gt; 119 43.92172  0.000000 43.92172 43.92172</span></span>
<span><span class="co">#&gt; 120 61.83243  0.000000 61.83243 61.83243</span></span>
<span><span class="co">#&gt; 121 27.25656  0.000000 27.25656 27.25656</span></span>
<span><span class="co">#&gt; 122 34.77803  4.791670 25.38653 44.16953</span></span>
<span><span class="co">#&gt; 123 45.65133  0.000000 45.65133 45.65133</span></span>
<span><span class="co">#&gt; 124 44.56078  9.719823 25.51027 63.61128</span></span>
<span><span class="co">#&gt; 125 33.19334  0.000000 33.19334 33.19334</span></span>
<span><span class="co">#&gt; 126 39.72671  4.749336 30.41818 49.03524</span></span>
<span><span class="co">#&gt; 127 45.59637  3.822090 38.10521 53.08753</span></span>
<span><span class="co">#&gt; 128 41.66826  0.000000 41.66826 41.66826</span></span>
<span><span class="co">#&gt; 129 27.12753  0.000000 27.12753 27.12753</span></span>
<span><span class="co">#&gt; 130 31.74858  0.000000 31.74858 31.74858</span></span>
<span><span class="co">#&gt; 131 44.57711  3.899603 36.93403 52.22019</span></span>
<span><span class="co">#&gt; 132 41.60000  0.000000 41.60000 41.60000</span></span>
<span><span class="co">#&gt; 133 39.45250  0.000000 39.45250 39.45250</span></span>
<span><span class="co">#&gt; 134 32.61823  0.000000 32.61823 32.61823</span></span>
<span><span class="co">#&gt; 135 34.62445  0.000000 34.62445 34.62445</span></span>
<span><span class="co">#&gt; 136 45.90515  0.000000 45.90515 45.90515</span></span>
<span><span class="co">#&gt; 137 36.17780  0.000000 36.17780 36.17780</span></span>
<span><span class="co">#&gt; 138 39.79796  0.000000 39.79796 39.79796</span></span>
<span><span class="co">#&gt; 139 45.87019  3.774249 38.47280 53.26759</span></span>
<span><span class="co">#&gt; 140 50.08272  0.000000 50.08272 50.08272</span></span>
<span><span class="co">#&gt; 141 36.27753  5.769857 24.96882 47.58624</span></span>
<span><span class="co">#&gt; 142 44.64316  0.000000 44.64316 44.64316</span></span>
<span><span class="co">#&gt; 143 44.88252  3.916974 37.20539 52.55964</span></span>
<span><span class="co">#&gt; 144 39.73529  0.000000 39.73529 39.73529</span></span>
<span><span class="co">#&gt; 145 34.06164  0.000000 34.06164 34.06164</span></span>
<span><span class="co">#&gt; 146 40.18592  0.000000 40.18592 40.18592</span></span>
<span><span class="co">#&gt; 147 41.17584  0.000000 41.17584 41.17584</span></span>
<span><span class="co">#&gt; 148 57.76669  0.000000 57.76669 57.76669</span></span>
<span><span class="co">#&gt; 149 38.18460  0.000000 38.18460 38.18460</span></span>
<span><span class="co">#&gt; 150 38.61735  4.784591 29.23973 47.99498</span></span>
<span><span class="co">#&gt; 151 47.19893  0.000000 47.19893 47.19893</span></span>
<span><span class="co">#&gt; 152 48.18237  9.724165 29.12335 67.24138</span></span>
<span><span class="co">#&gt; 153 37.32785  0.000000 37.32785 37.32785</span></span>
<span><span class="co">#&gt; 154 37.89476  4.733260 28.61774 47.17178</span></span>
<span><span class="co">#&gt; 155 43.16048  0.000000 43.16048 43.16048</span></span>
<span><span class="co">#&gt; 156 41.40349  0.000000 41.40349 41.40349</span></span>
<span><span class="co">#&gt; 157 30.15733  0.000000 30.15733 30.15733</span></span>
<span><span class="co">#&gt; 158 35.84353  0.000000 35.84353 35.84353</span></span>
<span><span class="co">#&gt; 159 40.95250  0.000000 40.95250 40.95250</span></span>
<span><span class="co">#&gt; 160 46.76086  9.566529 28.01080 65.51091</span></span>
<span><span class="co">#&gt; 161 36.09804  5.654062 25.01628 47.17980</span></span>
<span><span class="co">#&gt; 162 41.37928  0.000000 41.37928 41.37928</span></span>
<span><span class="co">#&gt; 163 50.17316  0.000000 50.17316 50.17316</span></span>
<span><span class="co">#&gt; 164 45.35226  0.000000 45.35226 45.35226</span></span>
<span><span class="co">#&gt; 165 39.06491  0.000000 39.06491 39.06491</span></span>
<span><span class="co">#&gt; 166 39.39597  4.772705 30.04164 48.75030</span></span>
<span><span class="co">#&gt; 167 43.69372  3.822999 36.20078 51.18667</span></span>
<span><span class="co">#&gt; 168 42.11960  0.000000 42.11960 42.11960</span></span>
<span><span class="co">#&gt; 169 29.81042  0.000000 29.81042 29.81042</span></span>
<span><span class="co">#&gt; 170 42.57055  0.000000 42.57055 42.57055</span></span>
<span><span class="co">#&gt; 171 47.81652  0.000000 47.81652 47.81652</span></span>
<span><span class="co">#&gt; 172 68.06024  0.000000 68.06024 68.06024</span></span>
<span><span class="co">#&gt; 173 35.62071  0.000000 35.62071 35.62071</span></span>
<span><span class="co">#&gt; 174 40.83933  4.755961 31.51782 50.16085</span></span>
<span><span class="co">#&gt; 175 45.83438  3.820987 38.34538 53.32338</span></span>
<span><span class="co">#&gt; 176 51.72310  9.660640 32.78859 70.65760</span></span>
<span><span class="co">#&gt; 177 33.89134  0.000000 33.89134 33.89134</span></span>
<span><span class="co">#&gt; 178 36.42808  0.000000 36.42808 36.42808</span></span>
<span><span class="co">#&gt; 179 37.57519  0.000000 37.57519 37.57519</span></span>
<span><span class="co">#&gt; 180 58.46873  0.000000 58.46873 58.46873</span></span>
<span><span class="co">#&gt; 181 19.54516  0.000000 19.54516 19.54516</span></span>
<span><span class="co">#&gt; 182 31.13541  0.000000 31.13541 31.13541</span></span>
<span><span class="co">#&gt; 183 40.89955  0.000000 40.89955 40.89955</span></span>
<span><span class="co">#&gt; 184 42.08852  9.685702 23.10490 61.07215</span></span>
<span><span class="co">#&gt; 185 22.18809  0.000000 22.18809 22.18809</span></span>
<span><span class="co">#&gt; 186 41.05857  0.000000 41.05857 41.05857</span></span>
<span><span class="co">#&gt; 187 37.32452  0.000000 37.32452 37.32452</span></span>
<span><span class="co">#&gt; 188 47.28633  9.744787 28.18689 66.38576</span></span>
<span><span class="co">#&gt; 189 35.28933  5.649814 24.21590 46.36277</span></span>
<span><span class="co">#&gt; 190 43.12432  0.000000 43.12432 43.12432</span></span>
<span><span class="co">#&gt; 191 41.99349  0.000000 41.99349 41.99349</span></span>
<span><span class="co">#&gt; 192 49.12250  9.742215 30.02811 68.21689</span></span>
<span><span class="co">#&gt; 193 44.03080  0.000000 44.03080 44.03080</span></span>
<span><span class="co">#&gt; 194 38.66417  0.000000 38.66417 38.66417</span></span>
<span><span class="co">#&gt; 195 53.45993  0.000000 53.45993 53.45993</span></span>
<span><span class="co">#&gt; 196 53.14026  9.701180 34.12630 72.15423</span></span>
<span><span class="co">#&gt; 197 29.81948  0.000000 29.81948 29.81948</span></span>
<span><span class="co">#&gt; 198 30.43859  0.000000 30.43859 30.43859</span></span>
<span><span class="co">#&gt; 199 40.18095  0.000000 40.18095 40.18095</span></span>
<span><span class="co">#&gt; 200 48.07272  9.683770 29.09288 67.05256</span></span>
<span><span class="co">#&gt; 201 26.78578  0.000000 26.78578 26.78578</span></span>
<span><span class="co">#&gt; 202 34.55115  0.000000 34.55115 34.55115</span></span>
<span><span class="co">#&gt; 203 44.66449  3.862911 37.09332 52.23566</span></span>
<span><span class="co">#&gt; 204 40.06421  0.000000 40.06421 40.06421</span></span>
<span><span class="co">#&gt; 205 36.66313  5.713540 25.46480 47.86147</span></span>
<span><span class="co">#&gt; 206 43.09329  0.000000 43.09329 43.09329</span></span>
<span><span class="co">#&gt; 207 46.09670  3.885440 38.48138 53.71202</span></span>
<span><span class="co">#&gt; 208 45.71567  0.000000 45.71567 45.71567</span></span>
<span><span class="co">#&gt; 209 40.74992  0.000000 40.74992 40.74992</span></span>
<span><span class="co">#&gt; 210 44.74635  0.000000 44.74635 44.74635</span></span>
<span><span class="co">#&gt; 211 47.51420  3.806246 40.05410 54.97431</span></span>
<span><span class="co">#&gt; 212 53.24620  9.634106 34.36369 72.12870</span></span>
<span><span class="co">#&gt; 213 40.35635  6.336839 27.93638 52.77633</span></span>
<span><span class="co">#&gt; 214 45.16757  5.233093 34.91089 55.42424</span></span>
<span><span class="co">#&gt; 215 50.02199  3.964035 42.25262 57.79136</span></span>
<span><span class="co">#&gt; 216 56.03985  9.851431 36.73140 75.34830</span></span>
<span><span class="co">#&gt; 217 40.14674  0.000000 40.14674 40.14674</span></span>
<span><span class="co">#&gt; 218 48.75859  0.000000 48.75859 48.75859</span></span>
<span><span class="co">#&gt; 219 46.43462  0.000000 46.43462 46.43462</span></span>
<span><span class="co">#&gt; 220 53.05319  9.681879 34.07705 72.02932</span></span>
<span><span class="co">#&gt; 221 29.33990  0.000000 29.33990 29.33990</span></span>
<span><span class="co">#&gt; 222 36.24424  4.736448 26.96098 45.52751</span></span>
<span><span class="co">#&gt; 223 42.39946  3.797689 34.95613 49.84280</span></span>
<span><span class="co">#&gt; 224 47.93165  0.000000 47.93165 47.93165</span></span>
<span><span class="co">#&gt; 225 36.59443  5.536196 25.74369 47.44518</span></span>
<span><span class="co">#&gt; 226 41.11632  0.000000 41.11632 41.11632</span></span>
<span><span class="co">#&gt; 227 47.05889  0.000000 47.05889 47.05889</span></span>
<span><span class="co">#&gt; 228 52.24599  0.000000 52.24599 52.24599</span></span>
<span><span class="co">#&gt; 229 45.12054  5.722896 33.90387 56.33721</span></span>
<span><span class="co">#&gt; 230 54.14236  0.000000 54.14236 54.14236</span></span>
<span><span class="co">#&gt; 231 50.44618  0.000000 50.44618 50.44618</span></span>
<span><span class="co">#&gt; 232 58.53593  9.812513 39.30376 77.76811</span></span>
<span><span class="co">#&gt; 233 37.53657  0.000000 37.53657 37.53657</span></span>
<span><span class="co">#&gt; 234 44.28282  4.705849 35.05952 53.50611</span></span>
<span><span class="co">#&gt; 235 49.45840  0.000000 49.45840 49.45840</span></span>
<span><span class="co">#&gt; 236 59.12866  0.000000 59.12866 59.12866</span></span>
<span><span class="co">#&gt; 237 40.31268  0.000000 40.31268 40.31268</span></span>
<span><span class="co">#&gt; 238 39.66049  0.000000 39.66049 39.66049</span></span>
<span><span class="co">#&gt; 239 50.89726  0.000000 50.89726 50.89726</span></span>
<span><span class="co">#&gt; 240 56.13116  0.000000 56.13116 56.13116</span></span>
<span><span class="co">#&gt; 241 32.82981  0.000000 32.82981 32.82981</span></span>
<span><span class="co">#&gt; 242 46.53837  0.000000 46.53837 46.53837</span></span>
<span><span class="co">#&gt; 243 44.46016  3.813273 36.98629 51.93404</span></span>
<span><span class="co">#&gt; 244 51.81265  0.000000 51.81265 51.81265</span></span>
<span><span class="co">#&gt; 245 27.76886  5.798215 16.40457 39.13316</span></span>
<span><span class="co">#&gt; 246 29.91939  0.000000 29.91939 29.91939</span></span>
<span><span class="co">#&gt; 247 40.70944  3.919446 33.02746 48.39141</span></span>
<span><span class="co">#&gt; 248 44.37942  9.772369 25.22592 63.53291</span></span>
<span><span class="co">#&gt; 249 43.47695  5.657111 32.38922 54.56469</span></span>
<span><span class="co">#&gt; 250 51.05656  0.000000 51.05656 51.05656</span></span>
<span><span class="co">#&gt; 251 50.50059  0.000000 50.50059 50.50059</span></span>
<span><span class="co">#&gt; 252 64.11388  0.000000 64.11388 64.11388</span></span>
<span><span class="co">#&gt; 253 32.21843  0.000000 32.21843 32.21843</span></span>
<span><span class="co">#&gt; 254 29.64732  0.000000 29.64732 29.64732</span></span>
<span><span class="co">#&gt; 255 42.48707  3.825593 34.98904 49.98509</span></span>
<span><span class="co">#&gt; 256 45.09919  0.000000 45.09919 45.09919</span></span>
<span><span class="co">#&gt; 257 39.75659  0.000000 39.75659 39.75659</span></span>
<span><span class="co">#&gt; 258 37.28894  0.000000 37.28894 37.28894</span></span>
<span><span class="co">#&gt; 259 44.80145  0.000000 44.80145 44.80145</span></span>
<span><span class="co">#&gt; 260 65.95920  0.000000 65.95920 65.95920</span></span>
<span><span class="co">#&gt; 261 33.43439  0.000000 33.43439 33.43439</span></span>
<span><span class="co">#&gt; 262 33.57042  0.000000 33.57042 33.57042</span></span>
<span><span class="co">#&gt; 263 39.91543  0.000000 39.91543 39.91543</span></span>
<span><span class="co">#&gt; 264 49.57098  0.000000 49.57098 49.57098</span></span>
<span><span class="co">#&gt; 265 38.91634  0.000000 38.91634 38.91634</span></span>
<span><span class="co">#&gt; 266 36.69011  0.000000 36.69011 36.69011</span></span>
<span><span class="co">#&gt; 267 45.66665  0.000000 45.66665 45.66665</span></span>
<span><span class="co">#&gt; 268 52.07431  0.000000 52.07431 52.07431</span></span>
<span><span class="co">#&gt; 269 42.21411  0.000000 42.21411 42.21411</span></span>
<span><span class="co">#&gt; 270 45.02901  0.000000 45.02901 45.02901</span></span>
<span><span class="co">#&gt; 271 50.22530  3.787549 42.80184 57.64877</span></span>
<span><span class="co">#&gt; 272 56.56084  9.613563 37.71861 75.40308</span></span>
<span><span class="co">#&gt; 273 30.98338  0.000000 30.98338 30.98338</span></span>
<span><span class="co">#&gt; 274 44.72932  0.000000 44.72932 44.72932</span></span>
<span><span class="co">#&gt; 275 40.68711  0.000000 40.68711 40.68711</span></span>
<span><span class="co">#&gt; 276 34.71530  0.000000 34.71530 34.71530</span></span>
<span><span class="co">#&gt; 277 27.30752  0.000000 27.30752 27.30752</span></span>
<span><span class="co">#&gt; 278 37.31585  0.000000 37.31585 37.31585</span></span>
<span><span class="co">#&gt; 279 42.23592  3.774888 34.83727 49.63456</span></span>
<span><span class="co">#&gt; 280 44.83000  0.000000 44.83000 44.83000</span></span>
<span><span class="co">#&gt; 281 32.93042  0.000000 32.93042 32.93042</span></span>
<span><span class="co">#&gt; 282 44.91911  0.000000 44.91911 44.91911</span></span>
<span><span class="co">#&gt; 283 45.68636  0.000000 45.68636 45.68636</span></span>
<span><span class="co">#&gt; 284 65.98800  0.000000 65.98800 65.98800</span></span>
<span><span class="co">#&gt; 285 46.60130  0.000000 46.60130 46.60130</span></span>
<span><span class="co">#&gt; 286 40.89786  0.000000 40.89786 40.89786</span></span>
<span><span class="co">#&gt; 287 46.66708  0.000000 46.66708 46.66708</span></span>
<span><span class="co">#&gt; 288 53.97575  9.695349 34.97322 72.97829</span></span>
<span><span class="co">#&gt; 289 34.51394  6.017235 22.72038 46.30751</span></span>
<span><span class="co">#&gt; 290 40.31956  5.104486 30.31495 50.32417</span></span>
<span><span class="co">#&gt; 291 43.83270  0.000000 43.83270 43.83270</span></span>
<span><span class="co">#&gt; 292 44.11604  0.000000 44.11604 44.11604</span></span>
<span><span class="co">#&gt; 293 38.29612  0.000000 38.29612 38.29612</span></span>
<span><span class="co">#&gt; 294 42.38074  4.737909 33.09461 51.66687</span></span>
<span><span class="co">#&gt; 295 51.38570  0.000000 51.38570 51.38570</span></span>
<span><span class="co">#&gt; 296 56.20979  0.000000 56.20979 56.20979</span></span>
<span><span class="co">#&gt; 297 35.93809  5.662820 24.83917 47.03701</span></span>
<span><span class="co">#&gt; 298 43.45819  0.000000 43.45819 43.45819</span></span>
<span><span class="co">#&gt; 299 38.38741  0.000000 38.38741 38.38741</span></span>
<span><span class="co">#&gt; 300 56.42818  0.000000 56.42818 56.42818</span></span>
<span><span class="co">#&gt; 301 39.05050  0.000000 39.05050 39.05050</span></span>
<span><span class="co">#&gt; 302 44.66707  4.734130 35.38834 53.94579</span></span>
<span><span class="co">#&gt; 303 49.86836  3.798310 42.42381 57.31291</span></span>
<span><span class="co">#&gt; 304 54.09200  0.000000 54.09200 54.09200</span></span>
<span><span class="co">#&gt; 305 31.40521  0.000000 31.40521 31.40521</span></span>
<span><span class="co">#&gt; 306 46.13330  0.000000 46.13330 46.13330</span></span>
<span><span class="co">#&gt; 307 45.29845  0.000000 45.29845 45.29845</span></span>
<span><span class="co">#&gt; 308 28.06936  0.000000 28.06936 28.06936</span></span>
<span><span class="co">#&gt; 309 39.05960  5.575819 28.13119 49.98800</span></span>
<span><span class="co">#&gt; 310 42.50283  0.000000 42.50283 42.50283</span></span>
<span><span class="co">#&gt; 311 46.45368  0.000000 46.45368 46.45368</span></span>
<span><span class="co">#&gt; 312 64.97366  0.000000 64.97366 64.97366</span></span>
<span><span class="co">#&gt; 313 30.67876  6.209504 18.50835 42.84916</span></span>
<span><span class="co">#&gt; 314 35.63991  5.168247 25.51033 45.76949</span></span>
<span><span class="co">#&gt; 315 41.27878  3.939781 33.55695 49.00061</span></span>
<span><span class="co">#&gt; 316 43.97847  0.000000 43.97847 43.97847</span></span>
<span><span class="co">#&gt; 317 35.33466  0.000000 35.33466 35.33466</span></span>
<span><span class="co">#&gt; 318 39.34378  0.000000 39.34378 39.34378</span></span>
<span><span class="co">#&gt; 319 41.27633  0.000000 41.27633 41.27633</span></span>
<span><span class="co">#&gt; 320 50.74572  9.593589 31.94263 69.54881</span></span>
<span><span class="co">#&gt; 321 34.18429  5.567728 23.27174 45.09684</span></span>
<span><span class="co">#&gt; 322 39.83058  0.000000 39.83058 39.83058</span></span>
<span><span class="co">#&gt; 323 43.49673  0.000000 43.49673 43.49673</span></span>
<span><span class="co">#&gt; 324 44.06114  0.000000 44.06114 44.06114</span></span>
<span><span class="co">#&gt; 325 41.43742  0.000000 41.43742 41.43742</span></span>
<span><span class="co">#&gt; 326 40.68384  4.752301 31.36950 49.99818</span></span>
<span><span class="co">#&gt; 327 46.16954  0.000000 46.16954 46.16954</span></span>
<span><span class="co">#&gt; 328 54.24024  0.000000 54.24024 54.24024</span></span>
<span><span class="co">#&gt; 329 36.61831  0.000000 36.61831 36.61831</span></span>
<span><span class="co">#&gt; 330 42.09272  0.000000 42.09272 42.09272</span></span>
<span><span class="co">#&gt; 331 50.69556  0.000000 50.69556 50.69556</span></span>
<span><span class="co">#&gt; 332 51.72563  0.000000 51.72563 51.72563</span></span>
<span><span class="co">#&gt; 333 32.08271  6.224939 19.88206 44.28337</span></span>
<span><span class="co">#&gt; 334 36.39974  5.176989 26.25303 46.54645</span></span>
<span><span class="co">#&gt; 335 41.38610  3.949088 33.64603 49.12617</span></span>
<span><span class="co">#&gt; 336 53.89947  0.000000 53.89947 53.89947</span></span>
<span><span class="co">#&gt; 337 31.94884  5.992019 20.20470 43.69298</span></span>
<span><span class="co">#&gt; 338 36.34138  5.082315 26.38023 46.30253</span></span>
<span><span class="co">#&gt; 339 39.94420  0.000000 39.94420 39.94420</span></span>
<span><span class="co">#&gt; 340 56.42482  0.000000 56.42482 56.42482</span></span>
<span><span class="co">#&gt; 341 41.86385  0.000000 41.86385 41.86385</span></span>
<span><span class="co">#&gt; 342 34.56420  0.000000 34.56420 34.56420</span></span>
<span><span class="co">#&gt; 343 38.68927  0.000000 38.68927 38.68927</span></span>
<span><span class="co">#&gt; 344 62.88743  0.000000 62.88743 62.88743</span></span>
<span><span class="co">#&gt; 345 28.85343  0.000000 28.85343 28.85343</span></span>
<span><span class="co">#&gt; 346 38.89808  4.816314 29.45828 48.33789</span></span>
<span><span class="co">#&gt; 347 49.29495  0.000000 49.29495 49.29495</span></span>
<span><span class="co">#&gt; 348 48.90884  9.717830 29.86224 67.95543</span></span>
<span><span class="co">#&gt; 349 28.74029  0.000000 28.74029 28.74029</span></span>
<span><span class="co">#&gt; 350 36.38836  4.731296 27.11519 45.66153</span></span>
<span><span class="co">#&gt; 351 43.59994  0.000000 43.59994 43.59994</span></span>
<span><span class="co">#&gt; 352 57.38616  0.000000 57.38616 57.38616</span></span>
<span><span class="co">#&gt; 353 35.36824  0.000000 35.36824 35.36824</span></span>
<span><span class="co">#&gt; 354 43.06110  0.000000 43.06110 43.06110</span></span>
<span><span class="co">#&gt; 355 31.27551  0.000000 31.27551 31.27551</span></span>
<span><span class="co">#&gt; 356 54.13245  0.000000 54.13245 54.13245</span></span>
<span><span class="co">#&gt; 357 25.97050  0.000000 25.97050 25.97050</span></span>
<span><span class="co">#&gt; 358 34.04514  4.771834 24.69252 43.39777</span></span>
<span><span class="co">#&gt; 359 40.67015  3.824350 33.17456 48.16574</span></span>
<span><span class="co">#&gt; 360 44.36054  9.679443 25.38918 63.33190</span></span>
<span><span class="co">#&gt; 361 39.69391  5.986137 27.96130 51.42653</span></span>
<span><span class="co">#&gt; 362 44.79720  5.080982 34.83866 54.75574</span></span>
<span><span class="co">#&gt; 363 51.17493  0.000000 51.17493 51.17493</span></span>
<span><span class="co">#&gt; 364 48.44043  0.000000 48.44043 48.44043</span></span>
<span><span class="co">#&gt; 365 43.33128  0.000000 43.33128 43.33128</span></span>
<span><span class="co">#&gt; 366 46.45918  4.756622 37.13638 55.78199</span></span>
<span><span class="co">#&gt; 367 55.93546  0.000000 55.93546 55.93546</span></span>
<span><span class="co">#&gt; 368 54.15312  0.000000 54.15312 54.15312</span></span>
<span><span class="co">#&gt; 369 33.79699  5.568759 22.88242 44.71155</span></span>
<span><span class="co">#&gt; 370 40.60252  0.000000 40.60252 40.60252</span></span>
<span><span class="co">#&gt; 371 44.44715  0.000000 44.44715 44.44715</span></span>
<span><span class="co">#&gt; 372 40.54161  0.000000 40.54161 40.54161</span></span>
<span><span class="co">#&gt; 373 33.95563  0.000000 33.95563 33.95563</span></span>
<span><span class="co">#&gt; 374 36.84083  4.708234 27.61286 46.06879</span></span>
<span><span class="co">#&gt; 375 43.67802  0.000000 43.67802 43.67802</span></span>
<span><span class="co">#&gt; 376 42.76023  0.000000 42.76023 42.76023</span></span>
<span><span class="co">#&gt; 377 34.18486  5.670318 23.07124 45.29848</span></span>
<span><span class="co">#&gt; 378 42.82678  0.000000 42.82678 42.82678</span></span>
<span><span class="co">#&gt; 379 39.59218  0.000000 39.59218 39.59218</span></span>
<span><span class="co">#&gt; 380 47.93427  9.763892 28.79739 67.07114</span></span>
<span><span class="co">#&gt; 381 33.49216  0.000000 33.49216 33.49216</span></span>
<span><span class="co">#&gt; 382 35.39266  0.000000 35.39266 35.39266</span></span>
<span><span class="co">#&gt; 383 42.88943  3.767668 35.50494 50.27393</span></span>
<span><span class="co">#&gt; 384 42.36266  0.000000 42.36266 42.36266</span></span>
<span><span class="co">#&gt; 385 48.54368  0.000000 48.54368 48.54368</span></span>
<span><span class="co">#&gt; 386 43.94366  0.000000 43.94366 43.94366</span></span>
<span><span class="co">#&gt; 387 50.98218  3.843404 43.44925 58.51512</span></span>
<span><span class="co">#&gt; 388 47.91204  0.000000 47.91204 47.91204</span></span>
<span><span class="co">#&gt; 389 20.72928  0.000000 20.72928 20.72928</span></span>
<span><span class="co">#&gt; 390 28.00599  0.000000 28.00599 28.00599</span></span>
<span><span class="co">#&gt; 391 40.19255  0.000000 40.19255 40.19255</span></span>
<span><span class="co">#&gt; 392 37.79360  0.000000 37.79360 37.79360</span></span>
<span><span class="co">#&gt; 393 32.17343  5.756572 20.89076 43.45611</span></span>
<span><span class="co">#&gt; 394 36.75177  0.000000 36.75177 36.75177</span></span>
<span><span class="co">#&gt; 395 42.75025  3.876654 35.15215 50.34835</span></span>
<span><span class="co">#&gt; 396 47.37158  9.724823 28.31127 66.43188</span></span>
<span><span class="co">#&gt; 397 34.59822  0.000000 34.59822 34.59822</span></span>
<span><span class="co">#&gt; 398 39.32034  0.000000 39.32034 39.32034</span></span>
<span><span class="co">#&gt; 399 40.65702  0.000000 40.65702 40.65702</span></span>
<span><span class="co">#&gt; 400 48.52002  9.581534 29.74056 67.29948</span></span>
<span><span class="co">#&gt; 401 40.41786  5.654539 29.33516 51.50055</span></span>
<span><span class="co">#&gt; 402 43.03255  0.000000 43.03255 43.03255</span></span>
<span><span class="co">#&gt; 403 54.65715  0.000000 54.65715 54.65715</span></span>
<span><span class="co">#&gt; 404 55.54195  9.746507 36.43914 74.64475</span></span>
<span><span class="co">#&gt; 405 35.55742  0.000000 35.55742 35.55742</span></span>
<span><span class="co">#&gt; 406 43.70215  0.000000 43.70215 43.70215</span></span>
<span><span class="co">#&gt; 407 42.52157  0.000000 42.52157 42.52157</span></span>
<span><span class="co">#&gt; 408 54.89337  0.000000 54.89337 54.89337</span></span>
<span><span class="co">#&gt; 409 32.03460  0.000000 32.03460 32.03460</span></span>
<span><span class="co">#&gt; 410 29.45107  0.000000 29.45107 29.45107</span></span>
<span><span class="co">#&gt; 411 45.35138  0.000000 45.35138 45.35138</span></span>
<span><span class="co">#&gt; 412 45.33026  9.655106 26.40660 64.25392</span></span>
<span><span class="co">#&gt; 413 38.73784  0.000000 38.73784 38.73784</span></span>
<span><span class="co">#&gt; 414 39.30063  4.744771 30.00104 48.60021</span></span>
<span><span class="co">#&gt; 415 41.42283  0.000000 41.42283 41.42283</span></span>
<span><span class="co">#&gt; 416 47.32385  0.000000 47.32385 47.32385</span></span>
<span><span class="co">#&gt; 417 40.41284  5.693716 29.25336 51.57232</span></span>
<span><span class="co">#&gt; 418 47.55310  0.000000 47.55310 47.55310</span></span>
<span><span class="co">#&gt; 419 49.06509  0.000000 49.06509 49.06509</span></span>
<span><span class="co">#&gt; 420 53.79511  9.787574 34.61182 72.97840</span></span>
<span><span class="co">#&gt; 421 29.22591  0.000000 29.22591 29.22591</span></span>
<span><span class="co">#&gt; 422 40.08175  0.000000 40.08175 40.08175</span></span>
<span><span class="co">#&gt; 423 45.68142  0.000000 45.68142 45.68142</span></span>
<span><span class="co">#&gt; 424 41.47403  0.000000 41.47403 41.47403</span></span>
<span><span class="co">#&gt; 425 37.55612  6.054508 25.68950 49.42274</span></span>
<span><span class="co">#&gt; 426 41.98123  5.126912 31.93266 52.02979</span></span>
<span><span class="co">#&gt; 427 42.51970  0.000000 42.51970 42.51970</span></span>
<span><span class="co">#&gt; 428 69.36099  0.000000 69.36099 69.36099</span></span>
<span><span class="co">#&gt; 429 42.39760  0.000000 42.39760 42.39760</span></span>
<span><span class="co">#&gt; 430 43.72376  0.000000 43.72376 43.72376</span></span>
<span><span class="co">#&gt; 431 49.47601  0.000000 49.47601 49.47601</span></span>
<span><span class="co">#&gt; 432 51.94188  0.000000 51.94188 51.94188</span></span>
<span><span class="co">#&gt; 433 31.77722  5.649803 20.70381 42.85063</span></span>
<span><span class="co">#&gt; 434 40.59100  0.000000 40.59100 40.59100</span></span>
<span><span class="co">#&gt; 435 39.97833  0.000000 39.97833 39.97833</span></span>
<span><span class="co">#&gt; 436 31.69049  0.000000 31.69049 31.69049</span></span>
<span><span class="co">#&gt; 437 33.99809  5.621072 22.98099 45.01519</span></span>
<span><span class="co">#&gt; 438 37.20517  0.000000 37.20517 37.20517</span></span>
<span><span class="co">#&gt; 439 46.28740  0.000000 46.28740 46.28740</span></span>
<span><span class="co">#&gt; 440 49.81365  9.707624 30.78706 68.84024</span></span>
<span><span class="co">#&gt; 441 35.15913  6.237532 22.93379 47.38447</span></span>
<span><span class="co">#&gt; 442 40.63997  5.195156 30.45765 50.82229</span></span>
<span><span class="co">#&gt; 443 46.80529  3.974044 39.01631 54.59428</span></span>
<span><span class="co">#&gt; 444 41.58720  0.000000 41.58720 41.58720</span></span>
<span><span class="co">#&gt; 445 32.17365  0.000000 32.17365 32.17365</span></span>
<span><span class="co">#&gt; 446 37.07479  4.723605 27.81670 46.33289</span></span>
<span><span class="co">#&gt; 447 40.69375  0.000000 40.69375 40.69375</span></span>
<span><span class="co">#&gt; 448 47.52336  9.619916 28.66867 66.37805</span></span>
<span><span class="co">#&gt; 449 32.28771  0.000000 32.28771 32.28771</span></span>
<span><span class="co">#&gt; 450 41.76205  0.000000 41.76205 41.76205</span></span>
<span><span class="co">#&gt; 451 40.06768  0.000000 40.06768 40.06768</span></span>
<span><span class="co">#&gt; 452 47.21582  9.604447 28.39145 66.04019</span></span>
<span><span class="co">#&gt; 453 29.14213  0.000000 29.14213 29.14213</span></span>
<span><span class="co">#&gt; 454 39.50989  0.000000 39.50989 39.50989</span></span>
<span><span class="co">#&gt; 455 43.32349  0.000000 43.32349 43.32349</span></span>
<span><span class="co">#&gt; 456 47.16756  0.000000 47.16756 47.16756</span></span>
<span><span class="co">#&gt; 457 40.93020  0.000000 40.93020 40.93020</span></span>
<span><span class="co">#&gt; 458 42.19406  0.000000 42.19406 42.19406</span></span>
<span><span class="co">#&gt; 459 41.21057  0.000000 41.21057 41.21057</span></span>
<span><span class="co">#&gt; 460 49.76205  9.678268 30.79300 68.73111</span></span>
<span><span class="co">#&gt; 461 38.54330  0.000000 38.54330 38.54330</span></span>
<span><span class="co">#&gt; 462 41.44104  4.721838 32.18640 50.69567</span></span>
<span><span class="co">#&gt; 463 43.96324  0.000000 43.96324 43.96324</span></span>
<span><span class="co">#&gt; 464 42.67652  0.000000 42.67652 42.67652</span></span>
<span><span class="co">#&gt; 465 22.79584  0.000000 22.79584 22.79584</span></span>
<span><span class="co">#&gt; 466 33.91004  4.819802 24.46340 43.35668</span></span>
<span><span class="co">#&gt; 467 41.58421  3.868905 34.00129 49.16712</span></span>
<span><span class="co">#&gt; 468 44.31106  9.734993 25.23082 63.39130</span></span>
<span><span class="co">#&gt; 469 31.43559  0.000000 31.43559 31.43559</span></span>
<span><span class="co">#&gt; 470 38.85064  0.000000 38.85064 38.85064</span></span>
<span><span class="co">#&gt; 471 48.24288  0.000000 48.24288 48.24288</span></span>
<span><span class="co">#&gt; 472 46.15940  9.733764 27.08157 65.23723</span></span>
<span><span class="co">#&gt; 473 44.71302  0.000000 44.71302 44.71302</span></span>
<span><span class="co">#&gt; 474 51.85370  0.000000 51.85370 51.85370</span></span>
<span><span class="co">#&gt; 475 50.77548  3.841975 43.24535 58.30562</span></span>
<span><span class="co">#&gt; 476 58.11432  9.678110 39.14557 77.08307</span></span>
<span><span class="co">#&gt; 477 30.56757  0.000000 30.56757 30.56757</span></span>
<span><span class="co">#&gt; 478 35.65607  4.753774 26.33885 44.97330</span></span>
<span><span class="co">#&gt; 479 41.25037  3.807173 33.78844 48.71229</span></span>
<span><span class="co">#&gt; 480 45.88736  9.660673 26.95279 64.82193</span></span>
<span><span class="co">#&gt; 481 37.37624  6.222732 25.17990 49.57257</span></span>
<span><span class="co">#&gt; 482 41.66978  5.182030 31.51319 51.82637</span></span>
<span><span class="co">#&gt; 483 45.99979  3.963307 38.23185 53.76773</span></span>
<span><span class="co">#&gt; 484 59.90473  0.000000 59.90473 59.90473</span></span>
<span><span class="co">#&gt; 485 33.87728  6.266356 21.59544 46.15911</span></span>
<span><span class="co">#&gt; 486 37.28988  5.289179 26.92328 47.65648</span></span>
<span><span class="co">#&gt; 487 49.76150  0.000000 49.76150 49.76150</span></span>
<span><span class="co">#&gt; 488 46.60552 10.011086 26.98415 66.22689</span></span>
<span><span class="co">#&gt; 489 47.21985  0.000000 47.21985 47.21985</span></span>
<span><span class="co">#&gt; 490 40.34525  0.000000 40.34525 40.34525</span></span>
<span><span class="co">#&gt; 491 48.29793  0.000000 48.29793 48.29793</span></span>
<span><span class="co">#&gt; 492 54.57153  9.690632 35.57824 73.56482</span></span>
<span><span class="co">#&gt; 493 36.13680  5.594379 25.17202 47.10158</span></span>
<span><span class="co">#&gt; 494 44.39634  0.000000 44.39634 44.39634</span></span>
<span><span class="co">#&gt; 495 41.71421  0.000000 41.71421 41.71421</span></span>
<span><span class="co">#&gt; 496 47.37535  0.000000 47.37535 47.37535</span></span>
<span><span class="co">#&gt; 497 42.03797  0.000000 42.03797 42.03797</span></span>
<span><span class="co">#&gt; 498 37.56100  0.000000 37.56100 37.56100</span></span>
<span><span class="co">#&gt; 499 45.11793  0.000000 45.11793 45.11793</span></span>
<span><span class="co">#&gt; 500 52.86788  9.663191 33.92837 71.80739</span></span>
<span><span class="co">#&gt; 501 34.62530  0.000000 34.62530 34.62530</span></span>
<span><span class="co">#&gt; 502 45.28206  0.000000 45.28206 45.28206</span></span>
<span><span class="co">#&gt; 503 44.51505  3.813649 37.04043 51.98966</span></span>
<span><span class="co">#&gt; 504 63.57761  0.000000 63.57761 63.57761</span></span>
<span><span class="co">#&gt; 505 35.80878  0.000000 35.80878 35.80878</span></span>
<span><span class="co">#&gt; 506 40.93038  4.731397 31.65702 50.20375</span></span>
<span><span class="co">#&gt; 507 45.85156  3.801097 38.40155 53.30157</span></span>
<span><span class="co">#&gt; 508 52.67314  0.000000 52.67314 52.67314</span></span>
<span><span class="co">#&gt; 509 35.88734  0.000000 35.88734 35.88734</span></span>
<span><span class="co">#&gt; 510 38.73222  0.000000 38.73222 38.73222</span></span>
<span><span class="co">#&gt; 511 46.70361  0.000000 46.70361 46.70361</span></span>
<span><span class="co">#&gt; 512 53.65398  0.000000 53.65398 53.65398</span></span>
<span><span class="co">#&gt; 513 36.71543  0.000000 36.71543 36.71543</span></span>
<span><span class="co">#&gt; 514 43.89170  4.768765 34.54509 53.23830</span></span>
<span><span class="co">#&gt; 515 49.56246  3.822896 42.06972 57.05519</span></span>
<span><span class="co">#&gt; 516 54.83060  9.666709 35.88420 73.77700</span></span>
<span><span class="co">#&gt; 517 37.85241  5.651515 26.77564 48.92917</span></span>
<span><span class="co">#&gt; 518 41.54317  0.000000 41.54317 41.54317</span></span>
<span><span class="co">#&gt; 519 51.67909  0.000000 51.67909 51.67909</span></span>
<span><span class="co">#&gt; 520 51.76691  9.753753 32.64990 70.88391</span></span>
<span><span class="co">#&gt; 521 27.40130  0.000000 27.40130 27.40130</span></span>
<span><span class="co">#&gt; 522 30.33517  0.000000 30.33517 30.33517</span></span>
<span><span class="co">#&gt; 523 37.73092  0.000000 37.73092 37.73092</span></span>
<span><span class="co">#&gt; 524 29.11668  0.000000 29.11668 29.11668</span></span>
<span><span class="co">#&gt; 525 30.03596  5.578964 19.10139 40.97053</span></span>
<span><span class="co">#&gt; 526 32.08830  0.000000 32.08830 32.08830</span></span>
<span><span class="co">#&gt; 527 41.66067  0.000000 41.66067 41.66067</span></span>
<span><span class="co">#&gt; 528 53.90815  0.000000 53.90815 53.90815</span></span>
<span><span class="co">#&gt; 529 34.02622  5.600234 23.04996 45.00247</span></span>
<span><span class="co">#&gt; 530 35.06937  0.000000 35.06937 35.06937</span></span>
<span><span class="co">#&gt; 531 47.17615  0.000000 47.17615 47.17615</span></span>
<span><span class="co">#&gt; 532 56.49347  0.000000 56.49347 56.49347</span></span>
<span><span class="co">#&gt; 533 34.02880  5.579114 23.09394 44.96366</span></span>
<span><span class="co">#&gt; 534 38.88006  0.000000 38.88006 38.88006</span></span>
<span><span class="co">#&gt; 535 47.54070  0.000000 47.54070 47.54070</span></span>
<span><span class="co">#&gt; 536 43.53705  0.000000 43.53705 43.53705</span></span>
<span><span class="co">#&gt; 537 31.82054  0.000000 31.82054 31.82054</span></span>
<span><span class="co">#&gt; 538 39.62816  0.000000 39.62816 39.62816</span></span>
<span><span class="co">#&gt; 539 44.95543  0.000000 44.95543 44.95543</span></span>
<span><span class="co">#&gt; 540 21.11543  0.000000 21.11543 21.11543</span></span>
<span><span class="co">#&gt; 541 34.74671  0.000000 34.74671 34.74671</span></span>
<span><span class="co">#&gt; 542 43.27308  4.761738 33.94024 52.60591</span></span>
<span><span class="co">#&gt; 543 49.29538  3.814731 41.81865 56.77212</span></span>
<span><span class="co">#&gt; 544 56.69249  0.000000 56.69249 56.69249</span></span>
<span><span class="co">#&gt; 545 22.73126  0.000000 22.73126 22.73126</span></span>
<span><span class="co">#&gt; 546 32.50075  0.000000 32.50075 32.50075</span></span>
<span><span class="co">#&gt; 547 42.37206  0.000000 42.37206 42.37206</span></span>
<span><span class="co">#&gt; 548 42.89847  0.000000 42.89847 42.89847</span></span>
<span><span class="co">#&gt; 549 55.62582  0.000000 55.62582 55.62582</span></span>
<span><span class="co">#&gt; 550 45.38998  0.000000 45.38998 45.38998</span></span>
<span><span class="co">#&gt; 551 52.66743  0.000000 52.66743 52.66743</span></span>
<span><span class="co">#&gt; 552 56.87348  9.971143 37.33040 76.41657</span></span>
<span><span class="co">#&gt; 553 30.66032  6.271714 18.36798 42.95265</span></span>
<span><span class="co">#&gt; 554 37.44228  5.313096 27.02880 47.85576</span></span>
<span><span class="co">#&gt; 555 34.18931  0.000000 34.18931 34.18931</span></span>
<span><span class="co">#&gt; 556 45.59740  0.000000 45.59740 45.59740</span></span>
<span><span class="co">#&gt; 557 28.89198  0.000000 28.89198 28.89198</span></span>
<span><span class="co">#&gt; 558 38.46147  0.000000 38.46147 38.46147</span></span>
<span><span class="co">#&gt; 559 42.42099  3.772239 35.02753 49.81444</span></span>
<span><span class="co">#&gt; 560 49.90357  0.000000 49.90357 49.90357</span></span>
<span><span class="co">#&gt; 561 39.74586  5.687601 28.59837 50.89335</span></span>
<span><span class="co">#&gt; 562 44.14167  0.000000 44.14167 44.14167</span></span>
<span><span class="co">#&gt; 563 49.91712  3.872352 42.32745 57.50679</span></span>
<span><span class="co">#&gt; 564 55.24278  0.000000 55.24278 55.24278</span></span>
<span><span class="co">#&gt; 565 36.24790  6.337597 23.82644 48.66937</span></span>
<span><span class="co">#&gt; 566 41.05912  5.232697 30.80322 51.31502</span></span>
<span><span class="co">#&gt; 567 45.91354  3.968932 38.13458 53.69251</span></span>
<span><span class="co">#&gt; 568 51.93141  9.851064 32.62368 71.23914</span></span>
<span><span class="co">#&gt; 569 27.38001  0.000000 27.38001 27.38001</span></span>
<span><span class="co">#&gt; 570 33.63251  0.000000 33.63251 33.63251</span></span>
<span><span class="co">#&gt; 571 44.70168  3.870596 37.11545 52.28791</span></span>
<span><span class="co">#&gt; 572 39.34410  0.000000 39.34410 39.34410</span></span>
<span><span class="co">#&gt; 573 26.98575  0.000000 26.98575 26.98575</span></span>
<span><span class="co">#&gt; 574 24.04175  0.000000 24.04175 24.04175</span></span>
<span><span class="co">#&gt; 575 42.16648  0.000000 42.16648 42.16648</span></span>
<span><span class="co">#&gt; 576 44.75380  0.000000 44.75380 44.75380</span></span>
<span><span class="co">#&gt; 577 31.55469  0.000000 31.55469 31.55469</span></span>
<span><span class="co">#&gt; 578 44.42696  0.000000 44.42696 44.42696</span></span>
<span><span class="co">#&gt; 579 44.10343  0.000000 44.10343 44.10343</span></span>
<span><span class="co">#&gt; 580 48.06505  9.653418 29.14470 66.98541</span></span>
<span><span class="co">#&gt; 581 34.87547  5.563398 23.97141 45.77953</span></span>
<span><span class="co">#&gt; 582 37.87445  0.000000 37.87445 37.87445</span></span>
<span><span class="co">#&gt; 583 48.31828  0.000000 48.31828 48.31828</span></span>
<span><span class="co">#&gt; 584 50.21520  0.000000 50.21520 50.21520</span></span>
<span><span class="co">#&gt; 585 41.94615  0.000000 41.94615 41.94615</span></span>
<span><span class="co">#&gt; 586 39.62690  0.000000 39.62690 39.62690</span></span>
<span><span class="co">#&gt; 587 46.69763  0.000000 46.69763 46.69763</span></span>
<span><span class="co">#&gt; 588 49.44653  9.697597 30.43959 68.45347</span></span>
<span><span class="co">#&gt; 589 38.01775  5.630528 26.98211 49.05338</span></span>
<span><span class="co">#&gt; 590 43.75255  0.000000 43.75255 43.75255</span></span>
<span><span class="co">#&gt; 591 47.38873  0.000000 47.38873 47.38873</span></span>
<span><span class="co">#&gt; 592 52.70780  9.715725 33.66532 71.75027</span></span>
<span><span class="co">#&gt; 593 32.43412  0.000000 32.43412 32.43412</span></span>
<span><span class="co">#&gt; 594 43.07163  0.000000 43.07163 43.07163</span></span>
<span><span class="co">#&gt; 595 42.99551  0.000000 42.99551 42.99551</span></span>
<span><span class="co">#&gt; 596 53.82759  0.000000 53.82759 53.82759</span></span>
<span><span class="co">#&gt; 597 39.45747  6.082469 27.53605 51.37889</span></span>
<span><span class="co">#&gt; 598 42.93167  5.154112 32.82979 53.03354</span></span>
<span><span class="co">#&gt; 599 50.64802  0.000000 50.64802 50.64802</span></span>
<span><span class="co">#&gt; 600 63.44051  0.000000 63.44051 63.44051</span></span>
<span><span class="co">#&gt; 601 34.48949  0.000000 34.48949 34.48949</span></span>
<span><span class="co">#&gt; 602 40.08056  0.000000 40.08056 40.08056</span></span>
<span><span class="co">#&gt; 603 41.86656  3.776035 34.46566 49.26745</span></span>
<span><span class="co">#&gt; 604 47.46553  0.000000 47.46553 47.46553</span></span>
<span><span class="co">#&gt; 605 32.03992  5.735557 20.79844 43.28141</span></span>
<span><span class="co">#&gt; 606 37.11697  0.000000 37.11697 37.11697</span></span>
<span><span class="co">#&gt; 607 44.12071  3.907079 36.46297 51.77844</span></span>
<span><span class="co">#&gt; 608 36.25120  0.000000 36.25120 36.25120</span></span>
<span><span class="co">#&gt; 609 29.20171  0.000000 29.20171 29.20171</span></span>
<span><span class="co">#&gt; 610 31.53773  0.000000 31.53773 31.53773</span></span>
<span><span class="co">#&gt; 611 42.35683  0.000000 42.35683 42.35683</span></span>
<span><span class="co">#&gt; 612 64.78352  0.000000 64.78352 64.78352</span></span>
<span><span class="co">#&gt; 613 32.72757  0.000000 32.72757 32.72757</span></span>
<span><span class="co">#&gt; 614 37.50022  0.000000 37.50022 37.50022</span></span>
<span><span class="co">#&gt; 615 42.76167  3.778132 35.35667 50.16667</span></span>
<span><span class="co">#&gt; 616 57.03861  0.000000 57.03861 57.03861</span></span>
<span><span class="co">#&gt; 617 36.32475  0.000000 36.32475 36.32475</span></span>
<span><span class="co">#&gt; 618 40.15241  4.717823 30.90564 49.39917</span></span>
<span><span class="co">#&gt; 619 41.46725  0.000000 41.46725 41.46725</span></span>
<span><span class="co">#&gt; 620 59.01411  0.000000 59.01411 59.01411</span></span>
<span><span class="co">#&gt; 621 30.14970  0.000000 30.14970 30.14970</span></span>
<span><span class="co">#&gt; 622 34.91740  0.000000 34.91740 34.91740</span></span>
<span><span class="co">#&gt; 623 52.13900  0.000000 52.13900 52.13900</span></span>
<span><span class="co">#&gt; 624 58.73839  0.000000 58.73839 58.73839</span></span>
<span><span class="co">#&gt; 625 35.83185  0.000000 35.83185 35.83185</span></span>
<span><span class="co">#&gt; 626 41.04423  4.735212 31.76338 50.32507</span></span>
<span><span class="co">#&gt; 627 45.82688  3.805665 38.36791 53.28584</span></span>
<span><span class="co">#&gt; 628 56.41409  0.000000 56.41409 56.41409</span></span>
<span><span class="co">#&gt; 629 37.80184  5.546148 26.93159 48.67209</span></span>
<span><span class="co">#&gt; 630 43.55593  0.000000 43.55593 43.55593</span></span>
<span><span class="co">#&gt; 631 44.26320  0.000000 44.26320 44.26320</span></span>
<span><span class="co">#&gt; 632 59.25579  0.000000 59.25579 59.25579</span></span>
<span><span class="co">#&gt; 633 28.47314  0.000000 28.47314 28.47314</span></span>
<span><span class="co">#&gt; 634 47.47581  0.000000 47.47581 47.47581</span></span>
<span><span class="co">#&gt; 635 44.01685  3.876057 36.41992 51.61378</span></span>
<span><span class="co">#&gt; 636 49.57489  9.772639 30.42087 68.72891</span></span>
<span><span class="co">#&gt; 637 39.38085  5.710671 28.18814 50.57356</span></span>
<span><span class="co">#&gt; 638 46.47483  0.000000 46.47483 46.47483</span></span>
<span><span class="co">#&gt; 639 51.22677  0.000000 51.22677 51.22677</span></span>
<span><span class="co">#&gt; 640 45.82777  0.000000 45.82777 45.82777</span></span>
<span><span class="co">#&gt; 641 33.43408  5.760149 22.14439 44.72376</span></span>
<span><span class="co">#&gt; 642 39.06783  0.000000 39.06783 39.06783</span></span>
<span><span class="co">#&gt; 643 42.98333  3.875913 35.38668 50.57998</span></span>
<span><span class="co">#&gt; 644 48.01822  9.731482 28.94487 67.09158</span></span>
<span><span class="co">#&gt; 645 29.99542  0.000000 29.99542 29.99542</span></span>
<span><span class="co">#&gt; 646 35.69583  4.740593 26.40444 44.98722</span></span>
<span><span class="co">#&gt; 647 41.11547  3.806696 33.65449 48.57646</span></span>
<span><span class="co">#&gt; 648 54.17796  0.000000 54.17796 54.17796</span></span>
<span><span class="co">#&gt; 649 39.32289  5.719220 28.11342 50.53235</span></span>
<span><span class="co">#&gt; 650 44.55743  0.000000 44.55743 44.55743</span></span>
<span><span class="co">#&gt; 651 47.26282  3.895636 39.62751 54.89812</span></span>
<span><span class="co">#&gt; 652 62.59579  0.000000 62.59579 62.59579</span></span>
<span><span class="co">#&gt; 653 31.80300  5.537108 20.95047 42.65554</span></span>
<span><span class="co">#&gt; 654 35.48396  0.000000 35.48396 35.48396</span></span>
<span><span class="co">#&gt; 655 44.07768  0.000000 44.07768 44.07768</span></span>
<span><span class="co">#&gt; 656 46.57837  0.000000 46.57837 46.57837</span></span>
<span><span class="co">#&gt; 657 47.67979  0.000000 47.67979 47.67979</span></span>
<span><span class="co">#&gt; 658 47.73388  4.786444 38.35262 57.11514</span></span>
<span><span class="co">#&gt; 659 50.94631  3.846320 43.40766 58.48496</span></span>
<span><span class="co">#&gt; 660 58.47218  9.717386 39.42645 77.51790</span></span>
<span><span class="co">#&gt; 661 22.15439  0.000000 22.15439 22.15439</span></span>
<span><span class="co">#&gt; 662 35.14301  4.881795 25.57487 44.71116</span></span>
<span><span class="co">#&gt; 663 42.82000  3.907268 35.16190 50.47811</span></span>
<span><span class="co">#&gt; 664 46.24563  9.775317 27.08637 65.40490</span></span>
<span><span class="co">#&gt; 665 34.27765  0.000000 34.27765 34.27765</span></span>
<span><span class="co">#&gt; 666 36.90059  0.000000 36.90059 36.90059</span></span>
<span><span class="co">#&gt; 667 43.05627  3.769928 35.66735 50.44519</span></span>
<span><span class="co">#&gt; 668 40.54285  0.000000 40.54285 40.54285</span></span>
<span><span class="co">#&gt; 669 29.09494  0.000000 29.09494 29.09494</span></span>
<span><span class="co">#&gt; 670 37.21768  0.000000 37.21768 37.21768</span></span>
<span><span class="co">#&gt; 671 43.08491  0.000000 43.08491 43.08491</span></span>
<span><span class="co">#&gt; 672 46.50100  9.577673 27.72911 65.27290</span></span>
<span><span class="co">#&gt; 673 27.12174  0.000000 27.12174 27.12174</span></span>
<span><span class="co">#&gt; 674 34.11916  0.000000 34.11916 34.11916</span></span>
<span><span class="co">#&gt; 675 45.56320  3.880031 37.95848 53.16793</span></span>
<span><span class="co">#&gt; 676 48.00823  9.713551 28.97002 67.04644</span></span>
<span><span class="co">#&gt; 677 35.93048  5.605558 24.94379 46.91717</span></span>
<span><span class="co">#&gt; 678 40.80230  0.000000 40.80230 40.80230</span></span>
<span><span class="co">#&gt; 679 45.89269  0.000000 45.89269 45.89269</span></span>
<span><span class="co">#&gt; 680 43.69153  0.000000 43.69153 43.69153</span></span>
<span><span class="co">#&gt; 681 28.56569  5.770737 17.25525 39.87613</span></span>
<span><span class="co">#&gt; 682 29.22869  0.000000 29.22869 29.22869</span></span>
<span><span class="co">#&gt; 683 40.67646  3.939045 32.95608 48.39685</span></span>
<span><span class="co">#&gt; 684 55.68362  0.000000 55.68362 55.68362</span></span>
<span><span class="co">#&gt; 685 31.90698  0.000000 31.90698 31.90698</span></span>
<span><span class="co">#&gt; 686 37.31061  0.000000 37.31061 37.31061</span></span>
<span><span class="co">#&gt; 687 40.75546  0.000000 40.75546 40.75546</span></span>
<span><span class="co">#&gt; 688 49.50911  9.593235 30.70671 68.31150</span></span>
<span><span class="co">#&gt; 689 42.19474  0.000000 42.19474 42.19474</span></span>
<span><span class="co">#&gt; 690 44.87228  0.000000 44.87228 44.87228</span></span>
<span><span class="co">#&gt; 691 47.55198  0.000000 47.55198 47.55198</span></span>
<span><span class="co">#&gt; 692 56.68097  9.596940 37.87131 75.49063</span></span>
<span><span class="co">#&gt; 693 50.62894  0.000000 50.62894 50.62894</span></span>
<span><span class="co">#&gt; 694 45.47551  0.000000 45.47551 45.47551</span></span>
<span><span class="co">#&gt; 695 48.62168  0.000000 48.62168 48.62168</span></span>
<span><span class="co">#&gt; 696 56.58212  9.749187 37.47406 75.69018</span></span>
<span><span class="co">#&gt; 697 29.66493  0.000000 29.66493 29.66493</span></span>
<span><span class="co">#&gt; 698 34.57406  0.000000 34.57406 34.57406</span></span>
<span><span class="co">#&gt; 699 42.45295  3.779255 35.04575 49.86015</span></span>
<span><span class="co">#&gt; 700 38.11676  0.000000 38.11676 38.11676</span></span>
<span><span class="co">#&gt; 701 33.77204  0.000000 33.77204 33.77204</span></span>
<span><span class="co">#&gt; 702 34.26148  0.000000 34.26148 34.26148</span></span>
<span><span class="co">#&gt; 703 45.29511  3.853063 37.74324 52.84697</span></span>
<span><span class="co">#&gt; 704 58.81037  0.000000 58.81037 58.81037</span></span>
<span><span class="co">#&gt; 705 31.46668  6.111158 19.48904 43.44433</span></span>
<span><span class="co">#&gt; 706 36.78469  5.144500 26.70166 46.86773</span></span>
<span><span class="co">#&gt; 707 39.88119  0.000000 39.88119 39.88119</span></span>
<span><span class="co">#&gt; 708 47.32261  9.826144 28.06373 66.58150</span></span>
<span><span class="co">#&gt; 709 31.62708  0.000000 31.62708 31.62708</span></span>
<span><span class="co">#&gt; 710 37.03239  4.729226 27.76328 46.30150</span></span>
<span><span class="co">#&gt; 711 42.69162  3.788915 35.26548 50.11775</span></span>
<span><span class="co">#&gt; 712 48.22049  0.000000 48.22049 48.22049</span></span>
<span><span class="co">#&gt; 713 42.58829  0.000000 42.58829 42.58829</span></span>
<span><span class="co">#&gt; 714 45.80410  4.698963 36.59430 55.01390</span></span>
<span><span class="co">#&gt; 715 49.33262  0.000000 49.33262 49.33262</span></span>
<span><span class="co">#&gt; 716 53.74331  0.000000 53.74331 53.74331</span></span>
<span><span class="co">#&gt; 717 29.71857  0.000000 29.71857 29.71857</span></span>
<span><span class="co">#&gt; 718 30.45651  0.000000 30.45651 30.45651</span></span>
<span><span class="co">#&gt; 719 38.29800  0.000000 38.29800 38.29800</span></span>
<span><span class="co">#&gt; 720 45.15328  9.615571 26.30711 63.99946</span></span>
<span><span class="co">#&gt; 721 36.81040  0.000000 36.81040 36.81040</span></span>
<span><span class="co">#&gt; 722 37.61606  4.733690 28.33820 46.89393</span></span>
<span><span class="co">#&gt; 723 42.35045  0.000000 42.35045 42.35045</span></span>
<span><span class="co">#&gt; 724 39.39860  0.000000 39.39860 39.39860</span></span>
<span><span class="co">#&gt; 725 36.09876  6.016152 24.30732 47.89020</span></span>
<span><span class="co">#&gt; 726 40.94066  5.098526 30.94773 50.93358</span></span>
<span><span class="co">#&gt; 727 49.73629  0.000000 49.73629 49.73629</span></span>
<span><span class="co">#&gt; 728 41.58082  0.000000 41.58082 41.58082</span></span>
<span><span class="co">#&gt; 729 43.58901  0.000000 43.58901 43.58901</span></span>
<span><span class="co">#&gt; 730 40.16762  0.000000 40.16762 40.16762</span></span>
<span><span class="co">#&gt; 731 46.70338  3.815795 39.22456 54.18221</span></span>
<span><span class="co">#&gt; 732 53.94830  9.667795 34.99977 72.89683</span></span>
<span><span class="co">#&gt; 733 39.60913  5.741144 28.35669 50.86156</span></span>
<span><span class="co">#&gt; 734 41.08206  0.000000 41.08206 41.08206</span></span>
<span><span class="co">#&gt; 735 49.65683  3.914188 41.98517 57.32850</span></span>
<span><span class="co">#&gt; 736 69.37409  0.000000 69.37409 69.37409</span></span>
<span><span class="co">#&gt; 737 34.12096  5.582665 23.17914 45.06279</span></span>
<span><span class="co">#&gt; 738 41.27625  0.000000 41.27625 41.27625</span></span>
<span><span class="co">#&gt; 739 44.76138  0.000000 44.76138 44.76138</span></span>
<span><span class="co">#&gt; 740 39.69815  0.000000 39.69815 39.69815</span></span>
<span><span class="co">#&gt; 741 38.44296  0.000000 38.44296 38.44296</span></span>
<span><span class="co">#&gt; 742 48.20586  0.000000 48.20586 48.20586</span></span>
<span><span class="co">#&gt; 743 47.54082  3.905595 39.88600 55.19564</span></span>
<span><span class="co">#&gt; 744 35.50735  0.000000 35.50735 35.50735</span></span>
<span><span class="co">#&gt; 745 32.08153  0.000000 32.08153 32.08153</span></span>
<span><span class="co">#&gt; 746 37.16398  4.752728 27.84881 46.47916</span></span>
<span><span class="co">#&gt; 747 42.75619  3.807270 35.29408 50.21830</span></span>
<span><span class="co">#&gt; 748 47.39510  9.660100 28.46165 66.32855</span></span>
<span><span class="co">#&gt; 749 44.69256  0.000000 44.69256 44.69256</span></span>
<span><span class="co">#&gt; 750 41.45664  4.864206 31.92298 50.99031</span></span>
<span><span class="co">#&gt; 751 42.18689  0.000000 42.18689 42.18689</span></span>
<span><span class="co">#&gt; 752 51.68534  9.765987 32.54436 70.82632</span></span>
<span><span class="co">#&gt; 753 37.01741  0.000000 37.01741 37.01741</span></span>
<span><span class="co">#&gt; 754 38.26920  0.000000 38.26920 38.26920</span></span>
<span><span class="co">#&gt; 755 49.28806  0.000000 49.28806 49.28806</span></span>
<span><span class="co">#&gt; 756 50.67485  9.622862 31.81439 69.53532</span></span>
<span><span class="co">#&gt; 757 40.45953  0.000000 40.45953 40.45953</span></span>
<span><span class="co">#&gt; 758 45.10337  0.000000 45.10337 45.10337</span></span>
<span><span class="co">#&gt; 759 45.58250  0.000000 45.58250 45.58250</span></span>
<span><span class="co">#&gt; 760 62.96989  0.000000 62.96989 62.96989</span></span>
<span><span class="co">#&gt; 761 30.78252  0.000000 30.78252 30.78252</span></span>
<span><span class="co">#&gt; 762 41.58139  4.811277 32.15146 51.01132</span></span>
<span><span class="co">#&gt; 763 48.87398  3.849305 41.32948 56.41848</span></span>
<span><span class="co">#&gt; 764 44.69667  0.000000 44.69667 44.69667</span></span>
<span><span class="co">#&gt; 765 32.72491  0.000000 32.72491 32.72491</span></span>
<span><span class="co">#&gt; 766 45.78702  0.000000 45.78702 45.78702</span></span>
<span><span class="co">#&gt; 767 48.74886  0.000000 48.74886 48.74886</span></span>
<span><span class="co">#&gt; 768 84.08449  0.000000 84.08449 84.08449</span></span>
<span><span class="co">#&gt; 769 28.60809  5.692304 17.45138 39.76480</span></span>
<span><span class="co">#&gt; 770 30.19495  0.000000 30.19495 30.19495</span></span>
<span><span class="co">#&gt; 771 36.78573  0.000000 36.78573 36.78573</span></span>
<span><span class="co">#&gt; 772 61.03588  0.000000 61.03588 61.03588</span></span>
<span><span class="co">#&gt; 773 20.36749  0.000000 20.36749 20.36749</span></span>
<span><span class="co">#&gt; 774 35.22480  0.000000 35.22480 35.22480</span></span>
<span><span class="co">#&gt; 775 37.42847  0.000000 37.42847 37.42847</span></span>
<span><span class="co">#&gt; 776 30.20501  0.000000 30.20501 30.20501</span></span>
<span><span class="co">#&gt; 777 41.72819  5.646700 30.66087 52.79552</span></span>
<span><span class="co">#&gt; 778 49.12862  0.000000 49.12862 49.12862</span></span>
<span><span class="co">#&gt; 779 47.31234  0.000000 47.31234 47.31234</span></span>
<span><span class="co">#&gt; 780 57.08286  9.739411 37.99396 76.17175</span></span>
<span><span class="co">#&gt; 781 19.28388  0.000000 19.28388 19.28388</span></span>
<span><span class="co">#&gt; 782 30.00682  0.000000 30.00682 30.00682</span></span>
<span><span class="co">#&gt; 783 39.69711  3.895230 32.06260 47.33162</span></span>
<span><span class="co">#&gt; 784 49.21768  0.000000 49.21768 49.21768</span></span>
<span><span class="co">#&gt; 785 31.42637  6.221006 19.23342 43.61932</span></span>
<span><span class="co">#&gt; 786 36.73485  5.172897 26.59615 46.87354</span></span>
<span><span class="co">#&gt; 787 42.72556  3.946954 34.98967 50.46145</span></span>
<span><span class="co">#&gt; 788 40.13353  0.000000 40.13353 40.13353</span></span>
<span><span class="co">#&gt; 789 42.34534  0.000000 42.34534 42.34534</span></span>
<span><span class="co">#&gt; 790 52.32575  0.000000 52.32575 52.32575</span></span>
<span><span class="co">#&gt; 791 46.92223  3.895248 39.28769 54.55678</span></span>
<span><span class="co">#&gt; 792 69.26254  0.000000 69.26254 69.26254</span></span>
<span><span class="co">#&gt; 793 40.35635  6.336839 27.93638 52.77633</span></span>
<span><span class="co">#&gt; 794 45.16757  5.233093 34.91089 55.42424</span></span>
<span><span class="co">#&gt; 795 50.02199  3.964035 42.25262 57.79136</span></span>
<span><span class="co">#&gt; 796 56.03985  9.851431 36.73140 75.34830</span></span>
<span><span class="co">#&gt; 797 35.70341  0.000000 35.70341 35.70341</span></span>
<span><span class="co">#&gt; 798 41.64454  0.000000 41.64454 41.64454</span></span>
<span><span class="co">#&gt; 799 43.29513  3.774074 35.89808 50.69218</span></span>
<span><span class="co">#&gt; 800 54.25081  0.000000 54.25081 54.25081</span></span></code></pre></div>
<p>The result is now a matrix, because that is what the
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method returns for <code>mmrm</code> objects.
Note that this cannot be changed to return a <code>tibble</code> at the
moment.</p>
<p>Similarly, we can also use the <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code> method to add
predicted values to a new data set:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">model</span>, new_data <span class="op">=</span> <span class="va">fev_data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AVISIT</span>, <span class="va">.resid</span>, <span class="va">.pred</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 800 × 4</span></span></span>
<span><span class="co">#&gt;    USUBJID AVISIT .resid .pred</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> PT1     VIS1       <span style="color: #BB0000;">NA</span>  32.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> PT1     VIS2        0  40.0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> PT1     VIS3       <span style="color: #BB0000;">NA</span>  45.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> PT1     VIS4        0  20.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> PT2     VIS1       <span style="color: #BB0000;">NA</span>  28.0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> PT2     VIS2        0  31.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> PT2     VIS3        0  36.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> PT2     VIS4        0  48.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> PT3     VIS1       <span style="color: #BB0000;">NA</span>  30.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> PT3     VIS2        0  36.0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 790 more rows</span></span></span></code></pre></div>
<p>Note that here we cannot customize the <code>predict</code> options
as this is currently not supported by the <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code> method
in <code>parsnip</code>.</p>
</div>
<div class="section level4">
<h4 id="using-mmrm-in-workflows">Using mmrm in workflows<a class="anchor" aria-label="anchor" href="#using-mmrm-in-workflows"></a>
</h4>
<p>We can leverage the <code>workflows</code> package in order to fit
the same model.</p>
<ul>
<li>First we define the specification for linear regression with the
mmrm engine.</li>
<li>Second we define the workflow, by defining the outcome and
predictors that will be used in the formula. We then add the model using
the formula.</li>
<li>Lastly, we fit the model</li>
</ul>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mmrm_spec</span> <span class="op">&lt;-</span> <span class="fu">linear_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"mmrm"</span>, method <span class="op">=</span> <span class="st">"Satterthwaite"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mmrm_wflow</span> <span class="op">&lt;-</span> <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_variables</span><span class="op">(</span>outcomes <span class="op">=</span> <span class="va">FEV1</span>, predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">RACE</span>, <span class="va">ARMCD</span>, <span class="va">AVISIT</span>, <span class="va">USUBJID</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">mmrm_spec</span>, formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mmrm_wflow</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">fit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">fev_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; ══ Workflow [trained] ══════════════════════════════════════════════════════════</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Preprocessor:</span> Variables</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Model:</span> linear_reg()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Preprocessor ────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Outcomes: FEV1</span></span>
<span><span class="co">#&gt; Predictors: c(RACE, ARMCD, AVISIT, USUBJID)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Model ───────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Weights:     weights</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    3387.373</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                   30.96769899                    1.50464863 </span></span>
<span><span class="co">#&gt;                     RACEWhite                      ARMCDTRT </span></span>
<span><span class="co">#&gt;                    5.61309565                    3.77555734 </span></span>
<span><span class="co">#&gt;                    AVISITVIS2                    AVISITVIS3 </span></span>
<span><span class="co">#&gt;                    4.82858803                   10.33317002 </span></span>
<span><span class="co">#&gt;                    AVISITVIS4           ARMCDTRT:AVISITVIS2 </span></span>
<span><span class="co">#&gt;                   15.05255715                   -0.01737409 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS3           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                   -0.66753189                    0.63094392 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
<p>We can separate out the data preparation step from the modeling step
using the <code>recipes</code> package. Here we are converting the
<code>ARMCD</code> variable into a dummy variable and creating an
interaction term with the new dummy variable and each visit.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mmrm_recipe</span> <span class="op">&lt;-</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">FEV1</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">fev_data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">step_dummy</span><span class="op">(</span><span class="va">ARMCD</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">step_interact</span><span class="op">(</span>terms <span class="op">=</span> <span class="op">~</span> <span class="fu">starts_with</span><span class="op">(</span><span class="st">"ARMCD"</span><span class="op">)</span><span class="op">:</span><span class="va">AVISIT</span><span class="op">)</span></span></code></pre></div>
<p>Using <code>prep()</code> and <code>juice()</code> we can see what
the transformed data that will be used in the model fit looks like.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mmrm_recipe</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">prep</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">juice</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 800 × 13</span></span></span>
<span><span class="co">#&gt;    USUBJID AVISIT RACE       SEX   FEV1_BL WEIGHT VISITN VISITN2  FEV1 ARMCD_TRT</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> PT1     VIS1   Black or … Fema…    25.3  0.677      1  -<span style="color: #BB0000;">0.626</span>  <span style="color: #BB0000;">NA</span>           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> PT1     VIS2   Black or … Fema…    25.3  0.801      2   0.184  40.0         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> PT1     VIS3   Black or … Fema…    25.3  0.709      3  -<span style="color: #BB0000;">0.836</span>  <span style="color: #BB0000;">NA</span>           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> PT1     VIS4   Black or … Fema…    25.3  0.809      4   1.60   20.5         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> PT2     VIS1   Asian      Male     45.0  0.465      1   0.330  <span style="color: #BB0000;">NA</span>           0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> PT2     VIS2   Asian      Male     45.0  0.233      2  -<span style="color: #BB0000;">0.820</span>  31.5         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> PT2     VIS3   Asian      Male     45.0  0.360      3   0.487  36.9         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> PT2     VIS4   Asian      Male     45.0  0.507      4   0.738  48.8         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> PT3     VIS1   Black or … Fema…    43.5  0.682      1   0.576  <span style="color: #BB0000;">NA</span>           0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> PT3     VIS2   Black or … Fema…    43.5  0.892      2  -<span style="color: #BB0000;">0.305</span>  36.0         0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 790 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: ARMCD_TRT_x_AVISITVIS2 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ARMCD_TRT_x_AVISITVIS3 &lt;dbl&gt;, ARMCD_TRT_x_AVISITVIS4 &lt;dbl&gt;</span></span></span></code></pre></div>
<p>We can pass the covariance structure as well in the
<code>set_engine()</code> definition. This allows for more flexibility
on presetting different covariance structures in the pipeline while
keeping the data preparation step independent.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mmrm_spec_with_cov</span> <span class="op">&lt;-</span> <span class="fu">linear_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span></span>
<span>    <span class="st">"mmrm"</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"Satterthwaite"</span>,</span>
<span>    covariance <span class="op">=</span> <span class="fu"><a href="../reference/as.cov_struct.html">as.cov_struct</a></span><span class="op">(</span><span class="op">~</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We combine these steps into a workflow:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">mmrm_wflow_nocov</span> <span class="op">&lt;-</span> <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">mmrm_spec_with_cov</span>, formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">SEX</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">mmrm_recipe</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; ══ Workflow ════════════════════════════════════════════════════════════════════</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Preprocessor:</span> Recipe</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Model:</span> linear_reg()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Preprocessor ────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; 2 Recipe Steps</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • step_dummy()</span></span>
<span><span class="co">#&gt; • step_interact()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Model ───────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Linear Regression Model Specification (regression)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Engine-Specific Arguments:</span></span>
<span><span class="co">#&gt;   method = Satterthwaite</span></span>
<span><span class="co">#&gt;   covariance = as.cov_struct(~us(AVISIT | USUBJID))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computational engine: mmrm</span></span></code></pre></div>
<p>Last step is to fit the data with the workflow object</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fit_tidy</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">mmrm_wflow_nocov</span>, data <span class="op">=</span> <span class="va">fev_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; ══ Workflow [trained] ══════════════════════════════════════════════════════════</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Preprocessor:</span> Recipe</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Model:</span> linear_reg()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Preprocessor ────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; 2 Recipe Steps</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • step_dummy()</span></span>
<span><span class="co">#&gt; • step_interact()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Model ───────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ SEX</span></span>
<span><span class="co">#&gt; Data:        data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Weights:     weights</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    3699.803</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt; (Intercept)   SEXFemale </span></span>
<span><span class="co">#&gt; 42.80540973  0.04513432 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
<p>To retrieve the fit object from within the workflow object run the
following</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_tidy</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">hardhat</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html" class="external-link">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ SEX</span></span>
<span><span class="co">#&gt; Data:        data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Weights:     weights</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    3699.803</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt; (Intercept)   SEXFemale </span></span>
<span><span class="co">#&gt; 42.80540973  0.04513432 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p>The <code>mmrm</code> package is based on previous work internal in
Roche, namely the <code>tern</code> and <code>tern.mmrm</code> packages
which were based on <code>lme4</code>. The work done in the
<code>rbmi</code> package has been important since it used
<code>glmmTMB</code> for fitting MMRMs.</p>
<p>We would like to thank Ben Bolker from the <code>glmmTMB</code> team
for multiple discussions when we tried to get the Satterthwaite degrees
of freedom implemented with <code>glmmTMB</code> (see <a href="https://github.com/glmmTMB/glmmTMB/blob/satterthwaite_df/glmmTMB/vignettes/satterthwaite_unstructured_example2.Rmd" class="external-link uri">https://github.com/glmmTMB/glmmTMB/blob/satterthwaite_df/glmmTMB/vignettes/satterthwaite_unstructured_example2.Rmd</a>).
Also Ben helped us significantly with an example showing how to use
<code>TMB</code> for a random effect vector (<a href="https://github.com/bbolker/tmb-case-studies/tree/master/vectorMixed" class="external-link uri">https://github.com/bbolker/tmb-case-studies/tree/master/vectorMixed</a>).</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Sabanes Bove, Liming Li, Julia Dedic, Doug Kelkhoff, Kevin Kunzmann, Brian Matthew Lang, Christian Stock, Ya Wang, Dan James, Jonathan Sidi, Daniel Leibovitz, Daniel D. Sjoberg, Boehringer Ingelheim Ltd., Gilead Sciences, Inc., F. Hoffmann-La Roche AG, Merck Sharp &amp; Dohme, Inc., AstraZeneca plc.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
