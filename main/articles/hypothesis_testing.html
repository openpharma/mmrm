<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mmrm">
<title>Details of Hypothesis Testing • mmrm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Details of Hypothesis Testing">
<meta property="og:description" content="mmrm">
<meta property="og:image" content="https://openpharma.github.io/mmrm/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.11.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Introduction</h6>
    <a class="dropdown-item" href="../articles/introduction.html">Package Introduction</a>
    <a class="dropdown-item" href="../articles/methodological_introduction.html">Mixed Models for Repeated Measures</a>
    <a class="dropdown-item" href="../articles/mmrm_review_methods.html">Comparison with other software</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Covariance Structures</h6>
    <a class="dropdown-item" href="../articles/covariance.html">Covariance Structures</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Degrees of Freedom and Testing</h6>
    <a class="dropdown-item" href="../articles/hypothesis_testing.html">Details of Hypothesis Testing</a>
    <a class="dropdown-item" href="../articles/between_within.html">Between-Within</a>
    <a class="dropdown-item" href="../articles/kenward.html">Kenward-Roger</a>
    <a class="dropdown-item" href="../articles/satterthwaite.html">Satterthwaite</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Coefficient Covariance</h6>
    <a class="dropdown-item" href="../articles/coef_vcov.html">Coefficients Covariance Matrix Adjustment</a>
    <a class="dropdown-item" href="../articles/empirical_wls.html">Details of Weighted Least Square Empirical Covariance</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Algorithm Details</h6>
    <a class="dropdown-item" href="../articles/algorithm.html">Model Fitting Algorithm</a>
    <a class="dropdown-item" href="../articles/predict.html">Prediction and Simulation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Developers</h6>
    <a class="dropdown-item" href="../articles/package_structure.html">Package Structure</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<!-- start dropdown for versions --> <li class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle"
          data-bs-toggle="dropdown" role="button"
          aria-expanded="false" aria-haspopup="true"
          id="dropdown-versions">Versions</a> <div class="dropdown-menu" aria-labelledby="dropdown-versions"> <a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.11">v0.3.11</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.10">v0.3.10</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.7">v0.3.7</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.6">v0.3.6</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.5">v0.3.5</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.4">v0.3.4</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.3">v0.3.3</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.2">v0.3.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.1">v0.3.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.0">v0.3.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.2.2">v0.2.2</a> </div></li>
<!-- end dropdown for versions -->
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-reports">Reports</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-reports">
    <a class="dropdown-item" href="../coverage-report/">Coverage report</a>
    <a class="dropdown-item" href="../unit-test-report/">Unit test report</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/openpharma/mmrm">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Details of Hypothesis Testing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/mmrm/blob/HEAD/vignettes/hypothesis_testing.Rmd" class="external-link"><code>vignettes/hypothesis_testing.Rmd</code></a></small>
      <div class="d-none name"><code>hypothesis_testing.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction-to-type-iiiiii-hypothesis-testing">Introduction to Type I/II/III Hypothesis Testing<a class="anchor" aria-label="anchor" href="#introduction-to-type-iiiiii-hypothesis-testing"></a>
</h2>
<p>Type I/II/III hypothesis testing originates from analysis of
variance, however, <span class="citation">Goodnight (1980)</span>
suggests viewing this issue as hypothesis testing of fixed effects in
linear models, which avoid the “usual assumptions” and defined three
types of estimable functions. Given that type I estimable functions are
dependent on the specific order of used covariates, we focus on the type
II and III testing here.</p>
<p>For MMRM, obtaining estimable functions is equivalent to obtaining
the contrasts for linear hypothesis tests. For more details, see <span class="citation">Goodnight (1980)</span>.</p>
</div>
<div class="section level2">
<h2 id="contained-effect">Contained Effect<a class="anchor" aria-label="anchor" href="#contained-effect"></a>
</h2>
<p>Before we discuss the testing, it is important that we understand the
concept of “contained effect”. The definition of “contained effect”
is:</p>
<p>For effect <span class="math inline">\(E_2\)</span>, it is said to
contain <span class="math inline">\(E_1\)</span> if</p>
<ol style="list-style-type: decimal">
<li>the involved numerical covariate(s) are identical for these two
effects</li>
<li>all the categorical covariate(s) associated with <span class="math inline">\(E_1\)</span> are also associated with <span class="math inline">\(E_2\)</span>
</li>
</ol>
<p>For example, for the following model formula</p>
<p><span class="math inline">\(Y = A + B + A*B\)</span></p>
<p>using <span class="math inline">\(E_A\)</span>, <span class="math inline">\(E_B\)</span> and <span class="math inline">\(E_{A*B}\)</span> to denote the effect for <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>
and <span class="math inline">\(A*B\)</span> respectively, we have</p>
<ol style="list-style-type: decimal">
<li>If <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are both categorical, then <span class="math inline">\(E_{A*B}\)</span> contains <span class="math inline">\(E_{A}\)</span> and <span class="math inline">\(E_{B}\)</span>.</li>
<li>If <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are both numerical, then <span class="math inline">\(E_{A*B}\)</span> do not contain <span class="math inline">\(E_{A}\)</span> or <span class="math inline">\(E_{B}\)</span>.</li>
<li>If <span class="math inline">\(A\)</span> is categorical and <span class="math inline">\(B\)</span> is numerical, then <span class="math inline">\(E_{A*B}\)</span> contains <span class="math inline">\(E_{B}\)</span> but not <span class="math inline">\(E_{A}\)</span>.</li>
</ol>
</div>
<div class="section level2">
<h2 id="type-ii-hypothesis-testing">Type II Hypothesis Testing<a class="anchor" aria-label="anchor" href="#type-ii-hypothesis-testing"></a>
</h2>
<p>For type II hypothesis testing, the contrasts can be obtained through
the following steps:</p>
<p>Create a contrast matrix <span class="math inline">\(L\)</span>, with
rows equal to the number of parameters associated with the effect,
columns equal to the number of all parameters.</p>
<ol style="list-style-type: decimal">
<li>All columns of <span class="math inline">\(L\)</span> associated
with effect not containing <span class="math inline">\(E_1\)</span>
(except <span class="math inline">\(E_1\)</span>) are set to 0.</li>
<li>The submatrix of <span class="math inline">\(L\)</span> associated
with <span class="math inline">\(E_1\)</span> is set to <span class="math inline">\((X_1^\top M X_1)^{-}X_1^\top M X_1\)</span>
</li>
<li>Each of the remaining submatrices of L associated with an effect
<span class="math inline">\(E_2\)</span> that contains <span class="math inline">\(E_1\)</span> is <span class="math inline">\((X_1^\top M X_1)^{-}X_1^\top M X_2\)</span>
</li>
</ol>
<p>where <span class="math inline">\(X_0\)</span> stands for columns of
<span class="math inline">\(X\)</span> whose associated effect do not
contain <span class="math inline">\(E_1\)</span>, <span class="math inline">\(X_1\)</span> stands for columns of <span class="math inline">\(X\)</span> associated with <span class="math inline">\(E_1\)</span>, <span class="math inline">\(X_2\)</span> stands for columns of <span class="math inline">\(X\)</span> whose associated effect contains <span class="math inline">\(E_1\)</span>, <span class="math inline">\(M = I -
X_0(X_0^\top X_0)^{-}X_0^\top\)</span>, and <span class="math inline">\(Z^{-}\)</span> stands for the <a href="https://blogs.sas.com/content/iml/2018/11/21/generalized-inverses-for-matrices.html" class="external-link">g2
inverse</a> of <span class="math inline">\(Z\)</span>.</p>
<p>Note: Here we do not allow for singularity in general, so the g2
inverse is just the usual inverse. Thus we can use an identity matrix as
the submatrix in step 2.</p>
<p>Using <code>fev_data</code> to create our example, we have</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://openpharma.github.io/mmrm/">mmrm</a></span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span><span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">+</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">RACE</span> <span class="op">+</span> <span class="fu">ar1</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">fev_data</span><span class="op">)</span></span></code></pre></div>
<p>For this given example, we would like to test the effect of
<code>RACE</code>, <span class="math inline">\(E_{RACE}\)</span>. We
initialize the contrast matrix with</p>
<p><span class="math display">\[
\begin{matrix}
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp;
ARMCD:RACE\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
\end{matrix}
\]</span></p>
<p>Please note that this is a <span class="math inline">\(2\times
6\)</span> matrix, the rows is the number of coefficients that is
associated with <code>RACE</code>, and the columns is the total number
of coefficients 6.</p>
<p>Then following step 2, we filled in the identity matrix in the
corresponding submatrix</p>
<p><span class="math display">\[
\begin{matrix}
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp;
ARMCD:RACE\\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
\end{matrix}
\]</span></p>
<p>In the last step, for the last 2 columns, we fill the values with the
calculated result.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/component.html">component</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"x_matrix"</span><span class="op">)</span></span>
<span><span class="va">x0</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">x0</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">x0</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span> <span class="co"># solve is used because the matrix is inversible</span></span>
<span><span class="va">sub_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">m</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">x1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">m</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">x2</span></span>
<span><span class="va">sub_mat</span></span></code></pre></div>
<pre><code><span><span class="co">##                               ARMCDTRT:RACEBlack or African American</span></span>
<span><span class="co">## RACEBlack or African American                             0.42618692</span></span>
<span><span class="co">## RACEWhite                                                -0.04372702</span></span>
<span><span class="co">##                               ARMCDTRT:RACEWhite</span></span>
<span><span class="co">## RACEBlack or African American         0.02751985</span></span>
<span><span class="co">## RACEWhite                             0.58570969</span></span></code></pre>
<p><span class="math display">\[
\begin{matrix}
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp;
ARMCD:RACE\\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0.42618692 &amp; 0.02751985\\
0 &amp; 0 &amp; 0 &amp; 1 &amp; -0.04372702 &amp; 0.58570969\\
\end{matrix}
\]</span></p>
</div>
<div class="section level2">
<h2 id="type-iii-hypothesis-testing">Type III Hypothesis Testing<a class="anchor" aria-label="anchor" href="#type-iii-hypothesis-testing"></a>
</h2>
<p>For type III hypothesis testing, we assume that the hypothesis tested
should be the same for all designs with the same general form of
estimable functions. It can be defined with the following steps:</p>
<p>Create a contrast matrix <span class="math inline">\(L\)</span>, with
rows equal to the number of parameters associated with the effect,
columns equal to the number of all parameters.</p>
<ol style="list-style-type: decimal">
<li>All columns of <span class="math inline">\(L\)</span> associated
with effect not containing <span class="math inline">\(E_1\)</span>
(except <span class="math inline">\(E_1\)</span>) are set to 0.</li>
<li>The submatrix of <span class="math inline">\(L\)</span> associated
with <span class="math inline">\(E_1\)</span> is set to identity
matrix.</li>
<li>For each of the remaining submatrices of L associated with an effect
<span class="math inline">\(E_2\)</span> that contains <span class="math inline">\(E_1\)</span>, equate the values.</li>
</ol>
<p>Here equate the values means that, given that the coefficients in
step 2 are all 1 (diagonal), in step 3 this 1 is divided by the total
number of new levels.</p>
<p>Using the same example for type II testing, we also would like to
test the effect of <code>RACE</code>, <span class="math inline">\(E_{RACE}\)</span>. We initialize the contrast
matrix with</p>
<p><span class="math display">\[
\begin{matrix}
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp;
ARMCD:RACE\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
\end{matrix}
\]</span></p>
<p>Then following step 2, we filled in the identity matrix in the
corresponding submatrix</p>
<p><span class="math display">\[
\begin{matrix}
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp;
ARMCD:RACE\\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
\end{matrix}
\]</span></p>
<p>In the last step, for the last 2 columns, we fill the values to
equate the coefficients in the sub matrix. We use the coefficients for
<code>RACE</code>, and divide it by the additional levels (there is
interaction between <code>ARMCD</code> and <code>RACE</code>, the
additional covariate <code>ARMCD</code> has 2 levels) and we get 0.5 for
the coefficients.</p>
<p><span class="math display">\[
\begin{matrix}
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp;
ARMCD:RACE\\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0.5 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0.5\\
\end{matrix}
\]</span></p>
<p>Similarly, if we are testing the effect of <code>ARMCD</code> we will
have the following contrast because <code>RACE</code> has 3 levels.</p>
<p><span class="math display">\[
\begin{matrix}
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp;
ARMCD:RACE\\
0 &amp; 1 &amp; 0 &amp; 0 &amp; \frac{1}{3} &amp; \frac{1}{3}\\
\end{matrix}
\]</span></p>
</div>
<div class="section level2">
<h2 id="hypothesis-testing-in-sas">Hypothesis Testing in SAS<a class="anchor" aria-label="anchor" href="#hypothesis-testing-in-sas"></a>
</h2>
<p>In <code>PROC MIXED</code> we can specify <code>HTYPE=1,2,3</code> to
enable these hypothesis testings, and we can use option
<code>e1 e2 e3</code> to view the estimable functions.</p>
<div class="section level3">
<h3 id="special-considerations">Special Considerations<a class="anchor" aria-label="anchor" href="#special-considerations"></a>
</h3>
<div class="section level4">
<h4 id="reference-levels">Reference Levels<a class="anchor" aria-label="anchor" href="#reference-levels"></a>
</h4>
<p>For <code>PROC MIXED</code>, it is important that the categorical
values have the correct order, especially for structured covariance
(otherwise the correlation between visits can be messed up). We usually
use <code>CLASS variable(REF=)</code> to define the reference level.
However, SAS will put the reference level in the last, so if the visit
variable is included in fixed effect, there can be issues with the
comparison between SAS and R, as in R we still use the first level as
our reference.</p>
<p>When we conduct the hypothesis testing, we will also face this issue.
If reference level is different, the testing we have can be different,
e.g. if we have 3 levels, <span class="math inline">\(l_1\)</span>,
<span class="math inline">\(l_2\)</span> and <span class="math inline">\(l_3\)</span>. In theory we can test either <span class="math inline">\(l_2 - l_1\)</span>, <span class="math inline">\(l_3 - l_1\)</span> (using <span class="math inline">\(l_1\)</span> as reference), or test <span class="math inline">\(l_1 - l_3\)</span>, <span class="math inline">\(l_2 - l_3\)</span> (using <span class="math inline">\(l_3\)</span> as reference). But the result will be
slightly different. However, if we have identical tests the result will
be closer. The following example illustrate this.</p>
<div class="section level5">
<h5 id="example-of-reference-levels">Example of Reference Levels<a class="anchor" aria-label="anchor" href="#example-of-reference-levels"></a>
</h5>
<p>Assume in SAS we have the following model</p>
<pre><code>PROC MIXED DATA = fev cl method=reml;
  CLASS AVISIT(ref = 'VIS4') ARMCD(ref = 'PBO') USUBJID;
  MODEL FEV1 = ARMCD AVISIT ARMCD*AVISIT / ddfm=satterthwaite htype=3;
  REPEATED AVISIT / subject=USUBJID type=ar(1);
RUN;</code></pre>
<p>And in R we have the following model</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span><span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">+</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">ar1</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">fev_data</span><span class="op">)</span></span>
<span><span class="fu">Anova</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p>Note that for <code>AVISIT</code> there are 4 levels,
<code>VIS1</code>, <code>VIS2</code>, <code>VIS3</code> and
<code>VIS4</code>. In SAS <code>VIS4</code> is the reference, while in R
<code>VIS1</code> is the reference.</p>
<p>They both use the following matrix to test the effect of
<code>AVISIT</code> (ignoring other part of contrasts that is not
associated with <code>AVISIT</code>)</p>
<p><span class="math display">\[
\begin{matrix}
1 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 1\\
\end{matrix}
\]</span></p>
<p>But given that the reference level is different, we are testing
different things. In SAS we are testing <code>VIS1 - VIS4</code>,
<code>VIS2 - VIS4</code> and <code>VIS3 - VIS4</code>, while in R we are
testing <code>VIS2 - VIS1</code>, <code>VIS3 - VIS1</code> and
<code>VIS4 - VIS1</code>.</p>
<p>To correctly test <code>VIS1 - VIS4</code>, <code>VIS2 - VIS4</code>
and <code>VIS3 - VIS4</code> in R, we need to update the contrast to the
following matrix (ignoring the other part) to get a closer result.</p>
<p><span class="math display">\[
\begin{matrix}
0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 1\\
-1 &amp; -1 &amp; -1\\
\end{matrix}
\]</span></p>
</div>
</div>
<div class="section level4">
<h4 id="why-model-covariate-order-changes-my-testing-in-sas">Why Model Covariate Order Changes My Testing in SAS?<a class="anchor" aria-label="anchor" href="#why-model-covariate-order-changes-my-testing-in-sas"></a>
</h4>
<p>For type II/III testing, it is true that the order of covariate
should not affect the result. However, if there is an interaction term,
the reference level can be changed. With different reference levels the
result will be slightly different.</p>
</div>
<div class="section level4">
<h4 id="why-mmrm-gives-more-covariates-than-sas">Why <code>mmrm</code> Gives More Covariates Than SAS?<a class="anchor" aria-label="anchor" href="#why-mmrm-gives-more-covariates-than-sas"></a>
</h4>
<p>For <code>PROC MIXED</code>, if a model is specified as follows</p>
<pre><code>MODEL FEV1 = ARMCD SEX ARMCD * SEX ARMCD * FEV1_BL</code></pre>
<p>Then it is equivalent to the following <code>mmrm</code> model</p>
<pre><code><span><span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">FEV1_BL</span> <span class="op">-</span> <span class="va">FEV1_BL</span></span></code></pre>
<p>or</p>
<pre><code><span><span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">ARMCD</span><span class="op">:</span><span class="va">FEV1_BL</span></span></code></pre>
<p>Because SAS will not include the covariate <code>FEV1_BL</code> by
default, unless manually added. However in R we will add
<code>FEV1_BL</code> by default. Please note that in this example we
exclude the covariance structure part.</p>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-goodnight1980tests" class="csl-entry">
Goodnight JH (1980). <span>“Tests of Hypotheses in Fixed Effects Linear
Models.”</span> <em>Communications in Statistics-Theory and
Methods</em>, <strong>9</strong>(2), 167–180.
</div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Sabanes Bove, Liming Li, Julia Dedic, Doug Kelkhoff, Kevin Kunzmann, Brian Matthew Lang, Christian Stock, Ya Wang, Dan James, Jonathan Sidi, Daniel Leibovitz, Daniel D. Sjoberg, Boehringer Ingelheim Ltd., Gilead Sciences, Inc., F. Hoffmann-La Roche AG, Merck Sharp &amp; Dohme, Inc., AstraZeneca plc.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
