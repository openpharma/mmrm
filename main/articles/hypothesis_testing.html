<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Details of Hypothesis Testing • mmrm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Details of Hypothesis Testing">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Package Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/methodological_introduction.html">Mixed Models for Repeated Measures</a></li>
    <li><a class="dropdown-item" href="../articles/mmrm_review_methods.html">Comparison with other software</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Covariance Structures</h6></li>
    <li><a class="dropdown-item" href="../articles/covariance.html">Covariance Structures</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Degrees of Freedom and Testing</h6></li>
    <li><a class="dropdown-item" href="../articles/hypothesis_testing.html">Details of Hypothesis Testing</a></li>
    <li><a class="dropdown-item" href="../articles/between_within.html">Between-Within</a></li>
    <li><a class="dropdown-item" href="../articles/kenward.html">Kenward-Roger</a></li>
    <li><a class="dropdown-item" href="../articles/satterthwaite.html">Satterthwaite</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Coefficient Covariance</h6></li>
    <li><a class="dropdown-item" href="../articles/coef_vcov.html">Coefficients Covariance Matrix Adjustment</a></li>
    <li><a class="dropdown-item" href="../articles/empirical_wls.html">Details of Weighted Least Square Empirical Covariance</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Algorithm Details</h6></li>
    <li><a class="dropdown-item" href="../articles/algorithm.html">Model Fitting Algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/predict.html">Prediction and Simulation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developers</h6></li>
    <li><a class="dropdown-item" href="../articles/package_structure.html">Package Structure</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
<!-- start dropdown for versions --> <li class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle"
          data-bs-toggle="dropdown" role="button"
          aria-expanded="false" aria-haspopup="true"
          id="dropdown-versions">Versions</a> <div class="dropdown-menu" aria-labelledby="dropdown-versions"> <a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.14">v0.3.14</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.13">v0.3.13</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.12">v0.3.12</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.11">v0.3.11</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.10">v0.3.10</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.7">v0.3.7</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.6">v0.3.6</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.5">v0.3.5</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.4">v0.3.4</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.3">v0.3.3</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.2">v0.3.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.1">v0.3.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.0">v0.3.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.2.2">v0.2.2</a> </div></li>
<!-- end dropdown for versions -->
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reports" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reports</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reports">
<li><a class="dropdown-item" href="../coverage-report/">Coverage report</a></li>
    <li><a class="dropdown-item" href="../unit-test-report/">Unit test report</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/mmrm"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Details of Hypothesis Testing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/mmrm/blob/main/vignettes/hypothesis_testing.Rmd" class="external-link"><code>vignettes/hypothesis_testing.Rmd</code></a></small>
      <div class="d-none name"><code>hypothesis_testing.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction-to-type-iiiiii-hypothesis-testing">Introduction to Type I/II/III Hypothesis Testing<a class="anchor" aria-label="anchor" href="#introduction-to-type-iiiiii-hypothesis-testing"></a>
</h2>
<p>Type I/II/III hypothesis testing originates from analysis of
variance, however, <span class="citation">Goodnight (1980)</span>
suggests viewing this issue as hypothesis testing of fixed effects in
linear models, which avoid the “usual assumptions” and defined three
types of estimable functions. Given that type I estimable functions are
dependent on the specific order of used covariates, we focus on the type
II and III testing here.</p>
<p>For MMRM, obtaining estimable functions is equivalent to obtaining
the contrasts for linear hypothesis tests. For more details, see <span class="citation">Goodnight (1980)</span>.</p>
</div>
<div class="section level2">
<h2 id="contained-effect">Contained Effect<a class="anchor" aria-label="anchor" href="#contained-effect"></a>
</h2>
<p>Before we discuss the testing, it is important that we understand the
concept of “contained effect”. The definition of “contained effect”
is:</p>
<p>For effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>2</mn></msub><annotation encoding="application/x-tex">E_2</annotation></semantics></math>,
it is said to contain
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>1</mn></msub><annotation encoding="application/x-tex">E_1</annotation></semantics></math>
if</p>
<ol style="list-style-type: decimal">
<li>the involved numerical covariate(s) are identical for these two
effects</li>
<li>all the categorical covariate(s) associated with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>1</mn></msub><annotation encoding="application/x-tex">E_1</annotation></semantics></math>
are also associated with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>2</mn></msub><annotation encoding="application/x-tex">E_2</annotation></semantics></math>
</li>
</ol>
<p>For example, for the following model formula</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo>+</mo><mi>A</mi><mo>*</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">Y = A + B + A*B</annotation></semantics></math></p>
<p>using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>A</mi></msub><annotation encoding="application/x-tex">E_A</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>B</mi></msub><annotation encoding="application/x-tex">E_B</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>A</mi><mo>*</mo><mi>B</mi></mrow></msub><annotation encoding="application/x-tex">E_{A*B}</annotation></semantics></math>
to denote the effect for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>*</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A*B</annotation></semantics></math>
respectively, we have</p>
<ol style="list-style-type: decimal">
<li>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
are both categorical, then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>A</mi><mo>*</mo><mi>B</mi></mrow></msub><annotation encoding="application/x-tex">E_{A*B}</annotation></semantics></math>
contains
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>A</mi></msub><annotation encoding="application/x-tex">E_{A}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>B</mi></msub><annotation encoding="application/x-tex">E_{B}</annotation></semantics></math>.</li>
<li>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
are both numerical, then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>A</mi><mo>*</mo><mi>B</mi></mrow></msub><annotation encoding="application/x-tex">E_{A*B}</annotation></semantics></math>
do not contain
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>A</mi></msub><annotation encoding="application/x-tex">E_{A}</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>B</mi></msub><annotation encoding="application/x-tex">E_{B}</annotation></semantics></math>.</li>
<li>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
is categorical and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
is numerical, then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>A</mi><mo>*</mo><mi>B</mi></mrow></msub><annotation encoding="application/x-tex">E_{A*B}</annotation></semantics></math>
contains
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>B</mi></msub><annotation encoding="application/x-tex">E_{B}</annotation></semantics></math>
but not
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>A</mi></msub><annotation encoding="application/x-tex">E_{A}</annotation></semantics></math>.</li>
</ol>
</div>
<div class="section level2">
<h2 id="type-ii-hypothesis-testing">Type II Hypothesis Testing<a class="anchor" aria-label="anchor" href="#type-ii-hypothesis-testing"></a>
</h2>
<p>For type II hypothesis testing, the contrasts can be obtained through
the following steps:</p>
<p>Create a contrast matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>,
with rows equal to the number of parameters associated with the effect,
columns equal to the number of all parameters.</p>
<ol style="list-style-type: decimal">
<li>All columns of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
associated with effect not containing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>1</mn></msub><annotation encoding="application/x-tex">E_1</annotation></semantics></math>
(except
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>1</mn></msub><annotation encoding="application/x-tex">E_1</annotation></semantics></math>)
are set to 0.</li>
<li>The submatrix of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
associated with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>1</mn></msub><annotation encoding="application/x-tex">E_1</annotation></semantics></math>
is set to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>X</mi><mn>1</mn><mi>⊤</mi></msubsup><mi>M</mi><msub><mi>X</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo></msup><msubsup><mi>X</mi><mn>1</mn><mi>⊤</mi></msubsup><mi>M</mi><msub><mi>X</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">(X_1^\top M X_1)^{-}X_1^\top M X_1</annotation></semantics></math>
</li>
<li>Each of the remaining submatrices of L associated with an effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>2</mn></msub><annotation encoding="application/x-tex">E_2</annotation></semantics></math>
that contains
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>1</mn></msub><annotation encoding="application/x-tex">E_1</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>X</mi><mn>1</mn><mi>⊤</mi></msubsup><mi>M</mi><msub><mi>X</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo></msup><msubsup><mi>X</mi><mn>1</mn><mi>⊤</mi></msubsup><mi>M</mi><msub><mi>X</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">(X_1^\top M X_1)^{-}X_1^\top M X_2</annotation></semantics></math>
</li>
</ol>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>0</mn></msub><annotation encoding="application/x-tex">X_0</annotation></semantics></math>
stands for columns of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
whose associated effect do not contain
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>1</mn></msub><annotation encoding="application/x-tex">E_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>
stands for columns of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
associated with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>1</mn></msub><annotation encoding="application/x-tex">E_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math>
stands for columns of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
whose associated effect contains
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>1</mn></msub><annotation encoding="application/x-tex">E_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mi>I</mi><mo>−</mo><msub><mi>X</mi><mn>0</mn></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>X</mi><mn>0</mn><mi>⊤</mi></msubsup><msub><mi>X</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo></msup><msubsup><mi>X</mi><mn>0</mn><mi>⊤</mi></msubsup></mrow><annotation encoding="application/x-tex">M = I - X_0(X_0^\top X_0)^{-}X_0^\top</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Z</mi><mo>−</mo></msup><annotation encoding="application/x-tex">Z^{-}</annotation></semantics></math>
stands for the <a href="https://blogs.sas.com/content/iml/2018/11/21/generalized-inverses-for-matrices.html" class="external-link">g2
inverse</a> of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>.</p>
<p>Note: Here we do not allow for singularity in general, so the g2
inverse is just the usual inverse. Thus we can use an identity matrix as
the submatrix in step 2.</p>
<p>Using <code>fev_data</code> to create our example, we have</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://openpharma.github.io/mmrm/">mmrm</a></span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span><span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">+</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">RACE</span> <span class="op">+</span> <span class="fu">ar1</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">fev_data</span><span class="op">)</span></span></code></pre></div>
<p>For this given example, we would like to test the effect of
<code>RACE</code>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mrow></msub><annotation encoding="application/x-tex">E_{RACE}</annotation></semantics></math>.
We initialize the contrast matrix with</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>μ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{matrix} 
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp; ARMCD:RACE\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\ 
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\ 
\end{matrix}
</annotation></semantics></math></p>
<p>Please note that this is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">2\times 6</annotation></semantics></math>
matrix, the rows is the number of coefficients that is associated with
<code>RACE</code>, and the columns is the total number of coefficients
6.</p>
<p>Then following step 2, we filled in the identity matrix in the
corresponding submatrix</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>μ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{matrix} 
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp; ARMCD:RACE\\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\ 
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\ 
\end{matrix}
</annotation></semantics></math></p>
<p>In the last step, for the last 2 columns, we fill the values with the
calculated result.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/component.html">component</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"x_matrix"</span><span class="op">)</span></span>
<span><span class="va">x0</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">x0</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">x0</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span> <span class="co"># solve is used because the matrix is inversible</span></span>
<span><span class="va">sub_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">m</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">x1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">m</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">x2</span></span>
<span><span class="va">sub_mat</span></span></code></pre></div>
<pre><code><span><span class="co">##                               ARMCDTRT:RACEBlack or African American</span></span>
<span><span class="co">## RACEBlack or African American                             0.42618692</span></span>
<span><span class="co">## RACEWhite                                                -0.04372702</span></span>
<span><span class="co">##                               ARMCDTRT:RACEWhite</span></span>
<span><span class="co">## RACEBlack or African American         0.02751985</span></span>
<span><span class="co">## RACEWhite                             0.58570969</span></span></code></pre>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>μ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.42618692</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.02751985</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>0.04372702</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.58570969</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{matrix} 
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp; ARMCD:RACE\\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0.42618692 &amp; 0.02751985\\ 
0 &amp; 0 &amp; 0 &amp; 1 &amp; -0.04372702 &amp; 0.58570969\\ 
\end{matrix}
</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="type-iii-hypothesis-testing">Type III Hypothesis Testing<a class="anchor" aria-label="anchor" href="#type-iii-hypothesis-testing"></a>
</h2>
<p>For type III hypothesis testing, we assume that the hypothesis tested
should be the same for all designs with the same general form of
estimable functions. It can be defined with the following steps:</p>
<p>Create a contrast matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>,
with rows equal to the number of parameters associated with the effect,
columns equal to the number of all parameters.</p>
<ol style="list-style-type: decimal">
<li>All columns of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
associated with effect not containing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>1</mn></msub><annotation encoding="application/x-tex">E_1</annotation></semantics></math>
(except
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>1</mn></msub><annotation encoding="application/x-tex">E_1</annotation></semantics></math>)
are set to 0.</li>
<li>The submatrix of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
associated with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>1</mn></msub><annotation encoding="application/x-tex">E_1</annotation></semantics></math>
is set to identity matrix.</li>
<li>For each of the remaining submatrices of L associated with an effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>2</mn></msub><annotation encoding="application/x-tex">E_2</annotation></semantics></math>
that contains
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mn>1</mn></msub><annotation encoding="application/x-tex">E_1</annotation></semantics></math>,
equate the values.</li>
</ol>
<p>Here equate the values means that, given that the coefficients in
step 2 are all 1 (diagonal), in step 3 this 1 is divided by the total
number of new levels.</p>
<p>Using the same example for type II testing, we also would like to
test the effect of <code>RACE</code>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mrow></msub><annotation encoding="application/x-tex">E_{RACE}</annotation></semantics></math>.
We initialize the contrast matrix with</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>μ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{matrix} 
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp; ARMCD:RACE\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\ 
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\ 
\end{matrix}
</annotation></semantics></math></p>
<p>Then following step 2, we filled in the identity matrix in the
corresponding submatrix</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>μ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{matrix} 
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp; ARMCD:RACE\\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\ 
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\ 
\end{matrix}
</annotation></semantics></math></p>
<p>In the last step, for the last 2 columns, we fill the values to
equate the coefficients in the sub matrix. We use the coefficients for
<code>RACE</code>, and divide it by the additional levels (there is
interaction between <code>ARMCD</code> and <code>RACE</code>, the
additional covariate <code>ARMCD</code> has 2 levels) and we get 0.5 for
the coefficients.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>μ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.5</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.5</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{matrix} 
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp; ARMCD:RACE\\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0.5 &amp; 0\\ 
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0.5\\ 
\end{matrix}
</annotation></semantics></math></p>
<p>Similarly, if we are testing the effect of <code>ARMCD</code> we will
have the following contrast because <code>RACE</code> has 3 levels.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>μ</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>A</mi><mi>R</mi><mi>M</mi><mi>C</mi><mi>D</mi><mo>:</mo><mi>R</mi><mi>A</mi><mi>C</mi><mi>E</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mfrac><mn>1</mn><mn>3</mn></mfrac></mtd><mtd columnalign="center" style="text-align: center"><mfrac><mn>1</mn><mn>3</mn></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{matrix} 
\mu &amp; ARMCD &amp; RACE &amp; RACE &amp; ARMCD:RACE &amp; ARMCD:RACE\\
0 &amp; 1 &amp; 0 &amp; 0 &amp; \frac{1}{3} &amp; \frac{1}{3}\\ 
\end{matrix}
</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="hypothesis-testing-in-sas">Hypothesis Testing in SAS<a class="anchor" aria-label="anchor" href="#hypothesis-testing-in-sas"></a>
</h2>
<p>In <code>PROC MIXED</code> we can specify <code>HTYPE=1,2,3</code> to
enable these hypothesis testings, and we can use option
<code>e1 e2 e3</code> to view the estimable functions.</p>
<div class="section level3">
<h3 id="special-considerations">Special Considerations<a class="anchor" aria-label="anchor" href="#special-considerations"></a>
</h3>
<div class="section level4">
<h4 id="reference-levels">Reference Levels<a class="anchor" aria-label="anchor" href="#reference-levels"></a>
</h4>
<p>For <code>PROC MIXED</code>, it is important that the categorical
values have the correct order, especially for structured covariance
(otherwise the correlation between visits can be messed up). We usually
use <code>CLASS variable(REF=)</code> to define the reference level.
However, SAS will put the reference level in the last, so if the visit
variable is included in fixed effect, there can be issues with the
comparison between SAS and R, as in R we still use the first level as
our reference.</p>
<p>When we conduct the hypothesis testing, we will also face this issue.
If reference level is different, the testing we have can be different,
e.g. if we have 3 levels,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>l</mi><mn>1</mn></msub><annotation encoding="application/x-tex">l_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>l</mi><mn>2</mn></msub><annotation encoding="application/x-tex">l_2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>l</mi><mn>3</mn></msub><annotation encoding="application/x-tex">l_3</annotation></semantics></math>.
In theory we can test either
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mn>2</mn></msub><mo>−</mo><msub><mi>l</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">l_2 - l_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mn>3</mn></msub><mo>−</mo><msub><mi>l</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">l_3 - l_1</annotation></semantics></math>
(using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>l</mi><mn>1</mn></msub><annotation encoding="application/x-tex">l_1</annotation></semantics></math>
as reference), or test
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mn>1</mn></msub><mo>−</mo><msub><mi>l</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">l_1 - l_3</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mn>2</mn></msub><mo>−</mo><msub><mi>l</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">l_2 - l_3</annotation></semantics></math>
(using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>l</mi><mn>3</mn></msub><annotation encoding="application/x-tex">l_3</annotation></semantics></math>
as reference). But the result will be slightly different. However, if we
have identical tests the result will be closer. The following example
illustrate this.</p>
<div class="section level5">
<h5 id="example-of-reference-levels">Example of Reference Levels<a class="anchor" aria-label="anchor" href="#example-of-reference-levels"></a>
</h5>
<p>Assume in SAS we have the following model</p>
<pre><code>PROC MIXED DATA = fev cl method=reml;
  CLASS AVISIT(ref = 'VIS4') ARMCD(ref = 'PBO') USUBJID;
  MODEL FEV1 = ARMCD AVISIT ARMCD*AVISIT / ddfm=satterthwaite htype=3;
  REPEATED AVISIT / subject=USUBJID type=ar(1);
RUN;</code></pre>
<p>And in R we have the following model</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span><span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">+</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">ar1</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">fev_data</span><span class="op">)</span></span>
<span><span class="fu">Anova</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p>Note that for <code>AVISIT</code> there are 4 levels,
<code>VIS1</code>, <code>VIS2</code>, <code>VIS3</code> and
<code>VIS4</code>. In SAS <code>VIS4</code> is the reference, while in R
<code>VIS1</code> is the reference.</p>
<p>They both use the following matrix to test the effect of
<code>AVISIT</code> (ignoring other part of contrasts that is not
associated with <code>AVISIT</code>)</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{matrix} 
1 &amp; 0 &amp; 0\\ 
0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 1\\
\end{matrix}
</annotation></semantics></math></p>
<p>But given that the reference level is different, we are testing
different things. In SAS we are testing <code>VIS1 - VIS4</code>,
<code>VIS2 - VIS4</code> and <code>VIS3 - VIS4</code>, while in R we are
testing <code>VIS2 - VIS1</code>, <code>VIS3 - VIS1</code> and
<code>VIS4 - VIS1</code>.</p>
<p>To correctly test <code>VIS1 - VIS4</code>, <code>VIS2 - VIS4</code>
and <code>VIS3 - VIS4</code> in R, we need to update the contrast to the
following matrix (ignoring the other part) to get a closer result.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>−</mi><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{matrix} 
0 &amp; 1 &amp; 0\\ 
0 &amp; 0 &amp; 1\\
-1 &amp; -1 &amp; -1\\
\end{matrix}
</annotation></semantics></math></p>
</div>
</div>
<div class="section level4">
<h4 id="why-model-covariate-order-changes-my-testing-in-sas">Why Model Covariate Order Changes My Testing in SAS?<a class="anchor" aria-label="anchor" href="#why-model-covariate-order-changes-my-testing-in-sas"></a>
</h4>
<p>For type II/III testing, it is true that the order of covariate
should not affect the result. However, if there is an interaction term,
the reference level can be changed. With different reference levels the
result will be slightly different.</p>
</div>
<div class="section level4">
<h4 id="why-mmrm-gives-more-covariates-than-sas">Why <code>mmrm</code> Gives More Covariates Than SAS?<a class="anchor" aria-label="anchor" href="#why-mmrm-gives-more-covariates-than-sas"></a>
</h4>
<p>For <code>PROC MIXED</code>, if a model is specified as follows</p>
<pre><code>MODEL FEV1 = ARMCD SEX ARMCD * SEX ARMCD * FEV1_BL</code></pre>
<p>Then it is equivalent to the following <code>mmrm</code> model</p>
<pre><code><span><span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">FEV1_BL</span> <span class="op">-</span> <span class="va">FEV1_BL</span></span></code></pre>
<p>or</p>
<pre><code><span><span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">ARMCD</span><span class="op">:</span><span class="va">FEV1_BL</span></span></code></pre>
<p>Because SAS will not include the covariate <code>FEV1_BL</code> by
default, unless manually added. However in R we will add
<code>FEV1_BL</code> by default. Please note that in this example we
exclude the covariance structure part.</p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-goodnight1980tests" class="csl-entry">
Goodnight JH (1980). <span>“Tests of Hypotheses in Fixed Effects Linear
Models.”</span> <em>Communications in Statistics-Theory and
Methods</em>, <strong>9</strong>(2), 167–180.
</div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Sabanes Bove, Liming Li, Julia Dedic, Doug Kelkhoff, Kevin Kunzmann, Brian Matthew Lang, Christian Stock, Ya Wang, Dan James, Jonathan Sidi, Daniel Leibovitz, Daniel D. Sjoberg, Boehringer Ingelheim Ltd., Gilead Sciences, Inc., F. Hoffmann-La Roche AG, Merck Sharp &amp; Dohme, Inc., AstraZeneca plc, inferential.biostatistics GmbH.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
