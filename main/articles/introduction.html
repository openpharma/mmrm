<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mmrm">
<title>Introduction to `mmrm` • mmrm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to `mmrm`">
<meta property="og:description" content="mmrm">
<meta property="og:image" content="https://openpharma.github.io/mmrm/main/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2.9006</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/algorithm.html">Details of the Model Fitting in `mmrm`</a>
    <a class="dropdown-item" href="../articles/coef_vcov.html">Coefficients Covariance Matrix Adjustment in `mmrm`</a>
    <a class="dropdown-item" href="../articles/covariance.html">Covariance Structures in `mmrm`</a>
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to `mmrm`</a>
    <a class="dropdown-item" href="../articles/kenward.html">Details of the Kenward-Roger calculations</a>
    <a class="dropdown-item" href="../articles/methodological_introduction.html">What are MMRMs? A brief introduction</a>
    <a class="dropdown-item" href="../articles/package_structure.html">Package Structure</a>
    <a class="dropdown-item" href="../articles/satterthwaite.html">Details of the Satterthwaite calculations</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/openpharma/mmrm">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Introduction to `mmrm`</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/mmrm/blob/HEAD/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="common-usage">Common usage<a class="anchor" aria-label="anchor" href="#common-usage"></a>
</h2>
<p>A minimal call of <a href="https://openpharma.github.io/mmrm/main/reference/mmrm.html"><code>mmrm()</code></a>,
consisting of only formula and data arguments will produce an object of
class <code>mmrm</code>, <code>mmrm_fit</code>, and
<code>mmrm_tmb</code>. Here we fit a mmrm model with <code>us</code>
(unstructured) covariance structure specified, as well as the defaults
of <code>reml = TRUE</code> and
<code>control = mmrm_control()</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Printing the object will show you output which should be familiar to
anyone who has used any popular modeling functions such as
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">stats::lm()</a></code>, <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code>,
<code><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html" class="external-link">glmmTMB::glmmTMB()</a></code>, and <code><a href="https://rdrr.io/pkg/lme4/man/nlmer.html" class="external-link">lme4::nlmer()</a></code>. From
this print out we see the function call, the data used, the covariance
structure with number of variance parameters, as well as the likelihood
method, and model deviance achieved. Additionally the user is provided a
printout of the estimated coefficients and the model convergence
information.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    3387.373</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                   30.96769899                    1.50464863 </span></span>
<span><span class="co">#&gt;                     RACEWhite                      ARMCDTRT </span></span>
<span><span class="co">#&gt;                    5.61309565                    3.77555734 </span></span>
<span><span class="co">#&gt;                    AVISITVIS2                    AVISITVIS3 </span></span>
<span><span class="co">#&gt;                    4.82858803                   10.33317002 </span></span>
<span><span class="co">#&gt;                    AVISITVIS4           ARMCDTRT:AVISITVIS2 </span></span>
<span><span class="co">#&gt;                   15.05255715                   -0.01737409 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS3           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                   -0.66753189                    0.63094392 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="common-customizations">Common customizations<a class="anchor" aria-label="anchor" href="#common-customizations"></a>
</h2>
<p>From the high-level <a href="https://openpharma.github.io/mmrm/main/reference/mmrm.html"><code>mmrm()</code></a>
interface, common changes to the default function call can be
specified.</p>
<div class="section level3">
<h3 id="control-function">Control Function<a class="anchor" aria-label="anchor" href="#control-function"></a>
</h3>
<p>For fine control, <a href="https://openpharma.github.io/mmrm/main/reference/mmrm_control.html"><code>mmrm_control()</code></a>
is provided. This function allows the user to choose the adjustment
method for the degrees of freedom and the coefficients covariance
matrix, specify optimization routines, number of cores to be used on
Unix systems for trying several optimizers in parallel, provide a vector
of starting parameter values, decide the action to be taken when the
defined design matrix is singular, not drop unobserved visit levels. For
example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mmrm_control.html">mmrm_control</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"Kenward-Roger"</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L-BFGS-B"</span>, <span class="st">"BFGS"</span><span class="op">)</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  accept_singular <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop_visit_levels <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note that this control list can either be passed via the
<code>control</code> argument to <code>mmrm</code>, or selected controls
can be directly specified in the <code>mmrm</code> call. We will see
this below.</p>
</div>
<div class="section level3">
<h3 id="reml-or-ml">REML or ML<a class="anchor" aria-label="anchor" href="#reml-or-ml"></a>
</h3>
<p>Users can specify if REML should be used (default) or if ML should be
used in optimization.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  reml <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_ml</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   ML</span></span>
<span><span class="co">#&gt; Deviance:    3397.934</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                    30.9663423                     1.5086851 </span></span>
<span><span class="co">#&gt;                     RACEWhite                      ARMCDTRT </span></span>
<span><span class="co">#&gt;                     5.6133151                     3.7761037 </span></span>
<span><span class="co">#&gt;                    AVISITVIS2                    AVISITVIS3 </span></span>
<span><span class="co">#&gt;                     4.8270155                    10.3353319 </span></span>
<span><span class="co">#&gt;                    AVISITVIS4           ARMCDTRT:AVISITVIS2 </span></span>
<span><span class="co">#&gt;                    15.0487715                    -0.0156154 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS3           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                    -0.6663598                     0.6317222 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="optimizer">Optimizer<a class="anchor" aria-label="anchor" href="#optimizer"></a>
</h3>
<p>Users can specify which optimizer should be used, changing from the
default of four optimizers, which starts with <code>L-BFGS-B</code> and
proceeds through the other choices if optimization fails to converge.
Other choices are <code>BFGS</code>, <code>CG</code>, and
<code>nlminb</code>.</p>
<p><code>L-BFGS-B</code>, <code>BFGS</code> and <code>CG</code> are all
implemented with <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim()</a></code> and the Hessian is not
used, while <code>nlminb</code> is using <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb()</a></code>
which in turn uses both the gradient and the Hessian (by default but can
be switch off) for the optimization.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="st">"BFGS"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_opt</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    3387.373</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                   30.96769004                    1.50467449 </span></span>
<span><span class="co">#&gt;                     RACEWhite                      ARMCDTRT </span></span>
<span><span class="co">#&gt;                    5.61310489                    3.77554263 </span></span>
<span><span class="co">#&gt;                    AVISITVIS2                    AVISITVIS3 </span></span>
<span><span class="co">#&gt;                    4.82858562                   10.33317692 </span></span>
<span><span class="co">#&gt;                    AVISITVIS4           ARMCDTRT:AVISITVIS2 </span></span>
<span><span class="co">#&gt;                   15.05257072                   -0.01735093 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS3           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                   -0.66751927                    0.63095827 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message:</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="covariance-structure">Covariance Structure<a class="anchor" aria-label="anchor" href="#covariance-structure"></a>
</h3>
<p>Covariance structures supported by the <code>mmrm</code> are being
continuously developed. For a complete list and description please visit
the <a href="covariance.html">covariance vignette</a>. Below we see the
function call for homogeneous compound symmetry (<code>cs</code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">cs</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  reml <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_cs</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + cs(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  compound symmetry (2 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   ML</span></span>
<span><span class="co">#&gt; Deviance:    3536.989</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                    31.4207077                     0.5357237 </span></span>
<span><span class="co">#&gt;                     RACEWhite                      ARMCDTRT </span></span>
<span><span class="co">#&gt;                     5.4546329                     3.4305212 </span></span>
<span><span class="co">#&gt;                    AVISITVIS2                    AVISITVIS3 </span></span>
<span><span class="co">#&gt;                     4.8326353                    10.2395076 </span></span>
<span><span class="co">#&gt;                    AVISITVIS4           ARMCDTRT:AVISITVIS2 </span></span>
<span><span class="co">#&gt;                    15.0672680                     0.2801641 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS3           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                    -0.5894964                     0.7939750 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
<p>The time points have to be unique for each subject. That is, there
cannot be time points with multiple observations for any subject. The
rationale is that these observations would need to be correlated, but it
is not possible within the currently implemented covariance structure
framework to do that correctly.</p>
</div>
<div class="section level3">
<h3 id="weighting">Weighting<a class="anchor" aria-label="anchor" href="#weighting"></a>
</h3>
<p>Users can perform weighted MMRM by specifying a numeric vector
<code>weights</code> with positive values.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  weights <span class="op">=</span> <span class="va">fev_data</span><span class="op">$</span><span class="va">WEIGHT</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_wt</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Weights:     fev_data$WEIGHT</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    3476.526</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                   31.20065229                    1.18452837 </span></span>
<span><span class="co">#&gt;                     RACEWhite                      ARMCDTRT </span></span>
<span><span class="co">#&gt;                    5.36525917                    3.39695951 </span></span>
<span><span class="co">#&gt;                    AVISITVIS2                    AVISITVIS3 </span></span>
<span><span class="co">#&gt;                    4.85890820                   10.03942420 </span></span>
<span><span class="co">#&gt;                    AVISITVIS4           ARMCDTRT:AVISITVIS2 </span></span>
<span><span class="co">#&gt;                   14.79354054                    0.03418184 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS3           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                    0.01308088                    0.86701567 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="grouped-covariance-structure">Grouped Covariance Structure<a class="anchor" aria-label="anchor" href="#grouped-covariance-structure"></a>
</h3>
<p>Grouped covariance structures are supported by the<code>mmrm</code>
package. Covariance matrices for each group are identically structured
(unstructured, compound symmetry, etc) but the estimates are allowed to
vary across groups. We use the form
<code>cs(time | group / subject)</code> to specify the group
variable.</p>
<p>Here is an example of how we use <code>ARMCD</code> as group
variable.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">cs</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">ARMCD</span> <span class="op">/</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  reml <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/mmrm_tmb_methods.html">VarCorr</a></span><span class="op">(</span><span class="va">fit_cs</span><span class="op">)</span></span>
<span><span class="co">#&gt; $PBO</span></span>
<span><span class="co">#&gt;           VIS1      VIS2      VIS3      VIS4</span></span>
<span><span class="co">#&gt; VIS1 37.823638  3.601296  3.601296  3.601296</span></span>
<span><span class="co">#&gt; VIS2  3.601296 37.823638  3.601296  3.601296</span></span>
<span><span class="co">#&gt; VIS3  3.601296  3.601296 37.823638  3.601296</span></span>
<span><span class="co">#&gt; VIS4  3.601296  3.601296  3.601296 37.823638</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TRT</span></span>
<span><span class="co">#&gt;          VIS1     VIS2     VIS3     VIS4</span></span>
<span><span class="co">#&gt; VIS1 49.58110 10.98112 10.98112 10.98112</span></span>
<span><span class="co">#&gt; VIS2 10.98112 49.58110 10.98112 10.98112</span></span>
<span><span class="co">#&gt; VIS3 10.98112 10.98112 49.58110 10.98112</span></span>
<span><span class="co">#&gt; VIS4 10.98112 10.98112 10.98112 49.58110</span></span></code></pre></div>
<p>We can see that the estimated covariance matrices are different in
different <code>ARMCD</code> groups.</p>
</div>
<div class="section level3">
<h3 id="adjustment-method">Adjustment Method<a class="anchor" aria-label="anchor" href="#adjustment-method"></a>
</h3>
<p>In additional to the residual degrees of freedom, both Satterthwaite
and Kenward-Roger adjustment methods are available. The default is
Satterthwaite adjustment of the degrees of freedom. To use Kenward-Roger
adjustment of the degrees of freedom as well as the coefficients
covariance matrix, use the <code>method</code> argument:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_kr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Kenward-Roger"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note that this requires <code>reml = TRUE</code>, i.e. Kenward-Roger
adjustment is not possible when using maximum likelihood inference.
While this adjustment choice is not visible in the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>
result of the fitted model (because the initial model fit is not
affected by the choice of the adjustment method), looking at the
<code>summary</code> we see the method and the correspondingly adjusted
standard errors and degrees of freedom:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_kr</span><span class="op">)</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Method:      Kenward-Roger</span></span>
<span><span class="co">#&gt; Vcov Method: Kenward-Roger</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model selection criteria:</span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance </span></span>
<span><span class="co">#&gt;   3407.4   3440.2  -1693.7   3387.4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                                Estimate Std. Error        df t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)                    30.96770    0.83335 187.91000  37.160  &lt; 2e-16</span></span>
<span><span class="co">#&gt; RACEBlack or African American   1.50465    0.62901 169.95000   2.392  0.01784</span></span>
<span><span class="co">#&gt; RACEWhite                       5.61310    0.67139 158.87000   8.360 2.98e-14</span></span>
<span><span class="co">#&gt; ARMCDTRT                        3.77556    1.07910 146.27000   3.499  0.00062</span></span>
<span><span class="co">#&gt; AVISITVIS2                      4.82859    0.80408 143.66000   6.005 1.49e-08</span></span>
<span><span class="co">#&gt; AVISITVIS3                     10.33317    0.82303 155.66000  12.555  &lt; 2e-16</span></span>
<span><span class="co">#&gt; AVISITVIS4                     15.05256    1.30180 138.39000  11.563  &lt; 2e-16</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS2            -0.01737    1.13154 138.39000   0.015  0.98777</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS3            -0.66753    1.18714 158.21000   0.562  0.57470</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS4             0.63094    1.83319 129.64000   0.344  0.73127</span></span>
<span><span class="co">#&gt;                                  </span></span>
<span><span class="co">#&gt; (Intercept)                   ***</span></span>
<span><span class="co">#&gt; RACEBlack or African American *  </span></span>
<span><span class="co">#&gt; RACEWhite                     ***</span></span>
<span><span class="co">#&gt; ARMCDTRT                      ***</span></span>
<span><span class="co">#&gt; AVISITVIS2                    ***</span></span>
<span><span class="co">#&gt; AVISITVIS3                    ***</span></span>
<span><span class="co">#&gt; AVISITVIS4                    ***</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS2              </span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS3              </span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS4              </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariance estimate:</span></span>
<span><span class="co">#&gt;         VIS1    VIS2    VIS3    VIS4</span></span>
<span><span class="co">#&gt; VIS1 40.7335 14.2740  5.1411 13.5288</span></span>
<span><span class="co">#&gt; VIS2 14.2740 26.2243  2.6391  7.3219</span></span>
<span><span class="co">#&gt; VIS3  5.1411  2.6391 14.9497  1.0341</span></span>
<span><span class="co">#&gt; VIS4 13.5288  7.3219  1.0341 95.6006</span></span></code></pre></div>
<p>For one-dimensional contrasts as in the coefficients table above, the
degrees of freedom are the same for Kenward-Roger and Satterthwaite.
However, Kenward-Roger uses adjusted standard errors, hence the p-values
are different.</p>
<p>Note that if you would like to match SAS results for an unstructured
covariance model, you can use the linear Kenward-Roger
approximation:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_kr_lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Kenward-Roger"</span>,</span>
<span>  vcov <span class="op">=</span> <span class="st">"Kenward-Roger-Linear"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This is due to the different parametrization of the unstructured
covariance matrix, see the <a href="kenward.html#parameterization-methods-and-kenward-roger">Kenward-Roger
vignette</a> for details.</p>
</div>
<div class="section level3">
<h3 id="variance-covariance-for-coefficients">Variance-covariance for Coefficients<a class="anchor" aria-label="anchor" href="#variance-covariance-for-coefficients"></a>
</h3>
<p>There are multiple variance-covariance estimator available for the
coefficients, including:</p>
<ol style="list-style-type: decimal">
<li>Asymptotic</li>
<li>Empirical (Cluster Robust Sandwich)</li>
<li>Empirical-Jackknife</li>
<li>Kenward-Roger</li>
<li>Kenward-Roger-Linear</li>
</ol>
<p>Please note that, not all combinations of variance-covariance for
coefficients and method of degrees of freedom are possible,
e.g. “Kenward-Roger” and “Kenward-Roger-Linear” are available only when
the degrees of freedom method is “Kenward-Roger”, while “Empirical” and
“Empirical-Jackknife” only works for “Residual” degrees of freedom
currently.</p>
<p>Details can be found in <a href="coef_vcov.html">Coefficients
Covariance Matrix Adjustment vignette</a>.</p>
</div>
<div class="section level3">
<h3 id="keeping-unobserved-visits">Keeping Unobserved Visits<a class="anchor" aria-label="anchor" href="#keeping-unobserved-visits"></a>
</h3>
<p>Sometimes not all possible time points are observed in a given data
set. When using a structured covariance matrix, e.g. with
auto-regressive structure, then it can be relevant to keep the correct
distance between the observed time points.</p>
<p>Consider the following example where we have deliberately removed the
<code>VIS3</code> observations from our initial example data set
<code>fev_data</code> to obtain <code>sparse_data</code>. We first fit
the model where we do not drop the visit level explicitly, using the
<code>drop_visit_levels = FALSE</code> choice. Second we fit the model
by default without this option.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sparse_data</span> <span class="op">&lt;-</span> <span class="va">fev_data</span><span class="op">[</span><span class="va">fev_data</span><span class="op">$</span><span class="va">AVISIT</span> <span class="op">!=</span> <span class="st">"VIS3"</span>, <span class="op">]</span></span>
<span><span class="va">sparse_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="fu">ar1</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">sparse_data</span>,</span>
<span>  drop_visit_levels <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dropped_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="fu">ar1</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">sparse_data</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; In AVISIT there are dropped visits: VIS3</span></span></code></pre></div>
<p>We see that we get a message about the dropped visit level by
default. Now we can compare the estimated correlation matrices:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="fu"><a href="../reference/mmrm_tmb_methods.html">VarCorr</a></span><span class="op">(</span><span class="va">sparse_result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;            VIS1      VIS2      VIS3       VIS4</span></span>
<span><span class="co">#&gt; VIS1 1.00000000 0.4051834 0.1641736 0.06652042</span></span>
<span><span class="co">#&gt; VIS2 0.40518341 1.0000000 0.4051834 0.16417360</span></span>
<span><span class="co">#&gt; VIS3 0.16417360 0.4051834 1.0000000 0.40518341</span></span>
<span><span class="co">#&gt; VIS4 0.06652042 0.1641736 0.4051834 1.00000000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="fu"><a href="../reference/mmrm_tmb_methods.html">VarCorr</a></span><span class="op">(</span><span class="va">dropped_result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;            VIS1      VIS2       VIS4</span></span>
<span><span class="co">#&gt; VIS1 1.00000000 0.1468464 0.02156386</span></span>
<span><span class="co">#&gt; VIS2 0.14684640 1.0000000 0.14684640</span></span>
<span><span class="co">#&gt; VIS4 0.02156386 0.1468464 1.00000000</span></span></code></pre></div>
<p>We see that when using the default, second result, we just drop the
<code>VIS3</code> from the covariance matrix. As a consequence, we model
the correlation between <code>VIS2</code> and <code>VIS4</code> the same
as the correlation between <code>VIS1</code> and <code>VIS2</code>.
Hence we get a smaller correlation estimate here compared to the first
result, which includes <code>VIS3</code> explicitly.</p>
</div>
</div>
<div class="section level2">
<h2 id="extraction-of-model-features">Extraction of model features<a class="anchor" aria-label="anchor" href="#extraction-of-model-features"></a>
</h2>
<p>Similar to model objects created in other packages, components of
<code>mmrm</code> and <code>mmrm_tmb</code> objects can be accessed with
standard methods. Additionally, <a href="https://openpharma.github.io/mmrm/main/reference/component.html"><code>component()</code></a>
is provided to allow deeper and more precise access for those interested
in digging through model output. Complete documentation of standard
model output methods supported for <code>mmrm_tmb</code> objects <a href="https://openpharma.github.io/mmrm/main/reference/mmrm_tmb_methods.html">can
be found at the package website.</a></p>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>The <code>summary</code> method for <code>mmrm</code> objects
provides easy access to frequently needed model components.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p>From this summary object, you can easily retrieve the coefficients
table.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_summary</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="co">#&gt;                                  Estimate Std. Error       df     t value</span></span>
<span><span class="co">#&gt; (Intercept)                   30.96769899  0.8293349 187.9132 37.34040185</span></span>
<span><span class="co">#&gt; RACEBlack or African American  1.50464863  0.6206596 169.9454  2.42427360</span></span>
<span><span class="co">#&gt; RACEWhite                      5.61309565  0.6630909 158.8700  8.46504747</span></span>
<span><span class="co">#&gt; ARMCDTRT                       3.77555734  1.0762774 146.2690  3.50797778</span></span>
<span><span class="co">#&gt; AVISITVIS2                     4.82858803  0.8017144 143.6593  6.02282805</span></span>
<span><span class="co">#&gt; AVISITVIS3                    10.33317002  0.8224414 155.6572 12.56401918</span></span>
<span><span class="co">#&gt; AVISITVIS4                    15.05255715  1.3128602 138.3916 11.46546844</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS2           -0.01737409  1.1291645 138.3926 -0.01538668</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS3           -0.66753189  1.1865359 158.2106 -0.56258887</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS4            0.63094392  1.8507884 129.6377  0.34090549</span></span>
<span><span class="co">#&gt;                                   Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)                   7.122405e-89</span></span>
<span><span class="co">#&gt; RACEBlack or African American 1.638725e-02</span></span>
<span><span class="co">#&gt; RACEWhite                     1.605553e-14</span></span>
<span><span class="co">#&gt; ARMCDTRT                      6.001485e-04</span></span>
<span><span class="co">#&gt; AVISITVIS2                    1.366921e-08</span></span>
<span><span class="co">#&gt; AVISITVIS3                    1.927523e-25</span></span>
<span><span class="co">#&gt; AVISITVIS4                    8.242710e-22</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS2           9.877459e-01</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS3           5.745112e-01</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS4           7.337266e-01</span></span></code></pre></div>
<p>Other model parameters and metadata available in the summary object
is as follows:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fit_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 15</span></span>
<span><span class="co">#&gt;  $ cov_type        : chr "us"</span></span>
<span><span class="co">#&gt;  $ reml            : logi TRUE</span></span>
<span><span class="co">#&gt;  $ n_groups        : int 1</span></span>
<span><span class="co">#&gt;  $ n_theta         : int 10</span></span>
<span><span class="co">#&gt;  $ n_subjects      : int 197</span></span>
<span><span class="co">#&gt;  $ n_timepoints    : int 4</span></span>
<span><span class="co">#&gt;  $ n_obs           : int 537</span></span>
<span><span class="co">#&gt;  $ beta_vcov       : num [1:10, 1:10] 0.688 -0.207 -0.163 -0.569 -0.422 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:10] "(Intercept)" "RACEBlack or African American" "RACEWhite" "ARMCDTRT" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:10] "(Intercept)" "RACEBlack or African American" "RACEWhite" "ARMCDTRT" ...</span></span>
<span><span class="co">#&gt;  $ varcor          : num [1:4, 1:4] 40.73 14.27 5.14 13.53 14.27 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:4] "VIS1" "VIS2" "VIS3" "VIS4"</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:4] "VIS1" "VIS2" "VIS3" "VIS4"</span></span>
<span><span class="co">#&gt;  $ method          : chr "Satterthwaite"</span></span>
<span><span class="co">#&gt;  $ vcov            : chr "Asymptotic"</span></span>
<span><span class="co">#&gt;  $ coefficients    : num [1:10, 1:5] 30.97 1.5 5.61 3.78 4.83 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:10] "(Intercept)" "RACEBlack or African American" "RACEWhite" "ARMCDTRT" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "Estimate" "Std. Error" "df" "t value" ...</span></span>
<span><span class="co">#&gt;  $ n_singular_coefs: int 0</span></span>
<span><span class="co">#&gt;  $ aic_list        :List of 4</span></span>
<span><span class="co">#&gt;   ..$ AIC     : num 3407</span></span>
<span><span class="co">#&gt;   ..$ BIC     : num 3440</span></span>
<span><span class="co">#&gt;   ..$ logLik  : num -1694</span></span>
<span><span class="co">#&gt;   ..$ deviance: num 3387</span></span>
<span><span class="co">#&gt;  $ call            : language fit_mmrm(formula = FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID),      data = "fev_data", weights = weights| __truncated__ ...</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "summary.mmrm"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="residuals">Residuals<a class="anchor" aria-label="anchor" href="#residuals"></a>
</h3>
<p>The <code>residuals</code> method for <code>mmrm</code> objects can
be used to provide three different types of residuals:</p>
<ol style="list-style-type: decimal">
<li>Response or raw residuals - the difference between the observed and
fitted or predicted value. MMRMs can allow for heteroscedasticity, so
these residuals should be interpreted with caution.</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span>
<span><span class="va">residuals_resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Pearson residuals - the raw residuals scaled by the estimated
standard deviation of the response. This residual type is better suited
to identifying outlying observations and the appropriateness of the
covariance structure, compared to the raw residuals.</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">residuals_pearson</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Normalized or scaled residuals - the raw residuals are
‘de-correlated’ based on the Cholesky decomposition of the
variance-covariance matrix. These residuals should approximately follow
the standard normal distribution, and therefore can be used to check for
normality (<span class="citation">@galecki2013linear</span>).</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">residuals_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"normalized"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-components">Other components<a class="anchor" aria-label="anchor" href="#other-components"></a>
</h3>
<p>Specific model quantities not supported by methods can be retrieved
with the <a href="https://openpharma.github.io/mmrm/main/reference/component.html"><code>component()</code></a>
function. The default will output all supported components.</p>
<p>For example, a user may want information about convergence:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/component.html">component</a></span><span class="op">(</span><span class="va">fit</span>, name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"convergence"</span>, <span class="st">"evaluations"</span>, <span class="st">"conv_message"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $convergence</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $evaluations</span></span>
<span><span class="co">#&gt; function gradient </span></span>
<span><span class="co">#&gt;       17       17 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $conv_message</span></span>
<span><span class="co">#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"</span></span></code></pre></div>
<p>or the original low-level call:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/component.html">component</a></span><span class="op">(</span><span class="va">fit</span>, name <span class="op">=</span> <span class="st">"call"</span><span class="op">)</span></span>
<span><span class="co">#&gt; fit_mmrm(formula = FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | </span></span>
<span><span class="co">#&gt;     USUBJID), data = "fev_data", weights = weights, reml = reml, </span></span>
<span><span class="co">#&gt;     covariance = covariance, control = control)</span></span></code></pre></div>
<p>the user could also ask for all provided components by not specifying
the <code>name</code> argument.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/component.html">component</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="lower-level-functions">Lower level functions<a class="anchor" aria-label="anchor" href="#lower-level-functions"></a>
</h2>
<div class="section level3">
<h3 id="low-level-mmrm">Low-level mmrm<a class="anchor" aria-label="anchor" href="#low-level-mmrm"></a>
</h3>
<p>The lower level function which is called by <a href="https://openpharma.github.io/mmrm/main/reference/mmrm.html"><code>mmrm()</code></a>
is <a href="https://openpharma.github.io/mmrm/main/reference/fit_mmrm.html"><code>fit_mmrm()</code></a>.
This function is exported and can be used directly. It is similar to <a href="https://openpharma.github.io/mmrm/main/reference/mmrm.html"><code>mmrm()</code></a>
but lacks some post-processing and support for Satterthwaite and
Kenward-Roger calculations. It may be useful for other packages that
want to fit the model without the adjustment calculations.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fit_mmrm.html">fit_mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fev_data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  reml <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="../reference/mmrm_control.html">mmrm_control</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    3387.373</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                   (Intercept) RACEBlack or African American </span></span>
<span><span class="co">#&gt;                   30.96769899                    1.50464863 </span></span>
<span><span class="co">#&gt;                     RACEWhite                      ARMCDTRT </span></span>
<span><span class="co">#&gt;                    5.61309565                    3.77555734 </span></span>
<span><span class="co">#&gt;                    AVISITVIS2                    AVISITVIS3 </span></span>
<span><span class="co">#&gt;                    4.82858803                   10.33317002 </span></span>
<span><span class="co">#&gt;                    AVISITVIS4           ARMCDTRT:AVISITVIS2 </span></span>
<span><span class="co">#&gt;                   15.05255715                   -0.01737409 </span></span>
<span><span class="co">#&gt;           ARMCDTRT:AVISITVIS3           ARMCDTRT:AVISITVIS4 </span></span>
<span><span class="co">#&gt;                   -0.66753189                    0.63094392 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="hypothesis-testing">Hypothesis testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h2>
<p>This package supports estimation of one- and multi-dimensional
contrasts (t-test and F-test calculation) with the <a href="https://openpharma.github.io/mmrm/main/reference/df_1d.html"><code>df_1d()</code></a>
and <a href="https://openpharma.github.io/mmrm/main/reference/df_md.html"><code>df_md()</code></a>
functions. Both functions utilize the chosen adjustment method from the
initial <code>mmrm</code> call for the calculation of degrees of freedom
and (for Kenward-Roger methods) the variance estimates for the
test-statistics.</p>
<div class="section level3">
<h3 id="one-dimensional-contrasts">One-dimensional contrasts<a class="anchor" aria-label="anchor" href="#one-dimensional-contrasts"></a>
</h3>
<p>Compute the test of a one-dimensional (vector) contrast for a
<code>mmrm</code> object with Satterthwaite degrees of freedom.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">contrast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/component.html">component</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"beta_est"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">contrast</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="fu"><a href="../reference/df_1d.html">df_1d</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">contrast</span><span class="op">)</span></span>
<span><span class="co">#&gt; $est</span></span>
<span><span class="co">#&gt; [1] 5.643565</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $se</span></span>
<span><span class="co">#&gt; [1] 0.6656093</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt; [1] 157.1382</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_stat</span></span>
<span><span class="co">#&gt; [1] 8.478795</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p_val</span></span>
<span><span class="co">#&gt; [1] 1.564869e-14</span></span></code></pre></div>
<p>This works similarly when choosing a Kenward-Roger adjustment:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_kr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Kenward-Roger"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/df_1d.html">df_1d</a></span><span class="op">(</span><span class="va">fit_kr</span>, <span class="va">contrast</span><span class="op">)</span></span>
<span><span class="co">#&gt; $est</span></span>
<span><span class="co">#&gt; [1] 5.643565</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $se</span></span>
<span><span class="co">#&gt; [1] 0.6740941</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt; [1] 157.1382</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_stat</span></span>
<span><span class="co">#&gt; [1] 8.372073</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p_val</span></span>
<span><span class="co">#&gt; [1] 2.931654e-14</span></span></code></pre></div>
<p>We see that because this is a one-dimensional contrast, the degrees
of freedoms are identical for Satterthwaite and Kenward-Roger. However,
the standard errors are different and therefore the p-values are
different.</p>
</div>
<div class="section level3">
<h3 id="multi-dimensional-contrasts">Multi-dimensional contrasts<a class="anchor" aria-label="anchor" href="#multi-dimensional-contrasts"></a>
</h3>
<p>Compute the test of a multi-dimensional (matrix) contrast for the
above defined <code>mmrm</code> object with Satterthwaite degrees of
freedom:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fl">0</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/component.html">component</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"beta_est"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">contrast</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">contrast</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="fu"><a href="../reference/df_md.html">df_md</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">contrast</span><span class="op">)</span></span>
<span><span class="co">#&gt; $num_df</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $denom_df</span></span>
<span><span class="co">#&gt; [1] 165.5553</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $f_stat</span></span>
<span><span class="co">#&gt; [1] 36.91143</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p_val</span></span>
<span><span class="co">#&gt; [1] 5.544575e-14</span></span></code></pre></div>
<p>And for the Kenward-Roger adjustment:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/df_md.html">df_md</a></span><span class="op">(</span><span class="va">fit_kr</span>, <span class="va">contrast</span><span class="op">)</span></span>
<span><span class="co">#&gt; $num_df</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $denom_df</span></span>
<span><span class="co">#&gt; [1] 165.5728</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $f_stat</span></span>
<span><span class="co">#&gt; [1] 35.99422</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p_val</span></span>
<span><span class="co">#&gt; [1] 1.04762e-13</span></span></code></pre></div>
<p>We see that for the multi-dimensional contrast we get slightly
different denominator degrees of freedom for the two adjustment
methods.</p>
</div>
<div class="section level3">
<h3 id="support-for-emmeans">Support for emmeans<a class="anchor" aria-label="anchor" href="#support-for-emmeans"></a>
</h3>
<p>This package includes methods that allow <code>mmrm</code> objects to
be used with the <code>emmeans</code> package. <code>emmeans</code>
computes estimated marginal means (also called least-square means) for
the coefficients of the MMRM.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans" class="external-link">emmeans</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">fit</span>, <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">|</span> <span class="va">AVISIT</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Loading required package: emmeans</span></span>
<span><span class="co">#&gt; mmrm() registered as emmeans extension</span></span>
<span><span class="co">#&gt; AVISIT = VIS1:</span></span>
<span><span class="co">#&gt;  ARMCD emmean    SE  df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  PBO     33.3 0.757 149     31.8     34.8</span></span>
<span><span class="co">#&gt;  TRT     37.1 0.764 144     35.6     38.6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AVISIT = VIS2:</span></span>
<span><span class="co">#&gt;  ARMCD emmean    SE  df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  PBO     38.2 0.608 150     37.0     39.4</span></span>
<span><span class="co">#&gt;  TRT     41.9 0.598 146     40.7     43.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AVISIT = VIS3:</span></span>
<span><span class="co">#&gt;  ARMCD emmean    SE  df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  PBO     43.7 0.462 131     42.8     44.6</span></span>
<span><span class="co">#&gt;  TRT     46.8 0.507 130     45.8     47.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AVISIT = VIS4:</span></span>
<span><span class="co">#&gt;  ARMCD emmean    SE  df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  PBO     48.4 1.189 134     46.0     50.7</span></span>
<span><span class="co">#&gt;  TRT     52.8 1.188 133     50.4     55.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results are averaged over the levels of: RACE </span></span>
<span><span class="co">#&gt; Confidence level used: 0.95</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p>The <code>mmrm</code> package is based on previous work internal in
Roche, namely the <code>tern</code> and <code>tern.mmrm</code> packages
which were based on <code>lme4</code>. The work done in the
<code>rbmi</code> package has been important since it used
<code>glmmTMB</code> for fitting MMRMs.</p>
<p>We would like to thank Ben Bolker from the <code>glmmTMB</code> team
for multiple discussions when we tried to get the Satterthwaite degrees
of freedom implemented with <code>glmmTMB</code> (see <a href="https://github.com/glmmTMB/glmmTMB/blob/satterthwaite_df/glmmTMB/vignettes/satterthwaite_unstructured_example2.Rmd" class="external-link uri">https://github.com/glmmTMB/glmmTMB/blob/satterthwaite_df/glmmTMB/vignettes/satterthwaite_unstructured_example2.Rmd</a>).
Also Ben helped us significantly with an example showing how to use
<code>TMB</code> for a random effect vector (<a href="https://github.com/bbolker/tmb-case-studies/tree/master/vectorMixed" class="external-link uri">https://github.com/bbolker/tmb-case-studies/tree/master/vectorMixed</a>).</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Daniel Sabanes Bove, Julia Dedic, Doug Kelkhoff, Kevin Kunzmann, Brian Matthew Lang, Liming Li, Christian Stock, Ya Wang, Dan James, Boehringer Ingelheim Ltd., Gilead Sciences, Inc., F. Hoffmann-La Roche AG, Merck Sharp &amp; Dohme, Inc., AstraZeneca plc.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
