<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Comparison with other software • mmrm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comparison with other software">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.13</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Package Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/methodological_introduction.html">Mixed Models for Repeated Measures</a></li>
    <li><a class="dropdown-item" href="../articles/mmrm_review_methods.html">Comparison with other software</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Covariance Structures</h6></li>
    <li><a class="dropdown-item" href="../articles/covariance.html">Covariance Structures</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Degrees of Freedom and Testing</h6></li>
    <li><a class="dropdown-item" href="../articles/hypothesis_testing.html">Details of Hypothesis Testing</a></li>
    <li><a class="dropdown-item" href="../articles/between_within.html">Between-Within</a></li>
    <li><a class="dropdown-item" href="../articles/kenward.html">Kenward-Roger</a></li>
    <li><a class="dropdown-item" href="../articles/satterthwaite.html">Satterthwaite</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Coefficient Covariance</h6></li>
    <li><a class="dropdown-item" href="../articles/coef_vcov.html">Coefficients Covariance Matrix Adjustment</a></li>
    <li><a class="dropdown-item" href="../articles/empirical_wls.html">Details of Weighted Least Square Empirical Covariance</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Algorithm Details</h6></li>
    <li><a class="dropdown-item" href="../articles/algorithm.html">Model Fitting Algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/predict.html">Prediction and Simulation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developers</h6></li>
    <li><a class="dropdown-item" href="../articles/package_structure.html">Package Structure</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
<!-- start dropdown for versions --> <li class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle"
          data-bs-toggle="dropdown" role="button"
          aria-expanded="false" aria-haspopup="true"
          id="dropdown-versions">Versions</a> <div class="dropdown-menu" aria-labelledby="dropdown-versions"> <a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.13">v0.3.13</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.12">v0.3.12</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.11">v0.3.11</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.10">v0.3.10</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.7">v0.3.7</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.6">v0.3.6</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.5">v0.3.5</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.4">v0.3.4</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.3">v0.3.3</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.2">v0.3.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.1">v0.3.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.0">v0.3.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.2.2">v0.2.2</a> </div></li>
<!-- end dropdown for versions -->
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reports" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reports</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reports">
<li><a class="dropdown-item" href="../coverage-report/">Coverage report</a></li>
    <li><a class="dropdown-item" href="../unit-test-report/">Unit test report</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/mmrm"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Comparison with other software</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/mmrm/blob/main/vignettes/mmrm_review_methods.Rmd" class="external-link"><code>vignettes/mmrm_review_methods.Rmd</code></a></small>
      <div class="d-none name"><code>mmrm_review_methods.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette we briefly compare the <code><a href="../reference/mmrm.html">mmrm::mmrm</a></code>,
SAS’s <code>PROC GLIMMIX</code>, <code><a href="https://rdrr.io/pkg/nlme/man/gls.html" class="external-link">nlme::gls</a></code>,
<code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer</a></code>, and <code><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html" class="external-link">glmmTMB::glmmTMB</a></code> functions for
fitting mixed models for repeated measures (MMRMs). A primary difference
in these implementations lies in the covariance structures that are
supported “out of the box”. In particular, <code>PROC GLIMMIX</code> and
<code>mmrm</code> are the only procedures which provide support for many
of the most common MMRM covariance structures. Most covariance
structures can be implemented in <code>gls</code>, though users are
required to define them manually. <code>lmer</code> and
<code>glmmTMB</code> are more limited. We find that <code>mmmrm</code>
converges more quickly than other R implementations while also producing
estimates that are virtually identical to
<code>PROC GLIMMIX</code>’s.</p>
</div>
<div class="section level2">
<h2 id="datasets">Datasets<a class="anchor" aria-label="anchor" href="#datasets"></a>
</h2>
<p>Two datasets are used to illustrate model fitting with the
<code>mmrm</code>, <code>lme4</code>, <code>nlme</code>,
<code>glmmTMB</code> R packages as well as <code>PROC GLIMMIX</code>.
These data are also used to compare these implementations’ operating
characteristics.</p>
<div class="section level3">
<h3 id="fev-data">FEV Data<a class="anchor" aria-label="anchor" href="#fev-data"></a>
</h3>
<p>The FEV dataset contains measurements of FEV1 (forced expired volume
in one second), a measure of how quickly the lungs can be emptied. Low
levels of FEV1 may indicate chronic obstructive pulmonary disease
(COPD). It is summarized below.</p>
<pre><code>                                      Stratified by ARMCD
                               Overall       PBO           TRT
  n                              800           420           380
  USUBJID (%)
     PT[1-200]                   200           105 (52.5)     95 (47.5)
  AVISIT
     VIS1                        200           105            95
     VIS2                        200           105            95
     VIS3                        200           105            95
     VIS4                        200           105            95
  RACE (%)
     Asian                       280 (35.0)    152 (36.2)    128 (33.7)
     Black or African American   300 (37.5)    184 (43.8)    116 (30.5)
     White                       220 (27.5)     84 (20.0)    136 (35.8)
  SEX = Female (%)               424 (53.0)    220 (52.4)    204 (53.7)
  FEV1_BL (mean (SD))          40.19 (9.12)  40.46 (8.84)  39.90 (9.42)
  FEV1 (mean (SD))             42.30 (9.32)  40.24 (8.67)  44.45 (9.51)
  WEIGHT (mean (SD))            0.52 (0.23)   0.52 (0.23)   0.51 (0.23)
  VISITN (mean (SD))            2.50 (1.12)   2.50 (1.12)   2.50 (1.12)
  VISITN2 (mean (SD))          -0.02 (1.03)   0.01 (1.07)  -0.04 (0.98)</code></pre>
</div>
<div class="section level3">
<h3 id="bcva-data">BCVA Data<a class="anchor" aria-label="anchor" href="#bcva-data"></a>
</h3>
<p>The BCVA dataset contains data from a randomized longitudinal
ophthalmology trial evaluating the change in baseline corrected visual
acuity (BCVA) over the course of 10 visits. BCVA corresponds to the
number of letters read from a visual acuity chart. A summary of the data
is given below:</p>
<pre><code>                                      Stratified by ARMCD
                               Overall         CTL            TRT
  n                             8605          4123           4482
  USUBJID (%)
     PT[1-1000]                 1000           494 (49.4)     506 (50.6)
  AVISIT
     VIS1                        983           482            501
     VIS2                        980           481            499
     VIS3                        960           471            489
     VIS4                        946           458            488
     VIS5                        925           454            471
     VIS6                        868           410            458
     VIS7                        816           388            428
     VIS8                        791           371            420
     VIS9                        719           327            392
     VIS10                       617           281            336
  RACE (%)
     Asian                       297 (29.7)    151 (30.6)     146 (28.9)
     Black or African American   317 (31.7)    149 (30.1)     168 (33.2)
     White                       386 (38.6)    194 (39.3)     192 (37.9)
  BCVA_BL (mean (SD))          75.12 (9.93)  74.90 (9.76)   75.40 (10.1)
  BCVA_CHG (mean (SD))
     VIS1                       5.59 (1.31)   5.32 (1.23)    5.86 (1.33)
     VIS10                      9.18 (2.91)   7.49 (2.58)   10.60 (2.36)</code></pre>
</div>
</div>
<div class="section level2">
<h2 class="tabset" id="model-implementations">Model Implementations<a class="anchor" aria-label="anchor" href="#model-implementations"></a>
</h2>
<p>Listed below are some of the most commonly used covariance structures
used when fitting MMRMs. We indicate which matrices are available “out
of the box” for each implementation considered in this vignette. Note
that this table is not exhaustive; <code>PROC GLIMMIX</code> and
<code>glmmTMB</code> support additional spatial covariance
structures.</p>
<table class="table">
<colgroup>
<col width="42%">
<col width="9%">
<col width="16%">
<col width="8%">
<col width="9%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="center">Covariance structures</th>
<th align="center"><code>mmrm</code></th>
<th align="center"><code>PROC GLIMMIX</code></th>
<th align="center"><code>gls</code></th>
<th align="center"><code>lmer</code></th>
<th align="center"><code>glmmTMB</code></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Ante-dependence (heterogeneous)</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">Ante-dependence (homogeneous)</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">Auto-regressive (heterogeneous)</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">Auto-regressive (homogeneous)</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
</tr>
<tr class="odd">
<td align="center">Compound symmetry (heterogeneous)</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
</tr>
<tr class="even">
<td align="center">Compound symmetry (homogeneous)</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">Spatial exponential</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
</tr>
<tr class="even">
<td align="center">Toeplitz (heterogeneous)</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
</tr>
<tr class="odd">
<td align="center">Toeplitz (homogeneous)</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">Unstructured</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
</tr>
</tbody>
</table>
<p>Code for fitting MMRMs to the FEV data using each of the considered
functions and covariance structures are provided below. Fixed effects
for the visit number, treatment assignment and the interaction between
the two are modeled.</p>
<div class="section level3">
<h3 id="ante-dependence-heterogeneous">Ante-dependence (heterogeneous)<a class="anchor" aria-label="anchor" href="#ante-dependence-heterogeneous"></a>
</h3>
<div class="section level4">
<h4 id="proc-glimmix">
<code>PROC GLIMMIX</code><a class="anchor" aria-label="anchor" href="#proc-glimmix"></a>
</h4>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID type=ANTE(1)</b>;
</code></pre>
</div>
<div class="section level4">
<h4 id="mmrm">
<code>mmrm</code><a class="anchor" aria-label="anchor" href="#mmrm"></a>
</h4>
<pre><code><span><span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">adh</span><span class="op">(</span><span class="va">VISITN</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="ante-dependence-homogeneous">Ante-dependence (homogeneous)<a class="anchor" aria-label="anchor" href="#ante-dependence-homogeneous"></a>
</h3>
<div class="section level4">
<h4 id="mmrm-1">
<code>mmrm</code><a class="anchor" aria-label="anchor" href="#mmrm-1"></a>
</h4>
<pre><code><span><span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span><span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">ad</span><span class="op">(</span><span class="va">VISITN</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="auto-regressive-heterogeneous">Auto-regressive (heterogeneous)<a class="anchor" aria-label="anchor" href="#auto-regressive-heterogeneous"></a>
</h3>
<div class="section level4">
<h4 id="proc-glimmix-1">
<code>PROC GLIMMIX</code><a class="anchor" aria-label="anchor" href="#proc-glimmix-1"></a>
</h4>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID type=ARH(1)</b>;
</code></pre>
</div>
<div class="section level4">
<h4 id="mmrm-2">
<code>mmrm</code><a class="anchor" aria-label="anchor" href="#mmrm-2"></a>
</h4>
<pre><code><span><span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">ar1h</span><span class="op">(</span><span class="va">VISITN</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="gls">
<code>gls</code><a class="anchor" aria-label="anchor" href="#gls"></a>
</h4>
<pre><code><span><span class="fu">gls</span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  correlation <span class="op">=</span> <span class="fu">corCAR1</span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu">varIdent</span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">AVISIT</span><span class="op">)</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="auto-regressive-homogeneous">Auto-regressive (homogeneous)<a class="anchor" aria-label="anchor" href="#auto-regressive-homogeneous"></a>
</h3>
<div class="section level4">
<h4 id="proc-glimmix-2">
<code>PROC GLIMMIX</code><a class="anchor" aria-label="anchor" href="#proc-glimmix-2"></a>
</h4>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 =  ARMCD|AVISIT / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID type=AR(1)</b>;
</code></pre>
</div>
<div class="section level4">
<h4 id="mmrm-3">
<code>mmrm</code><a class="anchor" aria-label="anchor" href="#mmrm-3"></a>
</h4>
<pre><code><span><span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">ar1</span><span class="op">(</span><span class="va">VISITN</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="gls-1">
<code>gls</code><a class="anchor" aria-label="anchor" href="#gls-1"></a>
</h4>
<pre><code><span><span class="fu">gls</span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  correlation <span class="op">=</span> <span class="fu">corCAR1</span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="glmmtmb">
<code>glmmTMB</code><a class="anchor" aria-label="anchor" href="#glmmtmb"></a>
</h4>
<pre><code><span><span class="fu">glmmTMB</span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">ar1</span><span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  dispformula <span class="op">=</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="compound-symmetry-heterogeneous">Compound symmetry (heterogeneous)<a class="anchor" aria-label="anchor" href="#compound-symmetry-heterogeneous"></a>
</h3>
<div class="section level4">
<h4 id="proc-glimmix-3">
<code>PROC GLIMMIX</code><a class="anchor" aria-label="anchor" href="#proc-glimmix-3"></a>
</h4>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID type=CSH</b>;
</code></pre>
</div>
<div class="section level4">
<h4 id="mmrm-4">
<code>mmrm</code><a class="anchor" aria-label="anchor" href="#mmrm-4"></a>
</h4>
<pre><code><span><span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">csh</span><span class="op">(</span><span class="va">VISITN</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="gls-2">
<code>gls</code><a class="anchor" aria-label="anchor" href="#gls-2"></a>
</h4>
<pre><code><span><span class="fu">gls</span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  correlation <span class="op">=</span> <span class="fu">corCompSymm</span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu">varIdent</span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">AVISIT</span><span class="op">)</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="glmmtmb-1">
<code>glmmTMB</code><a class="anchor" aria-label="anchor" href="#glmmtmb-1"></a>
</h4>
<pre><code><span><span class="fu">glmmTMB</span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">cs</span><span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  dispformula <span class="op">=</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="compound-symmetry-homogeneous">Compound symmetry (homogeneous)<a class="anchor" aria-label="anchor" href="#compound-symmetry-homogeneous"></a>
</h3>
<div class="section level4">
<h4 id="proc-glimmix-4">
<code>PROC GLIMMIX</code><a class="anchor" aria-label="anchor" href="#proc-glimmix-4"></a>
</h4>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID type=CS</b>;
</code></pre>
</div>
<div class="section level4">
<h4 id="mmrm-5">
<code>mmrm</code><a class="anchor" aria-label="anchor" href="#mmrm-5"></a>
</h4>
<pre><code><span><span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">cs</span><span class="op">(</span><span class="va">VISITN</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="gls-3">
<code>gls</code><a class="anchor" aria-label="anchor" href="#gls-3"></a>
</h4>
<pre><code><span><span class="fu">gls</span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  correlation <span class="op">=</span> <span class="fu">corCompSymm</span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="spatial-exponential">Spatial exponential<a class="anchor" aria-label="anchor" href="#spatial-exponential"></a>
</h3>
<div class="section level4">
<h4 id="proc-glimmix-5">
<code>PROC GLIMMIX</code><a class="anchor" aria-label="anchor" href="#proc-glimmix-5"></a>
</h4>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM / subject=USUBJID type=sp(exp)(visitn)</b> rcorr;
</code></pre>
</div>
<div class="section level4">
<h4 id="mmrm-6">
<code>mmrm</code><a class="anchor" aria-label="anchor" href="#mmrm-6"></a>
</h4>
<pre><code><span><span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">sp_exp</span><span class="op">(</span><span class="va">VISITN</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="gls-4">
<code>gls</code><a class="anchor" aria-label="anchor" href="#gls-4"></a>
</h4>
<pre><code><span><span class="fu">gls</span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  correlation <span class="op">=</span> <span class="fu">corExp</span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu">varIdent</span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">AVISIT</span><span class="op">)</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="glmmtmb-2">
<code>glmmTMB</code><a class="anchor" aria-label="anchor" href="#glmmtmb-2"></a>
</h4>
<pre><code><span><span class="co"># NOTE: requires use of coordinates</span></span>
<span><span class="fu">glmmTMB</span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  dispformula <span class="op">=</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="toeplitz-heterogeneous">Toeplitz (heterogeneous)<a class="anchor" aria-label="anchor" href="#toeplitz-heterogeneous"></a>
</h3>
<div class="section level4">
<h4 id="proc-glimmix-6">
<code>PROC GLIMMIX</code><a class="anchor" aria-label="anchor" href="#proc-glimmix-6"></a>
</h4>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID type=TOEPH</b>;
</code></pre>
</div>
<div class="section level4">
<h4 id="mmrm-7">
<code>mmrm</code><a class="anchor" aria-label="anchor" href="#mmrm-7"></a>
</h4>
<pre><code><span><span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">toeph</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="glmmtmb-3">
<code>glmmTMB</code><a class="anchor" aria-label="anchor" href="#glmmtmb-3"></a>
</h4>
<pre><code><span> <span class="fu">glmmTMB</span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">toep</span><span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  dispformula <span class="op">=</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="toeplitz-homogeneous">Toeplitz (homogeneous)<a class="anchor" aria-label="anchor" href="#toeplitz-homogeneous"></a>
</h3>
<div class="section level4">
<h4 id="proc-glimmix-7">
<code>PROC GLIMMIX</code><a class="anchor" aria-label="anchor" href="#proc-glimmix-7"></a>
</h4>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID</b> <b>type=TOEP</b>;
</code></pre>
</div>
<div class="section level4">
<h4 id="mmrm-8">
<code>mmrm</code><a class="anchor" aria-label="anchor" href="#mmrm-8"></a>
</h4>
<pre><code><span><span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">toep</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="unstructured">Unstructured<a class="anchor" aria-label="anchor" href="#unstructured"></a>
</h3>
<div class="section level4">
<h4 id="proc-glimmix-8">
<code>PROC GLIMMIX</code><a class="anchor" aria-label="anchor" href="#proc-glimmix-8"></a>
</h4>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = ARMCD|AVISIT / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID</b> <b>type=un</b>;
</code></pre>
</div>
<div class="section level4">
<h4 id="mmrm-9">
<code>mmrm</code><a class="anchor" aria-label="anchor" href="#mmrm-9"></a>
</h4>
<pre><code><span><span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="gls-5">
<code>gls</code><a class="anchor" aria-label="anchor" href="#gls-5"></a>
</h4>
<pre><code><span><span class="fu">gls</span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span>  <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  correlation <span class="op">=</span> <span class="fu">corSymm</span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu">varIdent</span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">AVISIT</span><span class="op">)</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="lmer">
<code>lmer</code><a class="anchor" aria-label="anchor" href="#lmer"></a>
</h4>
<pre><code><span><span class="fu">lmer</span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  control <span class="op">=</span> <span class="fu">lmerControl</span><span class="op">(</span>check.nobs.vs.nRE <span class="op">=</span> <span class="st">"ignore"</span><span class="op">)</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="glmmtmb-4">
<code>glmmTMB</code><a class="anchor" aria-label="anchor" href="#glmmtmb-4"></a>
</h4>
<pre><code><span><span class="fu">glmmTMB</span><span class="op">(</span></span>
<span>  <span class="va">FEV1</span> <span class="op">~</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  dispformula <span class="op">=</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="benchmarking">Benchmarking<a class="anchor" aria-label="anchor" href="#benchmarking"></a>
</h2>
<p>Next, the MMRM fitting procedures are compared using the FEV and BCVA
datasets. FEV1 measurements are modeled as a function of race, treatment
arm, visit number, and the interaction between the treatment arm and the
visit number. Change in BCVA is assumed to be a function of race,
baseline BCVA, treatment arm, visit number, and the treatment–visit
interaction. In both datasets, repeated measures are modeled using an
unstructured covariance matrix. The implementations’ convergence times
are evaluated first, followed by a comparison of their estimates.
Finally, we fit these procedures on simulated BCVA-like data to assess
the impact of missingness on convergence rates.</p>
<div class="section level3">
<h3 id="convergence-times">Convergence Times<a class="anchor" aria-label="anchor" href="#convergence-times"></a>
</h3>
<div class="section level4">
<h4 id="fev-data-1">FEV Data<a class="anchor" aria-label="anchor" href="#fev-data-1"></a>
</h4>
<p>The <code>mmrm</code>, <code>PROC GLIMMIX</code>, <code>gls</code>,
<code>lmer</code>, and <code>glmmTMB</code> functions are applied to the
FEV dataset 10 times. The convergence times are recorded for each
replicate and are reported in the table below.</p>
<table class="table">
<caption>Comparison of convergence times: milliseconds</caption>
<thead><tr class="header">
<th align="left">Implementation</th>
<th align="right">Median</th>
<th align="right">First Quartile</th>
<th align="right">Third Quartile</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">mmrm</td>
<td align="right">56.15</td>
<td align="right">55.76</td>
<td align="right">56.30</td>
</tr>
<tr class="even">
<td align="left">PROC GLIMMIX</td>
<td align="right">100.00</td>
<td align="right">100.00</td>
<td align="right">100.00</td>
</tr>
<tr class="odd">
<td align="left">lmer</td>
<td align="right">247.02</td>
<td align="right">245.25</td>
<td align="right">257.46</td>
</tr>
<tr class="even">
<td align="left">gls</td>
<td align="right">687.63</td>
<td align="right">683.50</td>
<td align="right">692.45</td>
</tr>
<tr class="odd">
<td align="left">glmmTMB</td>
<td align="right">715.90</td>
<td align="right">708.70</td>
<td align="right">721.57</td>
</tr>
</tbody>
</table>
<p>It is clear from these results that <code>mmrm</code> converges
significantly faster than other R functions. Though not demonstrated
here, this is generally true regardless of the sample size and
covariance structure used. <code>mmrm</code> is faster than
<code>PROC GLIMMIX</code>.</p>
</div>
<div class="section level4">
<h4 id="bcva-data-1">BCVA Data<a class="anchor" aria-label="anchor" href="#bcva-data-1"></a>
</h4>
<p>The MMRM implementations are now applied to the BCVA dataset 10
times. The convergence times are presented below.</p>
<table class="table">
<caption>Comparison of convergence times: seconds</caption>
<thead><tr class="header">
<th align="left">Implementation</th>
<th align="right">Median</th>
<th align="right">First Quartile</th>
<th align="right">Third Quartile</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">mmrm</td>
<td align="right">3.36</td>
<td align="right">3.32</td>
<td align="right">3.46</td>
</tr>
<tr class="even">
<td align="left">glmmTMB</td>
<td align="right">18.65</td>
<td align="right">18.14</td>
<td align="right">18.87</td>
</tr>
<tr class="odd">
<td align="left">PROC GLIMMIX</td>
<td align="right">36.25</td>
<td align="right">36.17</td>
<td align="right">36.29</td>
</tr>
<tr class="even">
<td align="left">gls</td>
<td align="right">164.36</td>
<td align="right">158.61</td>
<td align="right">165.93</td>
</tr>
<tr class="odd">
<td align="left">lmer</td>
<td align="right">165.26</td>
<td align="right">157.46</td>
<td align="right">166.42</td>
</tr>
</tbody>
</table>
<p>We again find that <code>mmrm</code> produces the fastest convergence
times on average.</p>
</div>
</div>
<div class="section level3">
<h3 id="marginal-treatment-effect-estimates-comparison">Marginal Treatment Effect Estimates Comparison<a class="anchor" aria-label="anchor" href="#marginal-treatment-effect-estimates-comparison"></a>
</h3>
<p>We next estimate the marginal mean treatment effects for each visit
in the FEV and BCVA datasets using the MMRM fitting procedures. All R
implementations’ estimates are reported relative to
<code>PROC GLIMMIX</code>’s estimates. Convergence status is also
reported.</p>
<div class="section level4">
<h4 id="fev-data-2">FEV Data<a class="anchor" aria-label="anchor" href="#fev-data-2"></a>
</h4>
<p><img src="mmrm-review-treatment-fev-1.png" width="100%"></p>
<p>The R procedures’ estimates are very similar to those output by
<code>PROC GLIMMIX</code>, though <code>mmrm</code> and <code>gls</code>
generate the estimates that are closest to those produced when using
SAS. All methods converge using their default optimization
arguments.</p>
</div>
<div class="section level4">
<h4 id="bcva-data-2">BCVA Data<a class="anchor" aria-label="anchor" href="#bcva-data-2"></a>
</h4>
<p><img src="mmrm-review-treatment-bcva-1.png" width="100%"><img src="mmrm-review-treatment-bcva-2.png" width="100%"></p>
<p><code>mmrm</code>, <code>gls</code> and <code>lmer</code> produce
estimates that are virtually identical to <code>PROC GLIMMIX</code>’s,
while <code>glmmTMB</code> does not. This is likely explained by
<code>glmmTMB</code>’s failure to converge. Note too that
<code>lmer</code> fails to converge.</p>
</div>
</div>
<div class="section level3">
<h3 id="impact-of-missing-data-on-convergence-rates">Impact of Missing Data on Convergence Rates<a class="anchor" aria-label="anchor" href="#impact-of-missing-data-on-convergence-rates"></a>
</h3>
<p>The results of the previous benchmark suggest that the amount of
patients missing from later time points affect certain implementations’
capacity to converge. We investigate this further by simulating data
using a data-generating process similar to that of the BCVA datasets,
though with various rates of patient dropout.</p>
<p>Ten datasets of 200 patients are generated each of the following
levels of missingness: none, mild, moderate, and high. In all scenarios,
observations are missing at random. The number patients observed at each
visit is obtained for one replicated dataset at each level of
missingness is presented in the table below.</p>
<table class="table">
<caption>Number of patients per visit</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">none</th>
<th align="right">mild</th>
<th align="right">moderate</th>
<th align="right">high</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">VIS01</td>
<td align="right">200</td>
<td align="right">196.7</td>
<td align="right">197.6</td>
<td align="right">188.1</td>
</tr>
<tr class="even">
<td align="left">VIS02</td>
<td align="right">200</td>
<td align="right">195.4</td>
<td align="right">194.4</td>
<td align="right">182.4</td>
</tr>
<tr class="odd">
<td align="left">VIS03</td>
<td align="right">200</td>
<td align="right">195.1</td>
<td align="right">190.7</td>
<td align="right">175.2</td>
</tr>
<tr class="even">
<td align="left">VIS04</td>
<td align="right">200</td>
<td align="right">194.1</td>
<td align="right">188.4</td>
<td align="right">162.8</td>
</tr>
<tr class="odd">
<td align="left">VIS05</td>
<td align="right">200</td>
<td align="right">191.6</td>
<td align="right">182.5</td>
<td align="right">142.7</td>
</tr>
<tr class="even">
<td align="left">VIS06</td>
<td align="right">200</td>
<td align="right">188.2</td>
<td align="right">177.3</td>
<td align="right">125.4</td>
</tr>
<tr class="odd">
<td align="left">VIS07</td>
<td align="right">200</td>
<td align="right">184.6</td>
<td align="right">168.0</td>
<td align="right">105.9</td>
</tr>
<tr class="even">
<td align="left">VIS08</td>
<td align="right">200</td>
<td align="right">178.5</td>
<td align="right">155.4</td>
<td align="right">82.6</td>
</tr>
<tr class="odd">
<td align="left">VIS09</td>
<td align="right">200</td>
<td align="right">175.3</td>
<td align="right">139.9</td>
<td align="right">58.1</td>
</tr>
<tr class="even">
<td align="left">VIS10</td>
<td align="right">200</td>
<td align="right">164.1</td>
<td align="right">124.0</td>
<td align="right">39.5</td>
</tr>
</tbody>
</table>
<p>The convergence rates of all implementations for stratified by
missingness level is presented in the plot below.</p>
<p><img src="mmrm-review-convergence-rate-missingness-1.png" width="100%"></p>
<p><code>mmrm</code>, <code>gls</code>, and <code>PROC GLIMMIX</code>
are resilient to missingness, only exhibiting some convergence problems
in the scenarios with the most missingness. These implementations
converged in all the other scenarios’ replicates. <code>glmmTMB</code>,
on the other hand, has convergence issues in the no-, mild-, and
high-missingness datasets, with the worst convergence rate occurring in
the datasets with the most dropout. Finally, <code>lmer</code> is
unreliable in all scenarios, suggesting that it’s convergence issues
stem from something other than the missing observations.</p>
<p>Note that the default optimization schemes are used for each method;
these schemes can be modified to potentially improve convergence
rates.</p>
<p>A more comprehensive simulation study using data-generating processes
similar to the one used here is outlined in the <a href="https://github.com/openpharma/mmrm/tree/main/simulations/missing-data-benchmarks" class="external-link"><code>simulations/missing-data-benchmarks</code></a>
subdirectory. In addition to assessing the effect of missing data on
software convergence rates, we also evaluate these methods’ fit times
and empirical bias, variance, 95% coverage rates, type I error rates and
type II error rates. <code>mmrm</code> is found to be the most most
robust software for fitting MMRMs in scenarios where a large proportion
of patients are missing from the last time points. Additionally,
<code>mmrm</code> has the fastest average fit times regardless of the
amount of missingness. All implementations considered produce similar
empirical biases, variances, 95% coverage rates, type I error rates and
type II error rates.</p>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<pre><code><span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Etc/UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] ggplot2_3.5.1           emmeans_1.10.4          knitr_1.48             </span></span>
<span><span class="co">#&gt;  [4] sasr_0.1.2              glmmTMB_1.1.9           nlme_3.1-166           </span></span>
<span><span class="co">#&gt;  [7] lme4_1.1-35.5           Matrix_1.7-0            mmrm_0.3.13            </span></span>
<span><span class="co">#&gt; [10] stringr_1.5.1           microbenchmark_1.5.0    purrr_1.0.2            </span></span>
<span><span class="co">#&gt; [13] dplyr_1.1.4             clusterGeneration_1.3.8 MASS_7.3-61            </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.5        TMB_1.9.15          xfun_0.47          </span></span>
<span><span class="co">#&gt;  [4] bslib_0.8.0         htmlwidgets_1.6.4   lattice_0.22-6     </span></span>
<span><span class="co">#&gt;  [7] numDeriv_2016.8-1.1 vctrs_0.6.5         tools_4.4.1        </span></span>
<span><span class="co">#&gt; [10] Rdpack_2.6.1        generics_0.1.3      sandwich_3.1-1     </span></span>
<span><span class="co">#&gt; [13] tibble_3.2.1        fansi_1.0.6         highr_0.11         </span></span>
<span><span class="co">#&gt; [16] pkgconfig_2.0.3     checkmate_2.3.2     desc_1.4.3         </span></span>
<span><span class="co">#&gt; [19] lifecycle_1.0.4     farver_2.1.2        compiler_4.4.1     </span></span>
<span><span class="co">#&gt; [22] textshaping_0.4.0   munsell_0.5.1       codetools_0.2-20   </span></span>
<span><span class="co">#&gt; [25] htmltools_0.5.8.1   sass_0.4.9          yaml_2.3.10        </span></span>
<span><span class="co">#&gt; [28] pillar_1.9.0        pkgdown_2.1.1       nloptr_2.1.1       </span></span>
<span><span class="co">#&gt; [31] jquerylib_0.1.4     cachem_1.1.0        boot_1.3-31        </span></span>
<span><span class="co">#&gt; [34] multcomp_1.4-26     tidyselect_1.2.1    digest_0.6.37      </span></span>
<span><span class="co">#&gt; [37] mvtnorm_1.3-1       stringi_1.8.4       labeling_0.4.3     </span></span>
<span><span class="co">#&gt; [40] splines_4.4.1       fastmap_1.2.0       grid_4.4.1         </span></span>
<span><span class="co">#&gt; [43] colorspace_2.1-1    cli_3.6.3           magrittr_2.0.3     </span></span>
<span><span class="co">#&gt; [46] survival_3.7-0      utf8_1.2.4          TH.data_1.1-2      </span></span>
<span><span class="co">#&gt; [49] withr_3.0.1         scales_1.3.0        backports_1.5.0    </span></span>
<span><span class="co">#&gt; [52] estimability_1.5.1  rmarkdown_2.28      reticulate_1.39.0  </span></span>
<span><span class="co">#&gt; [55] png_0.1-8           ragg_1.3.3          zoo_1.8-12         </span></span>
<span><span class="co">#&gt; [58] coda_0.19-4.1       evaluate_1.0.0      rbibutils_2.2.16   </span></span>
<span><span class="co">#&gt; [61] mgcv_1.9-1          rlang_1.1.4         Rcpp_1.0.13        </span></span>
<span><span class="co">#&gt; [64] xtable_1.8-4        glue_1.7.0          minqa_1.2.8        </span></span>
<span><span class="co">#&gt; [67] jsonlite_1.8.9      R6_2.5.1            systemfonts_1.1.0  </span></span>
<span><span class="co">#&gt; [70] fs_1.6.4</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Sabanes Bove, Liming Li, Julia Dedic, Doug Kelkhoff, Kevin Kunzmann, Brian Matthew Lang, Christian Stock, Ya Wang, Dan James, Jonathan Sidi, Daniel Leibovitz, Daniel D. Sjoberg, Boehringer Ingelheim Ltd., Gilead Sciences, Inc., F. Hoffmann-La Roche AG, Merck Sharp &amp; Dohme, Inc., AstraZeneca plc, inferential.biostatistics GmbH.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
