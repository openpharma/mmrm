<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mmrm">
<title>What are MMRMs? A brief introduction • mmrm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="What are MMRMs? A brief introduction">
<meta property="og:description" content="mmrm">
<meta property="og:image" content="https://openpharma.github.io/mmrm/main/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2.9006</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/algorithm.html">Details of the Model Fitting in `mmrm`</a>
    <a class="dropdown-item" href="../articles/coef_vcov.html">Coefficients Covariance Matrix Adjustment in `mmrm`</a>
    <a class="dropdown-item" href="../articles/covariance.html">Covariance Structures in `mmrm`</a>
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to `mmrm`</a>
    <a class="dropdown-item" href="../articles/kenward.html">Details of the Kenward-Roger calculations</a>
    <a class="dropdown-item" href="../articles/methodological_introduction.html">What are MMRMs? A brief introduction</a>
    <a class="dropdown-item" href="../articles/package_structure.html">Package Structure</a>
    <a class="dropdown-item" href="../articles/satterthwaite.html">Details of the Satterthwaite calculations</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/openpharma/mmrm">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>What are MMRMs? A brief introduction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/mmrm/blob/HEAD/vignettes/methodological_introduction.Rmd" class="external-link"><code>vignettes/methodological_introduction.Rmd</code></a></small>
      <div class="d-none name"><code>methodological_introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>Mixed models for repeated measures (MMRMs) are frequently used in the
analysis of data from clinical trials. They are specifically suited to
model continuous variables that were repeatedly measured at discrete
time points (or within defined time-windows). In a clinical trial, these
time points are typically visits according to a schedule that is
pre-defined in the trial protocol. The distinguishing feature of MMRMs,
compared to other implementations of linear mixed models, is that
subject-specific random effects (which are not of direct interest for
estimation and inference) are considered as residual effects, i.e. they
are part of the error correlation matrix. This vignette provides a brief
methodological introduction to MMRMs. MMRMs are described as an
extension to a basic linear mixed-effects model. The aim is to provide a
basic orientation and guide for applied statisticians working in the
field of clinical trials regarding theoretical underpinnings of MMRMs
and practical use in clinical trials. In the descriptions of the models
below, we generally follow <span class="citation">Pinheiro and Bates
(2000)</span> and <span class="citation">C. Mallinckrodt and Lipkovich
(2017)</span>.</p>
</div>
<div class="section level2">
<h2 id="the-basic-linear-mixed-effects-model">The basic linear mixed-effects model<a class="anchor" aria-label="anchor" href="#the-basic-linear-mixed-effects-model"></a>
</h2>
<p><span class="citation">Laird and Ware (1982)</span> introduced the
basic linear mixed-effects model for a single level of grouping to be
any model that expresses an <span class="math inline">\(n_i\)</span>-dimensional response (column) vector
<span class="math inline">\(y_i\)</span> for the <span class="math inline">\(i\)</span>th subject (or, more generally, group or
unit) as <span class="math display">\[
y_i = X_i \beta + Z_i b_i + \epsilon_i, \quad i=1,\ldots,M ,\\
b_i \sim \mathcal{N}(0,\Psi), \quad \epsilon_i \sim
\mathcal{N}(0,\sigma^2I),
\]</span> where</p>
<ul>
<li>
<span class="math inline">\(\beta\)</span> is the <span class="math inline">\(p\)</span>-dimensional vector of fixed
effects,</li>
<li>
<span class="math inline">\(b\)</span> is the <span class="math inline">\(q\)</span>-dimensional vector of random
patient-specific effects,</li>
<li>
<span class="math inline">\(X_i\)</span> (of size <span class="math inline">\(n_i \times p\)</span>) and <span class="math inline">\(Z_i\)</span> (of size <span class="math inline">\(n_i \times q\)</span>) are known regressor
matrices relating observations to the fixed-effects and random-effects,
respectively, and</li>
<li>
<span class="math inline">\(\epsilon_i\)</span> is the <span class="math inline">\(n_i\)</span>-dimensional within-subject
error.</li>
</ul>
<p>The random effects <span class="math inline">\(b_i\)</span> and the
within-group errors <span class="math inline">\(\epsilon_i\)</span> are
assumed to follow a normal distribution, with means of <span class="math inline">\(0\)</span> and variance-covariance matrices <span class="math inline">\(\Psi\)</span> and <span class="math inline">\(\sigma^2I\)</span>, where <span class="math inline">\(I\)</span> is an identity matrix. They are further
assumed to be independent for different subjects and independent of each
other for the same subject. The random effects <span class="math inline">\(b_i\)</span> describe the shift from the mean of
the linear predictor for each subject. As they are defined to have a
mean of <span class="math inline">\(0\)</span>, any non-zero mean for a
term in the random effects must be expressed as part of the
fixed-effects terms. Therefore, the columns of <span class="math inline">\(Z_i\)</span> are usually a (small) subset of the
columns of <span class="math inline">\(X_i\)</span>.</p>
<p>Mixed models are called “mixed” because they consider both fixed and
random effects and thus allow considerable modeling flexibility. This is
the case even for the basic formulation described above. However, it
still restricts within-group errors to be independent, identically
distributed random variables with mean of zero and constant variance.
These assumptions may often be seen as too restrictive (unrealistic) for
applications. For example, in the case of clinical trials with repeated
measurements of subjects over time, observations are not independent and
within-subject correlation needs to be accounted for by the model.</p>
</div>
<div class="section level2">
<h2 id="extending-the-basic-linear-mixed-effects-model">Extending the basic linear mixed-effects model<a class="anchor" aria-label="anchor" href="#extending-the-basic-linear-mixed-effects-model"></a>
</h2>
<p>The basic linear mixed-effects model can be extended in order to
incorporate within-subject errors that are heteroscedastic (i.e. have
unequal variances) and/ or are correlated. For this purpose, we can
express the within-subject errors as: <span class="math display">\[
  \epsilon_i \sim \mathcal{N}(0,\Lambda_i), \quad i=1,\ldots,M,
\]</span> where the <span class="math inline">\(\Lambda_i\)</span> are
positive-definite matrices parameterized by a fixed, generally small set
of parameters <span class="math inline">\(\lambda\)</span>. As in the
basic model, the within-group errors <span class="math inline">\(\epsilon_i\)</span> are assumed to be independent
for different <span class="math inline">\(i\)</span> and independent of
the random effects <span class="math inline">\(b_i\)</span>. The
variance-covariance matrix of the response vector <span class="math inline">\(y_i\)</span>, <span class="math display">\[
  \text{Var}(y_i) = \Sigma_i = \left( Z_i \Psi Z_{i}^{T} + \Lambda_i
\right),  
\]</span> comprises a random-effects component, given by <span class="math inline">\(Z_i \Psi Z_{i}^{T}\)</span>, and a within-subject
component, given by <span class="math inline">\(\Lambda_i\)</span>. When
fitting such models, there will generally be a “competition” and
trade-off between the complexities of the two components, and care must
be exercised to prevent nonidentifiability, or near nonidentifiability,
of the parameters. This is one of the reasons why it can be advantageous
in practice to use only one of these components as long as it still
allows to capture all relevant sources of variability. In longitudinal
studies with only one level of grouping, the within-subject component is
particularly important to be considered in order to account for
within-subject correlation, whereas an additional random-effects
component is often not strictly needed.</p>
<p>Of note, in the literature, the random-effects component and the
within-subject component are sometimes also referred to as <span class="math inline">\(R\)</span> and <span class="math inline">\(G\)</span>, or as <span class="math inline">\(R\)</span>-side and <span class="math inline">\(G\)</span>-side random effects (<span class="citation">Cnaan, Laird, and Slasor (1997)</span>, <span class="citation">Littell, Pendergast, and Natarajan (2000)</span>).</p>
</div>
<div class="section level2">
<h2 id="the-mmrm-as-a-special-case">The MMRM as a special case<a class="anchor" aria-label="anchor" href="#the-mmrm-as-a-special-case"></a>
</h2>
<p>In a clinical trial setting, one often chooses to directly model the
variance-covariance structure of the response, i.e. to account for
within-subject dependencies using the within-group component <span class="math inline">\(\Lambda_i\)</span>, and can omit the random
effects component (<span class="math inline">\(Z_i b_i\)</span>). Hence,
in this case, <span class="math inline">\(\text{Var}(y_i)=\Sigma_i=\Lambda_i\)</span> . This
yields the MMRM with:</p>
<p><span class="math display">\[
     y_i = X_i\beta + \epsilon_i, \quad \epsilon_i \sim
\mathcal{N}(0,\Sigma_i), \quad i=1,\ldots,M.
\]</span></p>
<p>The <span class="math inline">\(\Sigma_i\)</span> matrices are
obtained by subsetting the overall variance-covariance matrix <span class="math inline">\(\Sigma \in \mathbb{R}^{m \times m}\)</span>, where
<span class="math inline">\(m\)</span> is the total number of scheduled
visits per subject, appropriately by <span class="math display">\[
     \Sigma_i = S_i^\top \Sigma S_i ,    
\]</span> where <span class="math inline">\(S_i \in \{0, 1\}^{m \times
m_i}\)</span> is the subject-specific ‘’subsetting matrix’’ that
indicates the visits with available observations (see also the vignette
on the Details of the Model Fitting in <code>mmrm</code>).</p>
<p>When written as a model for all <span class="math inline">\(n\)</span> subjects in a trial, the MMRM is
represented by <span class="math display">\[
Y = X\beta + \epsilon,
\]</span> where <span class="math inline">\(Y \in \mathbb{R}^N\)</span>
combines all subject-specific observations <span class="math inline">\(y_i\)</span> such that in total there are <span class="math inline">\(N = \sum_{i = 1}^{n}{m_i}\)</span> observations,
<span class="math inline">\(X \in \mathbb{R}^{N \times p}\)</span>
combines all subject-specific design matrices, <span class="math inline">\(\beta \in \mathbb{R}^p\)</span> is a vector of
fixed effects, and <span class="math inline">\(\epsilon \in
\mathbb{R}^N\)</span> has a multivariate normal distribution, <span class="math display">\[
\epsilon \sim N(0, \Omega),
\]</span> with <span class="math inline">\(\Omega \in \mathbb{R}^{N
\times N}\)</span> being a block-diagonal matrix, containing the
subject-specific <span class="math inline">\(\Sigma_i\)</span> on the
diagonal (and with all other entries being equal to <span class="math inline">\(0\)</span>).</p>
<p>When modeling longitudinal responses in a clinical trial with
multiple follow-up visits, the linear predictor <span class="math inline">\(X\beta\)</span> typically considers fixed effects
of baseline values, treatment and visit, as well as interactions between
treatment and visit, and possibly between baseline and visit. Commonly
the fixed effects are of most interest and the correlation structure
<span class="math inline">\(\Sigma\)</span> can be viewed as a nuisance
quantity. However, it is important to model it carefully, since it
affects validity of the estimated variance of <span class="math inline">\(\beta\)</span>. The <code>mmrm</code> package
supports a wide range of covariance structures (see also the vignette on
Covariance Structures in <code>mmrm</code>).</p>
</div>
<div class="section level2">
<h2 id="missing-data">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h2>
<p>Mixed models can accommodate unbalanced data and use all available
observations and subjects in the analysis. Inferences are valid under
the assumption that missing observations are independent of unobserved
data, but may be dependent on observed data. This assumption that is
often seen as reasonable and is called “missing at random”-assumption.
By contrast, some imputation methods to handle missing data and modeling
alternatives, such as the last-observation carried forward-approach or
models based on generalized estimating equations, require stricter
assumptions on missingness mechanism (<span class="citation">C. H.
Mallinckrodt et al. (2008)</span>, <span class="citation">Fitzmaurice
(2016)</span>).</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Cnaan1997" class="csl-entry">
Cnaan, A., N. M. Laird, and P. Slasor. 1997. <span>“<span class="nocase"><span>U</span>sing the general linear mixed model to
analyse unbalanced repeated measures and longitudinal
data</span>.”</span> <em>Stat Med</em> 16 (20): 2349–80.
</div>
<div id="ref-Fitzmaurice2016" class="csl-entry">
Fitzmaurice, Garrett M. 2016. <span>“<span>G</span>eneralized
<span>E</span>stimating <span>E</span>quations.”</span> In
<em><span>W</span>iley <span>S</span>tats<span>R</span>ef:
<span>S</span>tatistics <span>R</span>eference <span>O</span>nline</em>,
1–4. John Wiley &amp; Sons, Ltd.
</div>
<div id="ref-Laird1982" class="csl-entry">
Laird, N. M., and J. H. Ware. 1982. <span>“<span class="nocase"><span>R</span>andom-effects models for longitudinal
data</span>.”</span> <em>Biometrics</em> 38 (4): 963–74.
</div>
<div id="ref-Littell2000" class="csl-entry">
Littell, R. C., J. Pendergast, and R. Natarajan. 2000. <span>“<span class="nocase"><span>M</span>odelling covariance structure in the
analysis of repeated measures data</span>.”</span> <em>Stat Med</em> 19
(13): 1793–1819.
</div>
<div id="ref-Mallinckrodt2008" class="csl-entry">
Mallinckrodt, Craig H., Peter W. Lane, Dan Schnell, Yahong Peng, and
James P. Mancuso. 2008. <span>“<span>R</span>ecommendations for the
<span>P</span>rimary <span>A</span>nalysis of <span>C</span>ontinuous
<span>E</span>ndpoints in <span>L</span>ongitudinal
<span>C</span>linical <span>T</span>rials.”</span> <em>Drug Inf J</em>
42 (4): 303–19.
</div>
<div id="ref-Mallinckrodt2017" class="csl-entry">
Mallinckrodt, Craig, and Ilya Lipkovich. 2017.
<em><span>A</span>nalyzing <span>L</span>ongitudinal
<span>C</span>linical <span>T</span>rial <span>D</span>ata.
<span>A</span> <span>P</span>ractical <span>G</span>uide.</em> Chapman
&amp; Hall/ CRC Biostatistics Series.
</div>
<div id="ref-Pinheiro2000" class="csl-entry">
Pinheiro, José, and Douglas M. Bates. 2000.
<em><span>M</span>ixed-<span>E</span>ffects <span>M</span>odels in
<span>S</span> and <span>S-PLUS</span></em>. Springer (Statistics;
Computing).
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Daniel Sabanes Bove, Julia Dedic, Doug Kelkhoff, Kevin Kunzmann, Brian Matthew Lang, Liming Li, Christian Stock, Ya Wang, Dan James, Boehringer Ingelheim Ltd., Gilead Sciences, Inc., F. Hoffmann-La Roche AG, Merck Sharp &amp; Dohme, Inc., AstraZeneca plc.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
