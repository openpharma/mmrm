<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • mmrm</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"><meta property="og:image" content="https://openpharma.github.io/mmrm/logo.svg"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.16</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Package Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/methodological_introduction.html">Mixed Models for Repeated Measures</a></li>
    <li><a class="dropdown-item" href="../articles/mmrm_review_methods.html">Comparison with other software</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Covariance Structures</h6></li>
    <li><a class="dropdown-item" href="../articles/covariance.html">Covariance Structures</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Degrees of Freedom and Testing</h6></li>
    <li><a class="dropdown-item" href="../articles/hypothesis_testing.html">Details of Hypothesis Testing</a></li>
    <li><a class="dropdown-item" href="../articles/between_within.html">Between-Within</a></li>
    <li><a class="dropdown-item" href="../articles/kenward.html">Kenward-Roger</a></li>
    <li><a class="dropdown-item" href="../articles/satterthwaite.html">Satterthwaite</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Coefficient Covariance</h6></li>
    <li><a class="dropdown-item" href="../articles/coef_vcov.html">Coefficients Covariance Matrix Adjustment</a></li>
    <li><a class="dropdown-item" href="../articles/empirical_wls.html">Details of Weighted Least Square Empirical Covariance</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Algorithm Details</h6></li>
    <li><a class="dropdown-item" href="../articles/algorithm.html">Model Fitting Algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/predict.html">Prediction and Simulation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developers</h6></li>
    <li><a class="dropdown-item" href="../articles/package_structure.html">Package Structure</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reports" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reports</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reports"><li><a class="dropdown-item" href="../coverage-report/">Coverage report</a></li>
    <li><a class="dropdown-item" href="../unit-test-report/">Unit test report</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/mmrm"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Changelog</h1>
      <small>Source: <a href="https://github.com/openpharma/mmrm/blob/main/NEWS.md" class="external-link"><code>NEWS.md</code></a></small>
    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.16" id="mmrm-0316">mmrm 0.3.16<a class="anchor" aria-label="anchor" href="#mmrm-0316"></a></h2>
<div class="section level4">
<h4 id="new-features-0-3-16">New Features<a class="anchor" aria-label="anchor" href="#new-features-0-3-16"></a></h4>
<ul><li>
<code><a href="../reference/Anova.mmrm.html">Anova.mmrm()</a></code> now has a <code>test.statistic</code> argument allowing the user to choose the Chi-squared test as opposed to the default F-test.</li>
<li>
<code><a href="../reference/mmrm_control.html">mmrm_control()</a></code> now has a <code>disable_theta_vcov</code> argument allowing the user to disable computation of the variance-covariance matrix of the covariance parameters. In that case, the <code>nlminb</code> optimizer cannot be used and other optimizers should be selected. Avoiding this computation can be useful in cases where the number of covariance parameters is large and computation of this very large matrix is slow and memory-intensive.</li>
<li>
<code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame()</a></code> has a new argument <code>exclude</code> which allows to exclude specific model variables from the returned data frame, <em>after</em> creating the initial <code>model.frame</code>. This is useful when the same rows should be kept as in the original model fit (e.g. after <code>na.action</code> has been applied), but some variables are not needed in the returned data frame. The <code>terms</code> attribute of the returned data frame is updated accordingly.</li>
</ul></div>
<div class="section level4">
<h4 id="bug-fixes-0-3-16">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-3-16"></a></h4>
<ul><li>Previously, the compound symmetry correlation models (<code>cs</code> and <code>csh</code>) could have divergence issues, especially when the correlation was negative. This was because the range of the correlation parameter was from -1 to 1, whereas the correct range is between -1/(m-1) and 1, where m is the number of observations per subject. This is fixed now by using another mapping from the real line to the correct range, and therefore compound symmetry correlation models will work more robustly.</li>
<li>Previously, the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method failed when requesting an unconditional prediction interval. This is fixed now.</li>
<li>Previously, the <code><a href="../reference/emp_start.html">emp_start()</a></code> starting values could only work with variables included directly in <code>data</code>. Now they can also work when variables are not included in <code>data</code> but are available in the parent environment: The variables will be correctly included in the design matrix. This is achieved by an internal update to <code><a href="../reference/h_mmrm_tmb_data.html">h_mmrm_tmb_data()</a></code>.</li>
<li>Previously, the <code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame()</a></code> method failed when the model formula included variables from the environment. This is fixed now. In addition, whereas <code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame()</a></code> used to apply <code>na.action</code> before processing the <code>include</code> argument, <code>na.action</code> is now applied afterwards. As a result, any variables excluded from <code>include</code> are no longer considered when <code>na.action</code> is applied. Therefore, in the default case when <code>na.action = "na.omit"</code>, this can lead to more rows being kept in the returned data frame compared to previous versions.</li>
<li>Previously, the <code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame()</a></code> method did not pass on additional arguments to the <code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame.default()</a></code> method, e.g. <code>subset</code>. This is fixed now.</li>
<li>Previously, the <code><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov()</a></code> method returned the asymptotic covariance matrix, even if an adjusted one has been used. This is now fixed and the requested adjusted covariance matrix will be returned. (Please note this was not an issue for downstream <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> or <code><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html" class="external-link">emmeans()</a></code> calls, where the adjusted covariance matrix was correctly used.)</li>
<li>Previously, type 3 tests in the <code><a href="../reference/Anova.mmrm.html">Anova.mmrm()</a></code> method could give incorrect results which were not compatible with results from <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer()</a></code> or other software (e.g. when using other than treatment contrasts). This is fixed now. In particular, any combination of contrasts can be used and will yield consistent results.</li>
<li>
<code><a href="../reference/Anova.mmrm.html">Anova.mmrm()</a></code> can now handle intercept-free models in type 2 tests, even when the first effect containing a categorical variable has an aliased parameter.</li>
<li>Previously, the naming conventions used in the <code><a href="../reference/Anova.mmrm.html">Anova.mmrm()</a></code> method were not recognized by <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">broom::tidy()</a></code>. This is fixed now by using more standard names for the resulting data frame columns (e.g. <code>F</code> instead of <code>F Statistic</code> etc.)</li>
<li>
<code><a href="../reference/mmrm_tmb_methods.html">logLik.mmrm_tmb()</a></code> now includes an <code>nobs</code> attribute containing the number of subjects in the provided model (i.e., <code>component(mmrm_object, "n_subjects")</code>). As a result, <code>BIC(logLik(mmrm_object))</code> can now be successfully calculated.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.15" id="mmrm-0315">mmrm 0.3.15<a class="anchor" aria-label="anchor" href="#mmrm-0315"></a></h2><p class="text-muted">CRAN release: 2025-06-10</p>
<div class="section level4">
<h4 id="new-features-0-3-15">New Features<a class="anchor" aria-label="anchor" href="#new-features-0-3-15"></a></h4>
<ul><li>
<code>mmrm</code> now returns score per subject in empirical covariance. It can be accessed by <code>component(obj, name = "score_per_subject")</code>.</li>
</ul></div>
<div class="section level4">
<h4 id="bug-fixes-0-3-15">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-3-15"></a></h4>
<ul><li>Previously, when fitting a model with empirical covariance matrix estimation to a data set with a large number of subjects and/or a large number of coefficients, the model fitting could take very long and exhaust the memory in the worst case. This was due to an inefficient implementation of a matrix needed only in case of Satterthwaite degrees of freedom adjustment. This is fixed now, by returning the matrix <code>empirical_g_mat</code> in the <code>mmrm</code> object, instead of the previous <code>empirical_df_mat</code> matrix. The model fit is now much faster and does not exhaust the memory anymore. If old model fit objects are used, the <code>empirical_df_mat</code> will still be used correctly, however a deprecation warning will be issued. Please consider re-fitting the model to get the new <code>empirical_g_mat</code> matrix.</li>
<li>Previously, when compiling <code>mmrm</code> from source using a <code>TMB</code> version below 1.9.15, and installing a newer <code>TMB</code> of version 1.9.15 or above, would render the <code>mmrm</code> package unusable. This is fixed now, by checking in the dynamic library of <code>mmrm</code> whether the version of <code>TMB</code> has been sufficient.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.14" id="mmrm-0314">mmrm 0.3.14<a class="anchor" aria-label="anchor" href="#mmrm-0314"></a></h2><p class="text-muted">CRAN release: 2024-09-27</p>
<div class="section level4">
<h4 id="bug-fixes-0-3-14">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-3-14"></a></h4>
<ul><li>In version 0.3.13, when the tape optimizer from <code>TMB</code> was switched on, a warning would be given by <code><a href="../reference/fit_mmrm.html">fit_mmrm()</a></code>, instructing users to turn off the tape optimizer. However, this is not necessary for reproducible results. Instead, it is now checked whether the deterministic hash for the <code>TMB</code> tape optimizer is used, and a warning is issued otherwise.</li>
<li>In version 0.3.13, the above described warning by <code><a href="../reference/fit_mmrm.html">fit_mmrm()</a></code> was not visible to the user when calling <code><a href="../reference/mmrm.html">mmrm()</a></code> because it was caught internally, causing the first fit in each session to fail for the first tried optimizer and falling back to the other optimizers. The warning is now issued directly by <code><a href="../reference/mmrm.html">mmrm()</a></code>. This change ensures that the first model fit is consistent regarding the chosen optimizer (and thus numeric results) with subsequent model fits, avoiding discrepancies observed in version 0.3.13.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.13" id="mmrm-0313">mmrm 0.3.13<a class="anchor" aria-label="anchor" href="#mmrm-0313"></a></h2><p class="text-muted">CRAN release: 2024-09-23</p>
<div class="section level4">
<h4 id="bug-fixes-0-3-13">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-3-13"></a></h4>
<ul><li>When running with <code>TMB</code> package versions below 1.9.15, MMRM fit results are not completely reproducible. While this may not be relevant for most applications, because the numerical differences are very small, we now issue a warning to the user if this is the case. We advise users to upgrade their <code>TMB</code> package versions to 1.9.15 or higher to ensure reproducibility.</li>
<li>Previously, <code>mmrm</code> ignored contrasts defined for covariates in the input data set. This is fixed now.</li>
<li>Previously, <code>predict</code> always required the response to be valid, even for unconditional predictions. This is fixed now and unconditional prediction does not require the response to be valid or present any longer.</li>
<li>
<code>model.frame</code> has been updated to ensure that the <code>na.action</code> works correctly.</li>
<li>Previously <code><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html" class="external-link">emmeans::emmeans</a></code> returned <code>NA</code> for spatial covariance structures. This is fixed now.</li>
<li>Previously <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova</a></code> gave incorrect results if an interaction term is included and the covariate of interest was not the first categorical variable. This is fixed now.</li>
<li>Previously <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova</a></code> failed if the model did not contain an intercept. This is fixed now.</li>
</ul></div>
<div class="section level4">
<h4 id="miscellaneous-0-3-13">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous-0-3-13"></a></h4>
<ul><li>Upon fitting an MMRM, it is checked whether a not reproducible optimization feature of <code>TMB</code> is turned on. If so, a warning is issued to the user once per session.</li>
<li>
<code>mmrm</code> now checks on the positive definiteness of the covariance matrix <code>theta_vcov</code>. If it is not positive definite, non-convergence is messaged appropriately.</li>
<li>
<code>model.matrix</code> has been updated to ensure that the <code>NA</code> values are dropped. Additionally, an argument <code>use_response</code> is added to decide whether records with <code>NA</code> values in the response should be discarded.</li>
<li>
<code>predict</code> has been updated to allow duplicated subject IDs for unconditional prediction.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.12" id="mmrm-0312">mmrm 0.3.12<a class="anchor" aria-label="anchor" href="#mmrm-0312"></a></h2><p class="text-muted">CRAN release: 2024-06-26</p>
<div class="section level4">
<h4 id="new-features-0-3-12">New Features<a class="anchor" aria-label="anchor" href="#new-features-0-3-12"></a></h4>
<ul><li>Add parameter <code>conditional</code> for <code>predict</code> method to control whether the prediction is conditional on the observation or not.</li>
</ul></div>
<div class="section level4">
<h4 id="bug-fixes-0-3-12">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-3-12"></a></h4>
<ul><li>Previously if the left hand side of a model formula is an expression, <code>predict</code> and <code>simulate</code> will fail. This is fixed now.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.11" id="mmrm-0311">mmrm 0.3.11<a class="anchor" aria-label="anchor" href="#mmrm-0311"></a></h2><p class="text-muted">CRAN release: 2024-03-05</p>
<div class="section level4">
<h4 id="bug-fixes-0-3-11">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-3-11"></a></h4>
<ul><li>Previously if a secondary optimizer fails <code>mmrm</code> will fail. This is fixed now.</li>
<li>Previously character covariate variables will make <code>Anova</code> fail. This is fixed now.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.10" id="mmrm-0310">mmrm 0.3.10<a class="anchor" aria-label="anchor" href="#mmrm-0310"></a></h2><p class="text-muted">CRAN release: 2024-01-26</p>
<div class="section level4">
<h4 id="miscellaneous-0-3-10">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous-0-3-10"></a></h4>
<ul><li>Fix internal test skipping functions for MacOS R.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.9" id="mmrm-039">mmrm 0.3.9<a class="anchor" aria-label="anchor" href="#mmrm-039"></a></h2><p class="text-muted">CRAN release: 2024-01-25</p>
<div class="section level4">
<h4 id="miscellaneous-0-3-9">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous-0-3-9"></a></h4>
<ul><li>Fix internal test skipping functions for R versions older than 4.3.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.8" id="mmrm-038">mmrm 0.3.8<a class="anchor" aria-label="anchor" href="#mmrm-038"></a></h2><p class="text-muted">CRAN release: 2024-01-24</p>
<div class="section level4">
<h4 id="new-features-0-3-8">New Features<a class="anchor" aria-label="anchor" href="#new-features-0-3-8"></a></h4>
<ul><li>
<code>Anova</code> is implemented for <code>mmrm</code> models and available upon loading the <code>car</code> package. It supports type II and III hypothesis testing.</li>
<li>The argument <code>start</code> for <code><a href="../reference/mmrm_control.html">mmrm_control()</a></code> is updated to allow better choices of initial values.</li>
<li>
<code>confint</code> on <code>mmrm</code> models will give t-based confidence intervals now, instead of the normal approximation.</li>
</ul></div>
<div class="section level4">
<h4 id="bug-fixes-0-3-8">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-3-8"></a></h4>
<ul><li>Previously if the first optimizer failed, the best successful fit among the remaining optimizers was not returned correctly. This is fixed now.</li>
</ul></div>
<div class="section level4">
<h4 id="miscellaneous-0-3-8">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous-0-3-8"></a></h4>
<ul><li>In documentation of <code><a href="../reference/mmrm_control.html">mmrm_control()</a></code>, the allowed <code>vcov</code> definition is corrected to “Empirical-Jackknife” (CR3), and “Empirical-Bias-Reduced” (CR2).</li>
<li>Fixed a compiler warning related to missing format specification.</li>
<li>If an empty contrast matrix is provided to <code>df_md</code>, it will return statistics with <code>NA</code> values.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.7" id="mmrm-037">mmrm 0.3.7<a class="anchor" aria-label="anchor" href="#mmrm-037"></a></h2><p class="text-muted">CRAN release: 2023-12-08</p>
<div class="section level4">
<h4 id="new-features-0-3-7">New Features<a class="anchor" aria-label="anchor" href="#new-features-0-3-7"></a></h4>
<ul><li>The argument <code>method</code> of <code><a href="../reference/mmrm.html">mmrm()</a></code> now only specifies the method used for the degrees of freedom adjustment.</li>
<li>Add empirical, empirical Jackknife and empirical bias-reduced adjusted coefficients covariance estimates, which can be specified via the new <code>vcov</code> argument of <code><a href="../reference/mmrm.html">mmrm()</a></code>.</li>
<li>Add residual and between-within degrees of freedom methods.</li>
<li>Add Kenward-Roger support for spatial covariance structures.</li>
<li>Add <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code> and <code><a href="https://rdrr.io/r/stats/terms.html" class="external-link">terms()</a></code> methods to assist in post-processing.</li>
<li>Add <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method to obtain conditional mean estimates and prediction intervals.</li>
<li>Add <code><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate()</a></code> method to simulate observations from the predictive distribution.</li>
<li>Add <code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals()</a></code> method to obtain raw, Pearson or normalized residuals.</li>
<li>Add <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>, <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> and <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code> methods to tidy the fit results into summary tables.</li>
<li>Add <code>tidymodels</code> framework support via a <code>parsnip</code> interface.</li>
<li>Add argument <code>covariance</code> to <code><a href="../reference/mmrm.html">mmrm()</a></code> to allow for easier programmatic access to specifying the model’s covariance structure and to expose covariance customization through the <code>tidymodels</code> interface.</li>
</ul></div>
<div class="section level4">
<h4 id="bug-fixes-0-3-7">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-3-7"></a></h4>
<ul><li>Previously <code><a href="../reference/mmrm.html">mmrm()</a></code> follows the global option <code>na.action</code> and if it is set other than <code>"na.omit"</code> an assertion would fail. This is now fixed and hence <code>NA</code> values are always removed prior to model fitting, independent of the global <code>na.action</code> option.</li>
<li>Previously a <code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame()</a></code> call on an <code>mmrm</code> object with transformed terms, or new data, e.g. <code>model.frame(mmrm(Y ~ log(X) + ar1(VISIT|ID), data = new_data)</code>, would fail. This is now fixed.</li>
<li>Previously <code><a href="../reference/mmrm.html">mmrm()</a></code> always required a <code>data</code> argument. Now fitting <code>mmrm</code> can also use environment variables instead of requiring <code>data</code> argument. (Note that <code>fit_mmrm</code> is not affected.)</li>
<li>Previously <code><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html" class="external-link">emmeans()</a></code> failed when using transformed terms or not including the visit variable in the model formula. This is now fixed.</li>
<li>Previously <code><a href="../reference/mmrm.html">mmrm()</a></code> might provide non-finite values in the Jacobian calculations, leading to errors in the Satterthwaite degrees of freedom calculations. This will raise an error now and thus alert the user that the model fit was not successful.</li>
</ul></div>
<div class="section level4">
<h4 id="miscellaneous-0-3-7">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous-0-3-7"></a></h4>
<ul><li>Use automatic differentiation to calculate Satterthwaite adjusted degrees of freedom, resulting in 10-fold speed-up of the Satterthwaite calculations after the initial model fit.</li>
<li>Add an interactive confirmation step if the number of visit levels is too large for non-spatial covariance structures. Use <code>options(mmrm.max_visits = )</code> to specify the maximum number of visits allowed in non-interactive mode.</li>
<li>Removed <code>free_cores()</code> in favor of <code>parallelly::availableCores(omit = 1)</code>.</li>
<li>The <code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame()</a></code> method has been updated: The <code>full</code> argument is deprecated and the <code>include</code> argument can be used instead; by default all relevant variables are returned. Furthermore, it returns a <code>data.frame</code> the size of the number of observations utilized in the model for all combinations of the <code>include</code> argument when <code>na.action= "na.omit"</code>.</li>
<li>Overall, seven vignettes have been added to the package. All vignettes have a slightly different look now to reduce the size of the overall R package on CRAN.</li>
<li>The used optimizer is now available via <code>component(., "optimizer")</code> instead of previously <code>attr(., "optimizer")</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.2" id="mmrm-022">mmrm 0.2.2<a class="anchor" aria-label="anchor" href="#mmrm-022"></a></h2><p class="text-muted">CRAN release: 2022-12-20</p>
<div class="section level4">
<h4 id="new-features-0-2-2">New Features<a class="anchor" aria-label="anchor" href="#new-features-0-2-2"></a></h4>
<ul><li>Add support for Kenward-Roger adjusted coefficients covariance matrix and degrees of freedom in <code>mmrm</code> function call with argument <code>method</code>. Options are “Kenward-Roger”, “Kenward-Roger-Linear” and “Satterthwaite” (which is still the default). Subsequent methods calls will respect this initial choice, e.g. <code>vcov(fit)</code> will return the adjusted coefficients covariance matrix if a Kenward-Roger method has been used.</li>
<li>Update the <code>mmrm</code> arguments to allow users more fine-grained control, e.g. <code>mmrm(..., start = start, optimizer = c("BFGS", "nlminb"))</code> to set the starting values for the variance estimates and to choose the available optimizers. These arguments will be passed to the new function <code>mmrm_control</code>.</li>
<li>Add new argument <code>drop_visit_levels</code> to allow users to keep all levels in visits, even when they are not observed in the data. Dropping unobserved levels was done silently previously, and now a message will be given. See <code><a href="../reference/mmrm_control.html">?mmrm_control</a></code> for more details.</li>
</ul></div>
<div class="section level4">
<h4 id="bug-fixes-0-2-2">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-2-2"></a></h4>
<ul><li>Previously duplicate time points could be present for a single subject, and this could lead to segmentation faults if more than the total number of unique time points were available for any subject. Now it is checked that there are no duplicate time points per subject, and this is explained also in the function documentation and the introduction vignette.</li>
<li>Previously in <code>mmrm</code> calls, the <code>weights</code> object in the environment where the formula is defined was replaced by the <code>weights</code> used internally. Now this behavior is removed and your variable <code>weights</code> e.g. in the global environment will no longer be replaced.</li>
</ul></div>
<div class="section level4">
<h4 id="miscellaneous-0-2-2">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous-0-2-2"></a></h4>
<ul><li>Deprecated <code>free_cores()</code> in favor of <code>parallelly::availableCores(omit = 1)</code>.</li>
<li>Deprecated <code>optimizer = "automatic"</code> in favor of not specifying the <code>optimizer</code>. By default, all remaining optimizers will be tried if the first optimizer fails to reach convergence.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.5" id="mmrm-015">mmrm 0.1.5<a class="anchor" aria-label="anchor" href="#mmrm-015"></a></h2><p class="text-muted">CRAN release: 2022-10-18</p>
<ul><li>First CRAN version of the package.</li>
<li>The package fits mixed models for repeated measures (MMRM) based on the marginal linear model without random effects.</li>
<li>The motivation for this package is to have a fast, reliable (in terms of convergence behavior) and feature complete implementation of MMRM in R.</li>
</ul><div class="section level4">
<h4 id="new-features-0-1-5">New Features<a class="anchor" aria-label="anchor" href="#new-features-0-1-5"></a></h4>
<ul><li>Currently 10 covariance structures are supported (unstructured; as well as homogeneous and heterogeneous versions of Toeplitz, auto-regressive order one, ante-dependence, compound symmetry; and spatial exponential).</li>
<li>Fast C++ implementation of Maximum Likelihood (ML) and Restricted Maximum Likelihood (REML) estimation.</li>
<li>Currently Satterthwaite adjusted degrees of freedom calculation is supported.</li>
<li>Interface to the <code>emmeans</code> package for computing estimated marginal means (also called least-square means) for the coefficients.</li>
<li>Multiple optimizers are run to reach convergence in as many cases as possible.</li>
<li>Flexible formula based model specification and support for standard S3 methods such as <code>summary</code>, <code>logLik</code>, etc.</li>
</ul></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Sabanes Bove, Liming Li, Julia Dedic, Doug Kelkhoff, Kevin Kunzmann, Brian Matthew Lang, Christian Stock, Ya Wang, Dan James, Jonathan Sidi, Daniel Leibovitz, Daniel D. Sjoberg, Nikolas Ivan Krieger, Boehringer Ingelheim Ltd., Gilead Sciences, Inc., F. Hoffmann-La Roche AG, Merck Sharp &amp; Dohme, Inc., AstraZeneca plc, inferential.biostatistics GmbH.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

