<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Analysis of Variance for mmrm Fits — stats_anova • mmrm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of Variance for mmrm Fits — stats_anova"><meta name="description" content="If supplied only one model fit, the function will calculate and return the
significance of the model terms. If supplied more than one model fit,
standard diagnostics will be returned for each model, optionally including
likelihood ratio test (LRT) results for adjacent models."><meta property="og:description" content="If supplied only one model fit, the function will calculate and return the
significance of the model terms. If supplied more than one model fit,
standard diagnostics will be returned for each model, optionally including
likelihood ratio test (LRT) results for adjacent models."><meta property="og:image" content="https://openpharma.github.io/mmrm/logo.svg"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.15.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Package Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/methodological_introduction.html">Mixed Models for Repeated Measures</a></li>
    <li><a class="dropdown-item" href="../articles/mmrm_review_methods.html">Comparison with other software</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Covariance Structures</h6></li>
    <li><a class="dropdown-item" href="../articles/covariance.html">Covariance Structures</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Degrees of Freedom and Testing</h6></li>
    <li><a class="dropdown-item" href="../articles/hypothesis_testing.html">Details of Hypothesis Testing</a></li>
    <li><a class="dropdown-item" href="../articles/between_within.html">Between-Within</a></li>
    <li><a class="dropdown-item" href="../articles/kenward.html">Kenward-Roger</a></li>
    <li><a class="dropdown-item" href="../articles/satterthwaite.html">Satterthwaite</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Coefficient Covariance</h6></li>
    <li><a class="dropdown-item" href="../articles/coef_vcov.html">Coefficients Covariance Matrix Adjustment</a></li>
    <li><a class="dropdown-item" href="../articles/empirical_wls.html">Details of Weighted Least Square Empirical Covariance</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Algorithm Details</h6></li>
    <li><a class="dropdown-item" href="../articles/algorithm.html">Model Fitting Algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/predict.html">Prediction and Simulation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developers</h6></li>
    <li><a class="dropdown-item" href="../articles/package_structure.html">Package Structure</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reports" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reports</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reports"><li><a class="dropdown-item" href="../coverage-report/">Coverage report</a></li>
    <li><a class="dropdown-item" href="../unit-test-report/">Unit test report</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/mmrm"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Analysis of Variance for <code>mmrm</code> Fits</h1>
      <small class="dont-index">Source: <a href="https://github.com/openpharma/mmrm/blob/main/R/mmrm-methods.R" class="external-link"><code>R/mmrm-methods.R</code></a></small>
      <div class="d-none name"><code>stats_anova.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>If supplied only one model fit, the function will calculate and return the
significance of the model terms. If supplied more than one model fit,
standard diagnostics will be returned for each model, optionally including
likelihood ratio test (LRT) results for adjacent models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'mmrm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, test <span class="op">=</span> <span class="cn">TRUE</span>, refit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>(<code>mmrm</code>)<br> an <code>mmrm</code> model fit.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>(<code>mmrm</code>)<br> optional <code>mmrm</code> model fits. If left empty, the
significance of each term in <code>object</code> will be calculated.</p></dd>


<dt id="arg-test">test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>(<code>flag</code>)<br> indicating whether the output should include
likelihood ratio test (LRT) results comparing the model fits to one
another. Defaults to <code>TRUE</code>. Ignored if <code>...</code> is empty.</p></dd>


<dt id="arg-refit">refit<a class="anchor" aria-label="anchor" href="#arg-refit"></a></dt>
<dd><p>(<code>flag</code>)<br> indicating whether the models should be refitted
with the dataset consisting of their shared set of observations before
performing diagnostics and testing. This is ignored if the models already
share the same dataset. If <code>refit = FALSE</code> and the models have different
underlying data sets, an error will be thrown. Defaults to <code>FALSE</code>. Ignored
if <code>...</code> is empty.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with a row for each supplied model. If <code>...</code> is empty,
this will be the the returned value of <code><a href="h_anova_single_mmrm_model.html">h_anova_single_mmrm_model()</a></code> with
<code>object</code> supplied as its argument. Otherwise, the resulting data frame will
have the following columns:</p><ul><li><p><code>Model</code>: the sequence number of the model according to the order in which
the models were supplied to this function.</p></li>
<li><p><code>refit</code>: logical, indicating whether or not the model was refitted. If
the <code>refit</code> argument was <code>FALSE</code>, all values will be <code>FALSE</code>.</p></li>
<li><p><code>REML</code>: logical, indicating whether or not the model was fitted using
restricted maximum likelihood (REML) estimation. If <code>FALSE</code>, the model was
fitted using maximum likelihood (ML) estimation.</p></li>
<li><p><code>n_param</code>: the number of variance parameters in the model fit, obtained
via <code><a href="mmrm_tmb_methods.html">logLik.mmrm_tmb()</a></code>.</p></li>
<li><p><code>n_coef</code>: the number of estimated coefficients in the model fit, obtained
via <code><a href="mmrm_tmb_methods.html">logLik.mmrm_tmb()</a></code>.</p></li>
<li><p><code>df</code>: degrees of freedom of the model fit, obtained via
<code><a href="mmrm_tmb_methods.html">logLik.mmrm_tmb()</a></code>.</p></li>
<li><p><code>AIC</code>: Akaike's "An Information Criterion" of the model fit, obtained via
<code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">stats::AIC()</a></code>.</p></li>
<li><p><code>BIC</code>: the Bayesian Information Criterion of the model fit, obtained via
<code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">stats::BIC()</a></code>.</p></li>
<li><p><code>logLik</code>: the log likelihood of the model fit, obtained via
<code><a href="mmrm_tmb_methods.html">logLik.mmrm_tmb()</a></code>.</p></li>
<li><p><code>call</code>: the <a href="https://rdrr.io/r/base/call.html" class="external-link">call</a> that created the model fit, obtained via <code><a href="component.html">component()</a></code>
with <code>name = "call"</code>, which is passed to <code><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse1()</a></code>. If the model was
refitted (i.e., if its <code>refit</code> entry in this table is <code>TRUE</code>), this <code>call</code>
will be different from the <code>call</code> component of the pre-refitted model fit.</p></li>
</ul><p>The data frame will have these additional columns inserted before <code>call</code> if
<code>test = TRUE</code>. Note that since each of these columns describe the results
of a likelihood ratio test (LRT) between the previous row's and current
row's model fits, the first element of each of these columns will be <code>NA</code>.</p><ul><li><p><code>test</code>: character, indicating which two model fits were compared. Values
are of the form <code>{Model - 1} vs {Model}</code>.</p></li>
<li><p><code>log_likelihood_ratio</code>: the logarithm of the likelihood ratio between the two
models being compared.</p></li>
<li><p><code>p_value</code>: the p-value of the <code>log_likelihood_ratio</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When <code>test = FALSE</code> (or, when only one model is supplied), this
function will process any <code>mmrm</code> fits, related or unrelated.</p>
<p>When supplying multiple models and <code>test = TRUE</code>, adjacent pairs of models
are tested sequentially. In other words, the order of the supplied models
matters. Furthermore, there are are multiple requirements for successful
LRT. See the section "Requirements for LRT" below.</p>
    </div>
    <div class="section level2">
    <h2 id="requirements-for-lrt">Requirements for LRT<a class="anchor" aria-label="anchor" href="#requirements-for-lrt"></a></h2>

<ol><li><p>Each supplied model fit must have more degrees of freedom than
the preceding model fit.</p></li>
<li><p>If all supplied models were estimated using maximum likelihood (ML), the
models must have nested covariates in order to undergo LRT. In other words,
the set of covariates for each model must be a subset of the covariates of
the next model. However, if any of the supplied models were estimated using
restricted maximum likelihood (REML), all models must have the same
covariates.</p></li>
<li><p>The covariance structure of each model must be either (a) the same as
that of the next model or (b) a special case of that of the next model. See
the section "Covariance structure nesting hierarchy" below.</p></li>
<li><p>All supplied model fits must either already use the same data or be
refitted using <code>refit = TRUE</code>, which refits all models to the dataset of
common observations between all models' respective data sets.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="covariance-structure-nesting-hierarchy">Covariance structure nesting hierarchy<a class="anchor" aria-label="anchor" href="#covariance-structure-nesting-hierarchy"></a></h2>

<div class="section">
<h3 id="structured-nests-within-unstructured">Structured nests within unstructured<a class="anchor" aria-label="anchor" href="#structured-nests-within-unstructured"></a></h3>


<p>Tautologically, all covariance structures are special cases of an
unstructured covariance, and a model <em>with</em> a covariance structure can be
considered "nested" within an model <em>without</em> a covariance structure
(assuming that the covariates are also nested).</p>
</div>

<div class="section">
<h3 id="homogeneous-nests-within-analogous-heterogeneous">Homogeneous nests within analogous heterogeneous<a class="anchor" aria-label="anchor" href="#homogeneous-nests-within-analogous-heterogeneous"></a></h3>


<p>All homogeneous covariance structures are nested within their corresponding
heterogeneous counterparts. For instance, the homogeneous Toeplitz
covariance structure is nested within the heterogeneous Toeplitz covariance
structure.</p>
</div>

<div class="section">
<h3 id="other-nested-structures">Other nested structures<a class="anchor" aria-label="anchor" href="#other-nested-structures"></a></h3>


<p>Some different covariance structure types are also nested:</p><ul><li><p>First-order auto-regressive (<code>ar1</code> / <code>ar1h</code>) is nested within:</p><ul><li><p>ante-dependence (<code>ad</code> / <code>adh</code>)</p></li>
<li><p>Toeplitz (<code>toep</code> / <code>toeph</code>)</p></li>
</ul></li>
<li><p>Compound symmetry (<code>cs</code> / <code>csh</code>) is nested within Toeplitz (<code>toep</code> / <code>toeph</code>)</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For details on the single model operation of this function, see
<code><a href="h_anova_single_mmrm_model.html">h_anova_single_mmrm_model()</a></code>. For details on the generic, see
<code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">stats::anova()</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create a few model fits, only adding terms from one to the next.</span></span></span>
<span class="r-in"><span><span class="co"># Notice also that each covariance structure is a special case of the one</span></span></span>
<span class="r-in"><span><span class="co"># that follows.</span></span></span>
<span class="r-in"><span><span class="va">fit_sex_ar1</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="mmrm.html">mmrm</a></span><span class="op">(</span><span class="va">FEV1</span> <span class="op">~</span> <span class="va">FEV1_BL</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">+</span> <span class="fu">ar1</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">fev_data</span>,</span></span>
<span class="r-in"><span>    reml <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_sex_race_toeph</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="mmrm.html">mmrm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">FEV1</span> <span class="op">~</span> <span class="va">FEV1_BL</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">+</span> <span class="fu">toeph</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">fev_data</span>,</span></span>
<span class="r-in"><span>    reml <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_interaction_us</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="mmrm.html">mmrm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">FEV1</span> <span class="op">~</span> <span class="va">FEV1_BL</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">*</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">fev_data</span>,</span></span>
<span class="r-in"><span>    reml <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Single model fit, showing significance of model terms:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit_interaction_us</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             num_df denom_df      f_stat        p_val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)      1 169.7869 629.7216209 5.141580e-59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FEV1_BL          1 188.0191  33.1933418 3.359280e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEX              1 140.5733   0.3276806 5.679424e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RACE             2 157.7997  16.1012466 4.330465e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARMCD            1 159.9380  43.1828265 6.684586e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEX:RACE         2 157.9950   0.1999710 8.189614e-01</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple model fits, with diagnostics for each fit and likelihood ratio</span></span></span>
<span class="r-in"><span><span class="co"># testing (LRT) for each adjacent pair. LRT is possible because when the fits</span></span></span>
<span class="r-in"><span><span class="co"># are in this order, their covariates and covariance structures are nested.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit_sex_ar1</span>, <span class="va">fit_sex_race_toeph</span>, <span class="va">fit_interaction_us</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model refit  REML n_param n_coef df      AIC      BIC    logLik   test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1 FALSE FALSE       2      4  6 3849.846 3856.412 -1922.923   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2 FALSE FALSE       7      6 13 3634.468 3657.451 -1810.234 1 vs 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3 FALSE FALSE      10      8 18 3599.923 3632.755 -1789.961 2 vs 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   log_likelihood_ratio      p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                   NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            112.68862 1.046903e-46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             20.27281 9.895512e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                                                           call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          mmrm(formula = FEV1 ~ FEV1_BL + SEX + ARMCD + ar1(AVISIT | USUBJID), data = fev_data, reml = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 mmrm(formula = FEV1 ~ FEV1_BL + SEX + RACE + ARMCD + toeph(AVISIT | USUBJID), data = fev_data, reml = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    mmrm(formula = FEV1 ~ FEV1_BL + SEX * RACE + ARMCD + us(AVISIT | USUBJID), data = fev_data, reml = FALSE)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can only change the order if we forego LRT using test = FALSE.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit_sex_race_toeph</span>, <span class="va">fit_interaction_us</span>, <span class="va">fit_sex_ar1</span>, test <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model refit  REML n_param n_coef df      AIC      BIC    logLik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1 FALSE FALSE       7      6 13 3634.468 3657.451 -1810.234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2 FALSE FALSE      10      8 18 3599.923 3632.755 -1789.961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3 FALSE FALSE       2      4  6 3849.846 3856.412 -1922.923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                                                           call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 mmrm(formula = FEV1 ~ FEV1_BL + SEX + RACE + ARMCD + toeph(AVISIT | USUBJID), data = fev_data, reml = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    mmrm(formula = FEV1 ~ FEV1_BL + SEX * RACE + ARMCD + us(AVISIT | USUBJID), data = fev_data, reml = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          mmrm(formula = FEV1 ~ FEV1_BL + SEX + ARMCD + ar1(AVISIT | USUBJID), data = fev_data, reml = FALSE)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a subset of fev_data set with the 4th visit removed.</span></span></span>
<span class="r-in"><span><span class="va">fev_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="va">fev_data</span><span class="op">[</span><span class="va">fev_data</span><span class="op">$</span><span class="va">VISITN</span> <span class="op">&lt;</span> <span class="fl">4</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Recreate fit_sex_race_toeph but this time based off fev_subset:</span></span></span>
<span class="r-in"><span><span class="va">fit_sex_race_toeph_sub</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="mmrm.html">mmrm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">FEV1</span> <span class="op">~</span> <span class="va">FEV1_BL</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">+</span> <span class="fu">toeph</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">fev_subset</span>,</span></span>
<span class="r-in"><span>    reml <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If a model was created with a different data set, refit = TRUE is needed.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit_sex_ar1</span>, <span class="va">fit_sex_race_toeph_sub</span>, <span class="va">fit_interaction_us</span>, refit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model refit  REML n_param n_coef df      AIC      BIC    logLik   test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1  TRUE FALSE       2      4  6 2674.473 2680.988 -1335.236   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2 FALSE FALSE       5      6 11 2588.928 2605.216 -1289.464 1 vs 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3  TRUE FALSE       6      8 14 2569.429 2588.974 -1278.714 2 vs 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   log_likelihood_ratio      p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                   NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2             45.77211 1.020588e-19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             10.74981 6.515941e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                                                             call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              mmrm(formula = FEV1 ~ FEV1_BL + SEX + ARMCD + ar1(AVISIT | USUBJID), data = data.1, reml = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 mmrm(formula = FEV1 ~ FEV1_BL + SEX + RACE + ARMCD + toeph(AVISIT | USUBJID), data = fev_subset, reml = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        mmrm(formula = FEV1 ~ FEV1_BL + SEX * RACE + ARMCD + us(AVISIT | USUBJID), data = data.1, reml = FALSE)</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Sabanes Bove, Liming Li, Julia Dedic, Doug Kelkhoff, Kevin Kunzmann, Brian Matthew Lang, Christian Stock, Ya Wang, Dan James, Jonathan Sidi, Daniel Leibovitz, Daniel D. Sjoberg, Nikolas Ivan Krieger, Boehringer Ingelheim Ltd., Gilead Sciences, Inc., F. Hoffmann-La Roche AG, Merck Sharp &amp; Dohme, Inc., AstraZeneca plc, inferential.biostatistics GmbH.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

