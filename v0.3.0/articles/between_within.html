<!DOCTYPE html>
<!-- Generated by pkgdown + https://github.com/insightsengineering/r-pkgdown-multiversion -->
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mmrm">
<title>Between-Within • mmrm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Between-Within">
<meta property="og:description" content="mmrm">
<meta property="og:image" content="https://openpharma.github.io/mmrm/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Introduction</h6>
    <a class="dropdown-item" href="../articles/introduction.html">Package Introduction</a>
    <a class="dropdown-item" href="../articles/methodological_introduction.html">Mixed Models for Repeated Measures</a>
    <a class="dropdown-item" href="../articles/mmrm_review_methods.html">Comparison with other software</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Covariance Structures</h6>
    <a class="dropdown-item" href="../articles/covariance.html">Covariance Structures</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Degrees of Freedom</h6>
    <a class="dropdown-item" href="../articles/between_within.html">Between-Within</a>
    <a class="dropdown-item" href="../articles/kenward.html">Kenward-Roger</a>
    <a class="dropdown-item" href="../articles/satterthwaite.html">Satterthwaite</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Coefficient Covariance</h6>
    <a class="dropdown-item" href="../articles/coef_vcov.html">Coefficients Covariance Matrix Adjustment</a>
    <a class="dropdown-item" href="../articles/empirical_wls.html">Details of Weighted Least Square Empirical Covariance</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Algorithm Details</h6>
    <a class="dropdown-item" href="../articles/algorithm.html">Model Fitting Algorithm</a>
    <a class="dropdown-item" href="../articles/predict.html">Prediction and Simulation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Developers</h6>
    <a class="dropdown-item" href="../articles/package_structure.html">Package Structure</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<!-- start dropdown for versions --> <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.15">v0.3.15</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.14">v0.3.14</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.13">v0.3.13</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.12">v0.3.12</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.11">v0.3.11</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.10">v0.3.10</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.7">v0.3.7</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.6">v0.3.6</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.5">v0.3.5</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.4">v0.3.4</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.3">v0.3.3</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.2">v0.3.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.1">v0.3.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.3.0">v0.3.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/mmrm/v0.2.2">v0.2.2</a>
</div>
</li>
<!-- end dropdown for versions -->
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-reports">Reports</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-reports">
    <a class="dropdown-item" href="../coverage-report/">Coverage report</a>
    <a class="dropdown-item" href="../unit-test-report/">Unit test report</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/openpharma/mmrm">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Between-Within</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/mmrm/blob/HEAD/vignettes/between_within.Rmd" class="external-link"><code>vignettes/between_within.Rmd</code></a></small>
      <div class="d-none name"><code>between_within.Rmd</code></div>
    </div>

    
    
<p>For determining the degrees of freedom (DF) required for the testing
of fixed effects, one option is to use the “between-within” method,
originally proposed by <span class="citation">Schluchter and Elashoff
(1990)</span> as a small-sample adjustment.</p>
<div class="section level2">
<h2 id="general-definition">General definition<a class="anchor" aria-label="anchor" href="#general-definition"></a>
</h2>
<p>Using this method, the DF are determined by the grouping level at
which the term is estimated. Generally, assuming <span class="math inline">\(G\)</span> levels of grouping:</p>
<p><span class="math inline">\(DF_g=N_g-(N_{g-1}+p_g), g=1, ...,
G+1\)</span></p>
<p>where <span class="math inline">\(N_g\)</span> is the number of
groups at the <span class="math inline">\(g\)</span>-th grouping level
and <span class="math inline">\(p_g\)</span> is the number of parameters
estimated at that level.</p>
<p><span class="math inline">\(N_0=1\)</span> if the model includes an
intercept term and <span class="math inline">\(N_0=0\)</span> otherwise.
Note however that the DF for the intercept term itself (when it is
included) are calculated at the <span class="math inline">\(G+1\)</span>
level, i.e. for the intercept we use <span class="math inline">\(DF_{G+1}\)</span> degrees of freedom.</p>
<p>We note that general contrasts <span class="math inline">\(C\beta\)</span> have not been considered in the
literature so far. Here we therefore use a pragmatic approach and define
that for a general contrast matrix <span class="math inline">\(C\)</span> we take the minimum DF across the
involved coefficients as the DF.</p>
</div>
<div class="section level2">
<h2 id="mmrm-special-case">MMRM special case<a class="anchor" aria-label="anchor" href="#mmrm-special-case"></a>
</h2>
<p>In our case of an MMRM (with only fixed effect terms), there is only
a single grouping level (subject), so <span class="math inline">\(G=1\)</span>. This means there are 3 potential
“levels” of parameters (<span class="citation">Gałecki and Burzykowski
(2013)</span>):</p>
<ul>
<li>Level 0: The intercept term, assuming the model has been fitted with
one.
<ul>
<li>We use <span class="math inline">\(DF_2\)</span> degrees of freedom
as defined below.</li>
</ul>
</li>
<li>Level 1: Effects that change between subjects, but not across
observations within subjects.
<ul>
<li>These are the “between parameters”.</li>
<li>The corresponding degrees of freedom are <span class="math inline">\(DF_1 = N_1 - (N_0 + p_1)\)</span>.</li>
<li>In words this can be read as:<br>
“Between” DF = “number of subjects” - (“1 if intercept otherwise 0” +
“number of between parameters”).</li>
</ul>
</li>
<li>Level 2: Effects that change within subjects.
<ul>
<li>These are the “within parameters”.</li>
<li>The corresponding degrees of freedom are <span class="math inline">\(DF_2 = N_2 - (N_1 + p_2)\)</span>.</li>
<li>In words this can be read as:<br>
“Within” DF = “number of observations” - (“number of subjects” + “number
of within parameters”).</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Let’s look at a concrete example and what the “between-within”
degrees of freedom method gives as results:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrm.html">mmrm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">FEV1</span> <span class="op">~</span> <span class="va">RACE</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">ARMCD</span> <span class="op">*</span> <span class="va">AVISIT</span> <span class="op">+</span> <span class="fu">us</span><span class="op">(</span><span class="va">AVISIT</span> <span class="op">|</span> <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fev_data</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="../reference/mmrm_control.html">mmrm_control</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"Between-Within"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID)</span></span>
<span><span class="co">#&gt; Data:        fev_data (used 537 observations from 197 subjects with maximum 4 </span></span>
<span><span class="co">#&gt; timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  unstructured (10 variance parameters)</span></span>
<span><span class="co">#&gt; Method:      Between-Within</span></span>
<span><span class="co">#&gt; Vcov Method: Asymptotic</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model selection criteria:</span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance </span></span>
<span><span class="co">#&gt;   3406.4   3439.3  -1693.2   3386.4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                                Estimate Std. Error        df t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)                    30.77748    0.88656 334.00000  34.715  &lt; 2e-16</span></span>
<span><span class="co">#&gt; RACEBlack or African American   1.53050    0.62448 192.00000   2.451 0.015147</span></span>
<span><span class="co">#&gt; RACEWhite                       5.64357    0.66561 192.00000   8.479 5.98e-15</span></span>
<span><span class="co">#&gt; SEXFemale                       0.32606    0.53195 192.00000   0.613 0.540631</span></span>
<span><span class="co">#&gt; ARMCDTRT                        3.77423    1.07415 192.00000   3.514 0.000551</span></span>
<span><span class="co">#&gt; AVISITVIS2                      4.83959    0.80172 334.00000   6.037 4.19e-09</span></span>
<span><span class="co">#&gt; AVISITVIS3                     10.34211    0.82269 334.00000  12.571  &lt; 2e-16</span></span>
<span><span class="co">#&gt; AVISITVIS4                     15.05390    1.31281 334.00000  11.467  &lt; 2e-16</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS2            -0.04193    1.12932 334.00000  -0.037 0.970407</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS3            -0.69369    1.18765 334.00000  -0.584 0.559558</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS4             0.62423    1.85085 334.00000   0.337 0.736129</span></span>
<span><span class="co">#&gt;                                  </span></span>
<span><span class="co">#&gt; (Intercept)                   ***</span></span>
<span><span class="co">#&gt; RACEBlack or African American *  </span></span>
<span><span class="co">#&gt; RACEWhite                     ***</span></span>
<span><span class="co">#&gt; SEXFemale                        </span></span>
<span><span class="co">#&gt; ARMCDTRT                      ***</span></span>
<span><span class="co">#&gt; AVISITVIS2                    ***</span></span>
<span><span class="co">#&gt; AVISITVIS3                    ***</span></span>
<span><span class="co">#&gt; AVISITVIS4                    ***</span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS2              </span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS3              </span></span>
<span><span class="co">#&gt; ARMCDTRT:AVISITVIS4              </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariance estimate:</span></span>
<span><span class="co">#&gt;         VIS1    VIS2    VIS3    VIS4</span></span>
<span><span class="co">#&gt; VIS1 40.5537 14.3960  4.9747 13.3867</span></span>
<span><span class="co">#&gt; VIS2 14.3960 26.5715  2.7855  7.4745</span></span>
<span><span class="co">#&gt; VIS3  4.9747  2.7855 14.8979  0.9082</span></span>
<span><span class="co">#&gt; VIS4 13.3867  7.4745  0.9082 95.5568</span></span></code></pre></div>
<p>Let’s try to calculate the degrees of freedom manually now.</p>
<p>In <code>fev_data</code> there are 197 subjects with at least one
non-missing <code>FEV1</code> observation, and 537 non-missing
observations in total. Therefore we obtain the following numbers of
groups <span class="math inline">\(N_g\)</span> at the levels <span class="math inline">\(g=1,2\)</span>:</p>
<ul>
<li><span class="math inline">\(N_1 = 197\)</span></li>
<li><span class="math inline">\(N_2 = 537\)</span></li>
</ul>
<p>And we note that <span class="math inline">\(N_0 = 1\)</span> because
we use an intercept term.</p>
<p>Now let’s look at the design matrix:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   (Intercept) RACEBlack or African American RACEWhite SEXFemale ARMCDTRT</span></span>
<span><span class="co">#&gt; 2           1                             1         0         1        1</span></span>
<span><span class="co">#&gt;   AVISITVIS2 AVISITVIS3 AVISITVIS4 ARMCDTRT:AVISITVIS2 ARMCDTRT:AVISITVIS3</span></span>
<span><span class="co">#&gt; 2          1          0          0                   1                   0</span></span>
<span><span class="co">#&gt;   ARMCDTRT:AVISITVIS4</span></span>
<span><span class="co">#&gt; 2                   0</span></span></code></pre></div>
<p>Leaving the intercept term aside, we therefore have the following
number of parameters for the corresponding effects:</p>
<ul>
<li>
<code>RACE</code>: 2</li>
<li>
<code>SEX</code>: 1</li>
<li>
<code>ARMCD</code>: 1</li>
<li>
<code>AVISIT</code>: 3</li>
<li>
<code>ARMCD:AVISIT</code>: 3</li>
</ul>
<p>In the model above, <code>RACE</code>, <code>SEX</code> and
<code>ARMCD</code> are between-subjects effects and belong to level 1;
they do not vary within subject across the repeated observations. On the
other hand, <code>AVISIT</code> is a within-subject effect; it
represents study visit, so naturally its value changes over repeated
observations for each subject. Similarly, the interaction of
<code>ARMCD</code> and <code>AVISIT</code> also belongs to level 2.</p>
<p>Therefore we obtain the following numbers of parameters <span class="math inline">\(p_g\)</span> at the levels <span class="math inline">\(g=1,2\)</span>:</p>
<ul>
<li><span class="math inline">\(p_1 = 2 + 1 + 1 = 4\)</span></li>
<li><span class="math inline">\(p_2 = 3 + 3 = 6\)</span></li>
</ul>
<p>And we obtain therefore the degrees of freedom <span class="math inline">\(DF_g\)</span> at the levels <span class="math inline">\(g=1,2\)</span>:</p>
<ul>
<li><span class="math inline">\(DF_1 = N_1 - (N_0 + p_1) = 197 - (1 + 4)
= 192\)</span></li>
<li><span class="math inline">\(DF_2 = N_2 - (N_1 + p_2) = 537 - (197 +
6) = 334\)</span></li>
</ul>
<p>So we can finally see that those degrees of freedom are exactly as
displayed in the summary table above.</p>
</div>
<div class="section level2">
<h2 id="differences-compared-to-sas">Differences compared to SAS<a class="anchor" aria-label="anchor" href="#differences-compared-to-sas"></a>
</h2>
<p>The implementation described above is not identical to that of SAS.
Differences include:</p>
<ul>
<li>In SAS, when using an unstructured covariance matrix, all effects
are assigned the between-subjects degrees of freedom.</li>
<li>In SAS, the within-subjects degrees of freedom are affected by the
number of subjects in which the effect takes different values.</li>
<li>In SAS, if there are multiple within-subject effects containing
classification variables, the within-subject degrees of freedom are
partitioned into components corresponding to the subject-by-effect
interactions.</li>
<li>In SAS, the final effect you list in the
<code>CONTRAST</code>/<code>ESTIMATE</code> statement is used to define
the DF for general contrasts.</li>
</ul>
<p>Code contributions for adding the SAS version of between-within
degrees of freedom to the <code>mmrm</code> package are welcome!</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-galecki2013linear" class="csl-entry">
Gałecki A, Burzykowski T (2013). <span>“Linear Mixed-Effects
Model.”</span> In <em>Linear mixed-effects models using r</em> 245–273.
Springer.
</div>
<div id="ref-schluchter1990small" class="csl-entry">
Schluchter MD, Elashoff JT (1990). <span>“Small-Sample Adjustments to
Tests with Unbalanced Repeated Measures Assuming Several Covariance
Structures.”</span> <em>Journal of Statistical Computation and
Simulation</em>, <strong>37</strong>(1-2), 69–87.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Daniel Sabanes Bove, Julia Dedic, Doug Kelkhoff, Kevin Kunzmann, Brian Matthew Lang, Liming Li, Christian Stock, Ya Wang, Dan James, Jonathan Sidi, Daniel Leibovitz, Daniel D. Sjoberg, Boehringer Ingelheim Ltd., Gilead Sciences, Inc., F. Hoffmann-La Roche AG, Merck Sharp &amp; Dohme, Inc., AstraZeneca plc.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
