# predict works for data different factor levels

    c("1" = 36.4082672191324, "2" = 41.2059294235457, "3" = 46.0566947323669
    )

# predict works for unconditional prediction if response does not exist

    c("1" = 36.4082672191322, "2" = 41.2059294235456, "3" = 46.0566947323668, 
    "4" = 52.08639251429, "5" = 30.7774754828939, "6" = 35.6170639375502, 
    "7" = 41.1195883661398, "8" = 45.8313737455827, "9" = 32.6340371757258, 
    "10" = 37.4736256303821, "11" = 42.9761500589718, "12" = 47.6879354384146, 
    "13" = 34.8777674483404, "14" = 39.6754296527538, "15" = 44.526194961575, 
    "16" = 50.5558927434982, "17" = 32.3079752536856, "18" = 37.1475637083419, 
    "19" = 42.6500881369316, "20" = 47.3618735163744, "21" = 32.3079752536856, 
    "22" = 37.1475637083419, "23" = 42.6500881369316, "24" = 47.3618735163744, 
    "25" = 31.103537404934, "26" = 35.9431258595903, "27" = 41.44565028818, 
    "28" = 46.1574356676228, "29" = 32.3079752536856, "30" = 37.1475637083419, 
    "31" = 42.6500881369316, "32" = 47.3618735163744, "33" = 40.1952708743789, 
    "34" = 44.9929330787923, "35" = 49.8436983876135, "36" = 55.8733961695367, 
    "37" = 32.6340371757258, "38" = 37.4736256303821, "39" = 42.9761500589718, 
    "40" = 47.6879354384146, "41" = 34.8777674483404, "42" = 39.6754296527538, 
    "43" = 44.526194961575, "44" = 50.5558927434982, "45" = 30.7774754828939, 
    "46" = 35.6170639375502, "47" = 41.1195883661398, "48" = 45.8313737455827, 
    "49" = 40.1952708743789, "50" = 44.9929330787923, "51" = 49.8436983876135, 
    "52" = 55.8733961695367, "53" = 32.3079752536856, "54" = 37.1475637083419, 
    "55" = 42.6500881369316, "56" = 47.3618735163744, "57" = 30.7774754828939, 
    "58" = 35.6170639375502, "59" = 41.1195883661398, "60" = 45.8313737455827, 
    "61" = 31.103537404934, "62" = 35.9431258595903, "63" = 41.44565028818, 
    "64" = 46.1574356676228, "65" = 36.7471027530127, "66" = 41.586691207669, 
    "67" = 47.0892156362586, "68" = 51.8010010157015, "69" = 34.5517055263003, 
    "70" = 39.3493677307136, "71" = 44.2001330395348, "72" = 50.2298308214581, 
    "73" = 34.5517055263003, "74" = 39.3493677307136, "75" = 44.2001330395348, 
    "76" = 50.2298308214581, "77" = 40.5213327964191, "78" = 45.3189950008324, 
    "79" = 50.1697603096537, "80" = 56.1994580915769, "81" = 40.1952708743789, 
    "82" = 44.9929330787923, "83" = 49.8436983876135, "84" = 55.8733961695367, 
    "85" = 40.1952708743789, "86" = 44.9929330787923, "87" = 49.8436983876135, 
    "88" = 55.8733961695367, "89" = 32.6340371757258, "90" = 37.4736256303821, 
    "91" = 42.9761500589718, "92" = 47.6879354384146, "93" = 40.5213327964191, 
    "94" = 45.3189950008324, "95" = 50.1697603096537, "96" = 56.1994580915769, 
    "97" = 40.5213327964191, "98" = 45.3189950008324, "99" = 50.1697603096537, 
    "100" = 56.1994580915769, "101" = 40.5213327964191, "102" = 45.3189950008324, 
    "103" = 50.1697603096537, "104" = 56.1994580915769, "105" = 36.4082672191322, 
    "106" = 41.2059294235456, "107" = 46.0566947323668, "108" = 52.08639251429, 
    "109" = 36.082205297092, "110" = 40.8798675015054, "111" = 45.7306328103266, 
    "112" = 51.7603305922498, "113" = 36.082205297092, "114" = 40.8798675015054, 
    "115" = 45.7306328103266, "116" = 51.7603305922498, "117" = 34.8777674483404, 
    "118" = 39.6754296527538, "119" = 44.526194961575, "120" = 50.5558927434982, 
    "121" = 31.103537404934, "122" = 35.9431258595903, "123" = 41.44565028818, 
    "124" = 46.1574356676228, "125" = 36.082205297092, "126" = 40.8798675015054, 
    "127" = 45.7306328103266, "128" = 51.7603305922498, "129" = 36.082205297092, 
    "130" = 40.8798675015054, "131" = 45.7306328103266, "132" = 51.7603305922498, 
    "133" = 31.103537404934, "134" = 35.9431258595903, "135" = 41.44565028818, 
    "136" = 46.1574356676228, "137" = 36.4082672191322, "138" = 41.2059294235456, 
    "139" = 46.0566947323668, "140" = 52.08639251429, "141" = 34.8777674483404, 
    "142" = 39.6754296527538, "143" = 44.526194961575, "144" = 50.5558927434982, 
    "145" = 36.7471027530127, "146" = 41.586691207669, "147" = 47.0892156362586, 
    "148" = 51.8010010157015, "149" = 31.103537404934, "150" = 35.9431258595903, 
    "151" = 41.44565028818, "152" = 46.1574356676228, "153" = 31.103537404934, 
    "154" = 35.9431258595903, "155" = 41.44565028818, "156" = 46.1574356676228, 
    "157" = 32.3079752536856, "158" = 37.1475637083419, "159" = 42.6500881369316, 
    "160" = 47.3618735163744, "161" = 32.3079752536856, "162" = 37.1475637083419, 
    "163" = 42.6500881369316, "164" = 47.3618735163744, "165" = 32.3079752536856, 
    "166" = 37.1475637083419, "167" = 42.6500881369316, "168" = 47.3618735163744, 
    "169" = 36.4082672191322, "170" = 41.2059294235456, "171" = 46.0566947323668, 
    "172" = 52.08639251429, "173" = 36.082205297092, "174" = 40.8798675015054, 
    "175" = 45.7306328103266, "176" = 51.7603305922498, "177" = 31.103537404934, 
    "178" = 35.9431258595903, "179" = 41.44565028818, "180" = 46.1574356676228, 
    "181" = 30.7774754828939, "182" = 35.6170639375502, "183" = 41.1195883661398, 
    "184" = 45.8313737455827, "185" = 34.5517055263003, "186" = 39.3493677307136, 
    "187" = 44.2001330395348, "188" = 50.2298308214581, "189" = 32.3079752536856, 
    "190" = 37.1475637083419, "191" = 42.6500881369316, "192" = 47.3618735163744, 
    "193" = 36.7471027530127, "194" = 41.586691207669, "195" = 47.0892156362586, 
    "196" = 51.8010010157015, "197" = 34.8777674483404, "198" = 39.6754296527538, 
    "199" = 44.526194961575, "200" = 50.5558927434982, "201" = 36.4082672191322, 
    "202" = 41.2059294235456, "203" = 46.0566947323668, "204" = 52.08639251429, 
    "205" = 36.4082672191322, "206" = 41.2059294235456, "207" = 46.0566947323668, 
    "208" = 52.08639251429, "209" = 36.4210408309725, "210" = 41.2606292856288, 
    "211" = 46.7631537142185, "212" = 51.4749390936613, "213" = 40.5213327964191, 
    "214" = 45.3189950008324, "215" = 50.1697603096537, "216" = 56.1994580915769, 
    "217" = 34.5517055263003, "218" = 39.3493677307136, "219" = 44.2001330395348, 
    "220" = 50.2298308214581, "221" = 32.3079752536856, "222" = 37.1475637083419, 
    "223" = 42.6500881369316, "224" = 47.3618735163744, "225" = 36.082205297092, 
    "226" = 40.8798675015054, "227" = 45.7306328103266, "228" = 51.7603305922498, 
    "229" = 40.5213327964191, "230" = 45.3189950008324, "231" = 50.1697603096537, 
    "232" = 56.1994580915769, "233" = 40.5213327964191, "234" = 45.3189950008324, 
    "235" = 50.1697603096537, "236" = 56.1994580915769, "237" = 36.4082672191322, 
    "238" = 41.2059294235456, "239" = 46.0566947323668, "240" = 52.08639251429, 
    "241" = 34.5517055263003, "242" = 39.3493677307136, "243" = 44.2001330395348, 
    "244" = 50.2298308214581, "245" = 31.103537404934, "246" = 35.9431258595903, 
    "247" = 41.44565028818, "248" = 46.1574356676228, "249" = 36.7471027530127, 
    "250" = 41.586691207669, "251" = 47.0892156362586, "252" = 51.8010010157015, 
    "253" = 32.6340371757258, "254" = 37.4736256303821, "255" = 42.9761500589718, 
    "256" = 47.6879354384146, "257" = 34.8777674483404, "258" = 39.6754296527538, 
    "259" = 44.526194961575, "260" = 50.5558927434982, "261" = 34.5517055263003, 
    "262" = 39.3493677307136, "263" = 44.2001330395348, "264" = 50.2298308214581, 
    "265" = 40.5213327964191, "266" = 45.3189950008324, "267" = 50.1697603096537, 
    "268" = 56.1994580915769, "269" = 40.5213327964191, "270" = 45.3189950008324, 
    "271" = 50.1697603096537, "272" = 56.1994580915769, "273" = 32.3079752536856, 
    "274" = 37.1475637083419, "275" = 42.6500881369316, "276" = 47.3618735163744, 
    "277" = 32.3079752536856, "278" = 37.1475637083419, "279" = 42.6500881369316, 
    "280" = 47.3618735163744, "281" = 34.5517055263003, "282" = 39.3493677307136, 
    "283" = 44.2001330395348, "284" = 50.2298308214581, "285" = 34.8777674483404, 
    "286" = 39.6754296527538, "287" = 44.526194961575, "288" = 50.5558927434982, 
    "289" = 36.4210408309725, "290" = 41.2606292856288, "291" = 46.7631537142185, 
    "292" = 51.4749390936613, "293" = 36.7471027530127, "294" = 41.586691207669, 
    "295" = 47.0892156362586, "296" = 51.8010010157015, "297" = 36.4210408309725, 
    "298" = 41.2606292856288, "299" = 46.7631537142185, "300" = 51.4749390936613, 
    "301" = 40.1952708743789, "302" = 44.9929330787923, "303" = 49.8436983876135, 
    "304" = 55.8733961695367, "305" = 34.5517055263003, "306" = 39.3493677307136, 
    "307" = 44.2001330395348, "308" = 50.2298308214581, "309" = 40.5213327964191, 
    "310" = 45.3189950008324, "311" = 50.1697603096537, "312" = 56.1994580915769, 
    "313" = 31.103537404934, "314" = 35.9431258595903, "315" = 41.44565028818, 
    "316" = 46.1574356676228, "317" = 34.5517055263003, "318" = 39.3493677307136, 
    "319" = 44.2001330395348, "320" = 50.2298308214581, "321" = 36.4210408309725, 
    "322" = 41.2606292856288, "323" = 46.7631537142185, "324" = 51.4749390936613, 
    "325" = 32.6340371757258, "326" = 37.4736256303821, "327" = 42.9761500589718, 
    "328" = 47.6879354384146, "329" = 40.1952708743789, "330" = 44.9929330787923, 
    "331" = 49.8436983876135, "332" = 55.8733961695367, "333" = 31.103537404934, 
    "334" = 35.9431258595903, "335" = 41.44565028818, "336" = 46.1574356676228, 
    "337" = 31.103537404934, "338" = 35.9431258595903, "339" = 41.44565028818, 
    "340" = 46.1574356676228, "341" = 36.4082672191322, "342" = 41.2059294235456, 
    "343" = 46.0566947323668, "344" = 52.08639251429, "345" = 36.4210408309725, 
    "346" = 41.2606292856288, "347" = 46.7631537142185, "348" = 51.4749390936613, 
    "349" = 32.6340371757258, "350" = 37.4736256303821, "351" = 42.9761500589718, 
    "352" = 47.6879354384146, "353" = 32.3079752536856, "354" = 37.1475637083419, 
    "355" = 42.6500881369316, "356" = 47.3618735163744, "357" = 30.7774754828939, 
    "358" = 35.6170639375502, "359" = 41.1195883661398, "360" = 45.8313737455827, 
    "361" = 40.5213327964191, "362" = 45.3189950008324, "363" = 50.1697603096537, 
    "364" = 56.1994580915769, "365" = 40.5213327964191, "366" = 45.3189950008324, 
    "367" = 50.1697603096537, "368" = 56.1994580915769, "369" = 32.3079752536856, 
    "370" = 37.1475637083419, "371" = 42.6500881369316, "372" = 47.3618735163744, 
    "373" = 31.103537404934, "374" = 35.9431258595903, "375" = 41.44565028818, 
    "376" = 46.1574356676228, "377" = 31.103537404934, "378" = 35.9431258595903, 
    "379" = 41.44565028818, "380" = 46.1574356676228, "381" = 32.6340371757258, 
    "382" = 37.4736256303821, "383" = 42.9761500589718, "384" = 47.6879354384146, 
    "385" = 40.1952708743789, "386" = 44.9929330787923, "387" = 49.8436983876135, 
    "388" = 55.8733961695367, "389" = 30.7774754828939, "390" = 35.6170639375502, 
    "391" = 41.1195883661398, "392" = 45.8313737455827, "393" = 32.3079752536856, 
    "394" = 37.1475637083419, "395" = 42.6500881369316, "396" = 47.3618735163744, 
    "397" = 32.6340371757258, "398" = 37.4736256303821, "399" = 42.9761500589718, 
    "400" = 47.6879354384146, "401" = 40.1952708743789, "402" = 44.9929330787923, 
    "403" = 49.8436983876135, "404" = 55.8733961695367, "405" = 31.103537404934, 
    "406" = 35.9431258595903, "407" = 41.44565028818, "408" = 46.1574356676228, 
    "409" = 31.103537404934, "410" = 35.9431258595903, "411" = 41.44565028818, 
    "412" = 46.1574356676228, "413" = 32.6340371757258, "414" = 37.4736256303821, 
    "415" = 42.9761500589718, "416" = 47.6879354384146, "417" = 36.4082672191322, 
    "418" = 41.2059294235456, "419" = 46.0566947323668, "420" = 52.08639251429, 
    "421" = 34.8777674483404, "422" = 39.6754296527538, "423" = 44.526194961575, 
    "424" = 50.5558927434982, "425" = 36.7471027530127, "426" = 41.586691207669, 
    "427" = 47.0892156362586, "428" = 51.8010010157015, "429" = 40.1952708743789, 
    "430" = 44.9929330787923, "431" = 49.8436983876135, "432" = 55.8733961695367, 
    "433" = 32.6340371757258, "434" = 37.4736256303821, "435" = 42.9761500589718, 
    "436" = 47.6879354384146, "437" = 34.5517055263003, "438" = 39.3493677307136, 
    "439" = 44.2001330395348, "440" = 50.2298308214581, "441" = 36.7471027530127, 
    "442" = 41.586691207669, "443" = 47.0892156362586, "444" = 51.8010010157015, 
    "445" = 32.6340371757258, "446" = 37.4736256303821, "447" = 42.9761500589718, 
    "448" = 47.6879354384146, "449" = 30.7774754828939, "450" = 35.6170639375502, 
    "451" = 41.1195883661398, "452" = 45.8313737455827, "453" = 32.3079752536856, 
    "454" = 37.1475637083419, "455" = 42.6500881369316, "456" = 47.3618735163744, 
    "457" = 31.103537404934, "458" = 35.9431258595903, "459" = 41.44565028818, 
    "460" = 46.1574356676228, "461" = 36.082205297092, "462" = 40.8798675015054, 
    "463" = 45.7306328103266, "464" = 51.7603305922498, "465" = 32.3079752536856, 
    "466" = 37.1475637083419, "467" = 42.6500881369316, "468" = 47.3618735163744, 
    "469" = 31.103537404934, "470" = 35.9431258595903, "471" = 41.44565028818, 
    "472" = 46.1574356676228, "473" = 40.1952708743789, "474" = 44.9929330787923, 
    "475" = 49.8436983876135, "476" = 55.8733961695367, "477" = 31.103537404934, 
    "478" = 35.9431258595903, "479" = 41.44565028818, "480" = 46.1574356676228, 
    "481" = 36.082205297092, "482" = 40.8798675015054, "483" = 45.7306328103266, 
    "484" = 51.7603305922498, "485" = 31.103537404934, "486" = 35.9431258595903, 
    "487" = 41.44565028818, "488" = 46.1574356676228, "489" = 36.7471027530127, 
    "490" = 41.586691207669, "491" = 47.0892156362586, "492" = 51.8010010157015, 
    "493" = 34.8777674483404, "494" = 39.6754296527538, "495" = 44.526194961575, 
    "496" = 50.5558927434982, "497" = 36.4210408309725, "498" = 41.2606292856288, 
    "499" = 46.7631537142185, "500" = 51.4749390936613, "501" = 34.5517055263003, 
    "502" = 39.3493677307136, "503" = 44.2001330395348, "504" = 50.2298308214581, 
    "505" = 36.4082672191322, "506" = 41.2059294235456, "507" = 46.0566947323668, 
    "508" = 52.08639251429, "509" = 34.8777674483404, "510" = 39.6754296527538, 
    "511" = 44.526194961575, "512" = 50.5558927434982, "513" = 40.1952708743789, 
    "514" = 44.9929330787923, "515" = 49.8436983876135, "516" = 55.8733961695367, 
    "517" = 36.4210408309725, "518" = 41.2606292856288, "519" = 46.7631537142185, 
    "520" = 51.4749390936613, "521" = 31.103537404934, "522" = 35.9431258595903, 
    "523" = 41.44565028818, "524" = 46.1574356676228, "525" = 30.7774754828939, 
    "526" = 35.6170639375502, "527" = 41.1195883661398, "528" = 45.8313737455827, 
    "529" = 36.4210408309725, "530" = 41.2606292856288, "531" = 46.7631537142185, 
    "532" = 51.4749390936613, "533" = 32.3079752536856, "534" = 37.1475637083419, 
    "535" = 42.6500881369316, "536" = 47.3618735163744, "537" = 32.3079752536856, 
    "538" = 37.1475637083419, "539" = 42.6500881369316, "540" = 47.3618735163744, 
    "541" = 40.5213327964191, "542" = 45.3189950008324, "543" = 50.1697603096537, 
    "544" = 56.1994580915769, "545" = 34.8777674483404, "546" = 39.6754296527538, 
    "547" = 44.526194961575, "548" = 50.5558927434982, "549" = 34.5517055263003, 
    "550" = 39.3493677307136, "551" = 44.2001330395348, "552" = 50.2298308214581, 
    "553" = 34.8777674483404, "554" = 39.6754296527538, "555" = 44.526194961575, 
    "556" = 50.5558927434982, "557" = 32.6340371757258, "558" = 37.4736256303821, 
    "559" = 42.9761500589718, "560" = 47.6879354384146, "561" = 40.1952708743789, 
    "562" = 44.9929330787923, "563" = 49.8436983876135, "564" = 55.8733961695367, 
    "565" = 36.082205297092, "566" = 40.8798675015054, "567" = 45.7306328103266, 
    "568" = 51.7603305922498, "569" = 36.4082672191322, "570" = 41.2059294235456, 
    "571" = 46.0566947323668, "572" = 52.08639251429, "573" = 31.103537404934, 
    "574" = 35.9431258595903, "575" = 41.44565028818, "576" = 46.1574356676228, 
    "577" = 32.3079752536856, "578" = 37.1475637083419, "579" = 42.6500881369316, 
    "580" = 47.3618735163744, "581" = 34.8777674483404, "582" = 39.6754296527538, 
    "583" = 44.526194961575, "584" = 50.5558927434982, "585" = 31.103537404934, 
    "586" = 35.9431258595903, "587" = 41.44565028818, "588" = 46.1574356676228, 
    "589" = 36.082205297092, "590" = 40.8798675015054, "591" = 45.7306328103266, 
    "592" = 51.7603305922498, "593" = 31.103537404934, "594" = 35.9431258595903, 
    "595" = 41.44565028818, "596" = 46.1574356676228, "597" = 36.4210408309725, 
    "598" = 41.2606292856288, "599" = 46.7631537142185, "600" = 51.4749390936613, 
    "601" = 31.103537404934, "602" = 35.9431258595903, "603" = 41.44565028818, 
    "604" = 46.1574356676228, "605" = 34.8777674483404, "606" = 39.6754296527538, 
    "607" = 44.526194961575, "608" = 50.5558927434982, "609" = 32.3079752536856, 
    "610" = 37.1475637083419, "611" = 42.6500881369316, "612" = 47.3618735163744, 
    "613" = 32.6340371757258, "614" = 37.4736256303821, "615" = 42.9761500589718, 
    "616" = 47.6879354384146, "617" = 34.5517055263003, "618" = 39.3493677307136, 
    "619" = 44.2001330395348, "620" = 50.2298308214581, "621" = 36.4210408309725, 
    "622" = 41.2606292856288, "623" = 46.7631537142185, "624" = 51.4749390936613, 
    "625" = 36.082205297092, "626" = 40.8798675015054, "627" = 45.7306328103266, 
    "628" = 51.7603305922498, "629" = 36.082205297092, "630" = 40.8798675015054, 
    "631" = 45.7306328103266, "632" = 51.7603305922498, "633" = 34.8777674483404, 
    "634" = 39.6754296527538, "635" = 44.526194961575, "636" = 50.5558927434982, 
    "637" = 34.5517055263003, "638" = 39.3493677307136, "639" = 44.2001330395348, 
    "640" = 50.2298308214581, "641" = 32.6340371757258, "642" = 37.4736256303821, 
    "643" = 42.9761500589718, "644" = 47.6879354384146, "645" = 30.7774754828939, 
    "646" = 35.6170639375502, "647" = 41.1195883661398, "648" = 45.8313737455827, 
    "649" = 36.4210408309725, "650" = 41.2606292856288, "651" = 46.7631537142185, 
    "652" = 51.4749390936613, "653" = 32.6340371757258, "654" = 37.4736256303821, 
    "655" = 42.9761500589718, "656" = 47.6879354384146, "657" = 40.5213327964191, 
    "658" = 45.3189950008324, "659" = 50.1697603096537, "660" = 56.1994580915769, 
    "661" = 34.5517055263003, "662" = 39.3493677307136, "663" = 44.2001330395348, 
    "664" = 50.2298308214581, "665" = 32.3079752536856, "666" = 37.1475637083419, 
    "667" = 42.6500881369316, "668" = 47.3618735163744, "669" = 32.6340371757258, 
    "670" = 37.4736256303821, "671" = 42.9761500589718, "672" = 47.6879354384146, 
    "673" = 36.7471027530127, "674" = 41.586691207669, "675" = 47.0892156362586, 
    "676" = 51.8010010157015, "677" = 40.5213327964191, "678" = 45.3189950008324, 
    "679" = 50.1697603096537, "680" = 56.1994580915769, "681" = 31.103537404934, 
    "682" = 35.9431258595903, "683" = 41.44565028818, "684" = 46.1574356676228, 
    "685" = 34.8777674483404, "686" = 39.6754296527538, "687" = 44.526194961575, 
    "688" = 50.5558927434982, "689" = 40.5213327964191, "690" = 45.3189950008324, 
    "691" = 50.1697603096537, "692" = 56.1994580915769, "693" = 36.4082672191322, 
    "694" = 41.2059294235456, "695" = 46.0566947323668, "696" = 52.08639251429, 
    "697" = 32.6340371757258, "698" = 37.4736256303821, "699" = 42.9761500589718, 
    "700" = 47.6879354384146, "701" = 36.082205297092, "702" = 40.8798675015054, 
    "703" = 45.7306328103266, "704" = 51.7603305922498, "705" = 32.3079752536856, 
    "706" = 37.1475637083419, "707" = 42.6500881369316, "708" = 47.3618735163744, 
    "709" = 32.3079752536856, "710" = 37.1475637083419, "711" = 42.6500881369316, 
    "712" = 47.3618735163744, "713" = 40.1952708743789, "714" = 44.9929330787923, 
    "715" = 49.8436983876135, "716" = 55.8733961695367, "717" = 30.7774754828939, 
    "718" = 35.6170639375502, "719" = 41.1195883661398, "720" = 45.8313737455827, 
    "721" = 31.103537404934, "722" = 35.9431258595903, "723" = 41.44565028818, 
    "724" = 46.1574356676228, "725" = 36.4082672191322, "726" = 41.2059294235456, 
    "727" = 46.0566947323668, "728" = 52.08639251429, "729" = 36.4082672191322, 
    "730" = 41.2059294235456, "731" = 46.0566947323668, "732" = 52.08639251429, 
    "733" = 40.5213327964191, "734" = 45.3189950008324, "735" = 50.1697603096537, 
    "736" = 56.1994580915769, "737" = 32.6340371757258, "738" = 37.4736256303821, 
    "739" = 42.9761500589718, "740" = 47.6879354384146, "741" = 36.4210408309725, 
    "742" = 41.2606292856288, "743" = 46.7631537142185, "744" = 51.4749390936613, 
    "745" = 32.6340371757258, "746" = 37.4736256303821, "747" = 42.9761500589718, 
    "748" = 47.6879354384146, "749" = 32.6340371757258, "750" = 37.4736256303821, 
    "751" = 42.9761500589718, "752" = 47.6879354384146, "753" = 34.8777674483404, 
    "754" = 39.6754296527538, "755" = 44.526194961575, "756" = 50.5558927434982, 
    "757" = 36.4082672191322, "758" = 41.2059294235456, "759" = 46.0566947323668, 
    "760" = 52.08639251429, "761" = 40.1952708743789, "762" = 44.9929330787923, 
    "763" = 49.8436983876135, "764" = 55.8733961695367, "765" = 40.5213327964191, 
    "766" = 45.3189950008324, "767" = 50.1697603096537, "768" = 56.1994580915769, 
    "769" = 30.7774754828939, "770" = 35.6170639375502, "771" = 41.1195883661398, 
    "772" = 45.8313737455827, "773" = 32.3079752536856, "774" = 37.1475637083419, 
    "775" = 42.6500881369316, "776" = 47.3618735163744, "777" = 40.5213327964191, 
    "778" = 45.3189950008324, "779" = 50.1697603096537, "780" = 56.1994580915769, 
    "781" = 30.7774754828939, "782" = 35.6170639375502, "783" = 41.1195883661398, 
    "784" = 45.8313737455827, "785" = 32.3079752536856, "786" = 37.1475637083419, 
    "787" = 42.6500881369316, "788" = 47.3618735163744, "789" = 36.082205297092, 
    "790" = 40.8798675015054, "791" = 45.7306328103266, "792" = 51.7603305922498, 
    "793" = 40.1952708743789, "794" = 44.9929330787923, "795" = 49.8436983876135, 
    "796" = 55.8733961695367, "797" = 32.3079752536856, "798" = 37.1475637083419, 
    "799" = 42.6500881369316, "800" = 47.3618735163744)

# predict works if contrast provided

    c("1" = 35.5918462023552, "4" = 20.4837899973602)

---

    c("2" = 39.9710497720302, "3" = 45.5972003579236)

---

    c("1" = 36.3635976796827, "2" = 39.9710497720302, "3" = 35.5027462365071, 
    "4" = 20.4837899973602)

# model.matrix works with broom.helpers

    structure(list(term = c("ARMCDPBO", "ARMCDTRT", "ARMCDTRT:AVISITVIS2", 
    "ARMCDTRT:AVISITVIS3", "ARMCDTRT:AVISITVIS4", "AVISITVIS1", "AVISITVIS2", 
    "AVISITVIS3", "AVISITVIS4", "RACEAsian", "RACEBlack or African American", 
    "RACEWhite", "SEXMale", "SEXFemale"), variable = c("ARMCD", "ARMCD", 
    "ARMCD:AVISIT", "ARMCD:AVISIT", "ARMCD:AVISIT", "AVISIT", "AVISIT", 
    "AVISIT", "AVISIT", "RACE", "RACE", "RACE", "SEX", "SEX"), var_label = c(ARMCD = "ARMCD", 
    ARMCD = "ARMCD", "ARMCD:AVISIT" = "ARMCD * AVISIT", "ARMCD:AVISIT" = "ARMCD * AVISIT", 
    "ARMCD:AVISIT" = "ARMCD * AVISIT", AVISIT = "AVISIT", AVISIT = "AVISIT", 
    AVISIT = "AVISIT", AVISIT = "AVISIT", RACE = "RACE", RACE = "RACE", 
    RACE = "RACE", SEX = "SEX", SEX = "SEX"), var_class = c("factor", 
    ARMCD = "factor", NA, NA, NA, "factor", AVISIT = "factor", AVISIT = "factor", 
    AVISIT = "factor", "factor", RACE = "factor", RACE = "factor", 
    "factor", SEX = "factor"), var_type = c("dichotomous", "dichotomous", 
    "interaction", "interaction", "interaction", "categorical", "categorical", 
    "categorical", "categorical", "categorical", "categorical", "categorical", 
    "dichotomous", "dichotomous"), var_nlevels = c(2L, ARMCD = 2L, 
    NA, NA, NA, 4L, AVISIT = 4L, AVISIT = 4L, AVISIT = 4L, 3L, RACE = 3L, 
    RACE = 3L, 2L, SEX = 2L), contrasts = c("contr.treatment", "contr.treatment", 
    NA, NA, NA, "contr.treatment", "contr.treatment", "contr.treatment", 
    "contr.treatment", "contr.treatment", "contr.treatment", "contr.treatment", 
    "contr.treatment", "contr.treatment"), contrasts_type = c("treatment", 
    "treatment", NA, NA, NA, "treatment", "treatment", "treatment", 
    "treatment", "treatment", "treatment", "treatment", "treatment", 
    "treatment"), reference_row = c(TRUE, FALSE, NA, NA, NA, TRUE, 
    FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, TRUE, FALSE), label = c(ARMCDPBO = "PBO", 
    ARMCDTRT = "TRT", "ARMCDTRT:AVISITVIS2" = "TRT * VIS2", "ARMCDTRT:AVISITVIS3" = "TRT * VIS3", 
    "ARMCDTRT:AVISITVIS4" = "TRT * VIS4", AVISITVIS1 = "VIS1", AVISITVIS2 = "VIS2", 
    AVISITVIS3 = "VIS3", AVISITVIS4 = "VIS4", RACEAsian = "Asian", 
    "RACEBlack or African American" = "Black or African American", 
    RACEWhite = "White", SEXMale = "Male", SEXFemale = "Female"), 
        n_obs = c(ARMCDPBO = 275, ARMCDTRT = 262, "ARMCDTRT:AVISITVIS2" = 71, 
        "ARMCDTRT:AVISITVIS3" = 58, "ARMCDTRT:AVISITVIS4" = 67, AVISITVIS1 = 134, 
        AVISITVIS2 = 140, AVISITVIS3 = 129, AVISITVIS4 = 134, RACEAsian = 200, 
        "RACEBlack or African American" = 196, RACEWhite = 141, SEXMale = 249, 
        SEXFemale = 288), estimate = c(0, 3.77423004340742, -0.0419262502437297, 
        -0.693685370012233, 0.624227032468209, 0, 4.83958845465698, 
        10.3421128832467, 15.0538982626895, 0, 1.5304997707921, 5.64356534807883, 
        0, 0.326061922040439), std.error = c(NA, 1.07414697568452, 
        1.12931807081669, 1.18764553104087, 1.85085235375357, NA, 
        0.80171672401867, 0.822693114357083, 1.31281331020802, NA, 
        0.624475361804821, 0.665609345806726, NA, 0.531950363284883
        ), df = c(NA, 145.551961966958, 138.564258914368, 158.165143267807, 
        129.720430941981, NA, 143.875836395446, 155.557518226365, 
        138.470779333042, NA, 168.665718047674, 157.138215602096, 
        NA, 166.132390274815), statistic = c(NA, 3.51369982771885, 
        -0.0371252805805274, -0.584084520070799, 0.33726462902471, 
        NA, 6.0365317445271, 12.5710458769657, 11.4668994788788, 
        NA, 2.45085693432122, 8.47879523271832, NA, 0.612955539736738
        ), p.value = c(NA, 0.000589148053065131, 0.970438546955262, 
        0.559995557684396, 0.73646251038525, NA, 1.27404785749447e-08, 
        1.86285590944021e-25, 8.1137710308944e-22, NA, 0.0152721756140462, 
        1.56486934310207e-14, NA, 0.540743930456226), conf.low = c(NA, 
        1.65128972597226, -2.27485044302086, -3.03937574240459, -3.03753713573025, 
        NA, 3.25492357986696, 8.71702131719472, 12.4581459150949, 
        NA, 0.297705059652136, 4.32886996283646, NA, -0.724192262074581
        ), conf.high = c(NA, 5.89717036084258, 2.1909979425334, 1.65200500238012, 
        4.28599120066667, NA, 6.424253329447, 11.9672044492986, 17.649650610284, 
        NA, 2.76329448193206, 6.95826073332119, NA, 1.37631610615546
        )), row.names = c(NA, -14L), class = c("broom.helpers", "tbl_df", 
    "tbl", "data.frame"), exponentiate = FALSE, conf.level = 0.95, N_obs = 537, coefficients_type = "generic", coefficients_label = "Beta")

# print.mmrm_tmb works as expected

    mmrm fit
    
    Formula:     FEV1 ~ RACE + us(AVISIT | USUBJID)
    Data:        fev_data (used 537 observations from 197 subjects with maximum 4 
    timepoints)
    Weights:     rep(1, nrow(fev_data))
    Covariance:  unstructured (10 variance parameters)
    Inference:   REML
    Deviance:    3642.395
    
    Coefficients: 
                      (Intercept) RACEBlack or African American 
                       41.2272022                     0.8001225 
                        RACEWhite 
                        5.8791646 
    
    Model Inference Optimization:
    Converged with code 0 and message: convergence: rel_reduction_of_f <= factr*epsmch

---

    mmrm fit
    
    Formula:     FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID)
    Data:        fev_data (used 537 observations from 197 subjects with maximum 4 
    timepoints)
    Covariance:  unstructured (10 variance parameters)
    Inference:   REML
    Deviance:    3386.45
    
    Coefficients: 
                      (Intercept) RACEBlack or African American 
                      30.77747548                    1.53049977 
                        RACEWhite                     SEXFemale 
                       5.64356535                    0.32606192 
                         ARMCDTRT                    AVISITVIS2 
                       3.77423004                    4.83958845 
                       AVISITVIS3                    AVISITVIS4 
                      10.34211288                   15.05389826 
              ARMCDTRT:AVISITVIS2           ARMCDTRT:AVISITVIS3 
                      -0.04192625                   -0.69368537 
              ARMCDTRT:AVISITVIS4 
                       0.62422703 
    
    Model Inference Optimization:
    Converged with code 0 and message: convergence: rel_reduction_of_f <= factr*epsmch

# print.mmrm_tmb works as expected for rank deficient fits

    mmrm fit
    
    Formula:     FEV1 ~ SEX + SEX2 + us(AVISIT | USUBJID)
    Data:        .mmrm_tmb_dat_rank_deficient (used 537 observations from 197 
    subjects with maximum 4 timepoints)
    Weights:     rep(1, nrow(fev_data))
    Covariance:  unstructured (10 variance parameters)
    Inference:   REML
    Deviance:    3699.803
    
    Coefficients: (1 not defined because of singularities)
    (Intercept)   SEXFemale  SEX2Female 
    42.80540973  0.04513432          NA 
    
    Model Inference Optimization:
    Converged with code 0 and message: convergence: rel_reduction_of_f <= factr*epsmch

