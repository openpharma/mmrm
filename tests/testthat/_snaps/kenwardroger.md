# h_get_kr_comp works as expected on ar1 ungrouped mmrm

    list(P = structure(c(-8.6951404485695, -4.18484163528792, -3.2993613446609, 
    -1.64605311219472, -4.18484163528792, -4.18484163528792, -1.64605311219472, 
    -1.64605311219472), dim = c(4L, 2L)), Q = structure(c(17.390280897139, 
    8.36968327057585, 6.59872268932179, 3.29210622438944, 6.59872268932179, 
    3.29210622438943, 3.13460478136063, 1.58300324944804, 8.36968327057585, 
    8.36968327057585, 3.29210622438944, 3.29210622438944, 3.29210622438943, 
    3.29210622438943, 1.58300324944804, 1.58300324944804), dim = c(8L, 
    2L)), R = structure(c(17.390280897139, 8.36968327057585, 6.59872268932179, 
    3.29210622438944, 6.59872268932179, 3.29210622438944, 0.587917298512552, 
    0.305218430155293, 8.36968327057585, 8.36968327057585, 3.29210622438944, 
    3.29210622438944, 3.29210622438944, 3.29210622438944, 0.305218430155293, 
    0.305218430155293), dim = c(8L, 2L)))

# h_get_kr_comp works as expected on ar1 grouped mmrm

    list(P = structure(c(-4.06278289431356, -1.90710315499515, -1.54720401850159, 
    -0.731435977362822, -4.64225304233885, -2.28093254212952, -1.75816393625941, 
    -0.913236191436237, -1.90710315499515, -1.90710315499515, -0.731435977362822, 
    -0.731435977362822, -2.28093254212952, -2.28093254212952, -0.913236191436237, 
    -0.913236191436237), dim = c(8L, 2L)), Q = structure(c(8.12556578862711, 
    3.8142063099903, 3.09440803700318, 1.46287195472564, 3.09440803700318, 
    1.46287195472564, 1.50236371269529, 0.705888243063821, 9.2845060846777, 
    4.56186508425903, 3.51632787251882, 1.82647238287247, 3.51632787251882, 
    1.82647238287247, 1.64340023685874, 0.874305512352496, 3.8142063099903, 
    3.8142063099903, 1.46287195472564, 1.46287195472564, 1.46287195472564, 
    1.46287195472564, 0.705888243063821, 0.705888243063821, 4.56186508425903, 
    4.56186508425903, 1.82647238287247, 1.82647238287247, 1.82647238287247, 
    1.82647238287247, 0.874305512352496, 0.874305512352496), dim = c(16L, 
    2L)), R = structure(c(8.12556578862711, 3.8142063099903, 3.09440803700317, 
    1.46287195472564, 3.09440803700317, 1.46287195472564, 0.374121019881623, 
    0.249364197538307, 9.2845060846777, 4.56186508425903, 3.51632787251882, 
    1.82647238287247, 3.51632787251882, 1.82647238287247, 0.221459167589304, 
    0.0615916069137739, 3.8142063099903, 3.8142063099903, 1.46287195472564, 
    1.46287195472564, 1.46287195472564, 1.46287195472564, 0.249364197538307, 
    0.249364197538307, 4.56186508425903, 4.56186508425903, 1.82647238287247, 
    1.82647238287247, 1.82647238287247, 1.82647238287247, 0.0615916069137739, 
    0.0615916069137739), dim = c(16L, 2L)))

# h_get_kr_comp works as expected on ar1h ungrouped mmrm

    list(P = structure(c(-1.79034554536764, -0.865071368460441, -5.82101562553573, 
    -2.95177251644943, -6.15521719218183, -2.69485885209774, -0.659265438675531, 
    -0.328975732000032, -4.69076853080195, -2.32932625809294, -0.865071368460441, 
    -0.865071368460441, -2.95177251644943, -2.95177251644943, -2.69485885209774, 
    -2.69485885209774, -0.328975732000032, -0.328975732000032, -2.32932625809294, 
    -2.32932625809294), dim = c(10L, 2L)), Q = structure(c(4.05951568830365, 
    1.97682793975525, -0.526326779866945, -0.273366906829198, 0.0422437157207733, 
    0.0239370819242503, 0.00525846657779472, 0.00274462207058319, 
    2.38531167608663, 1.17243038090577, -0.526326779866943, -0.273366906829197, 
    12.9013371824117, 6.54479953227488, -0.721775024593032, -0.361442939234647, 
    -0.0112041268802527, -0.00644465331218001, 3.0880451804449, 1.56556194846262, 
    0.0422437157207732, 0.0239370819242502, -0.721775024593032, -0.361442939234648, 
    13.4036155607239, 5.93182594673928, -0.413649867487985, -0.204602385233392, 
    2.23648410889379, 1.06988980588918, 0.00525846657779476, 0.00274462207058321, 
    -0.0112041268802529, -0.00644465331218008, -0.413649867487985, 
    -0.204602385233392, 1.73812640514151, 0.866253880475053, 1.67169609617858, 
    0.850770380928311, 2.38531167608663, 1.17243038090577, 3.08804518044491, 
    1.56556194846262, 2.23648410889379, 1.06988980588918, 1.67169609617858, 
    0.850770380928312, 5.89930908653327, 2.9547519729988, 1.97682793975525, 
    1.97682793975525, -0.273366906829198, -0.273366906829198, 0.0239370819242503, 
    0.0239370819242503, 0.00274462207058319, 0.00274462207058319, 
    1.17243038090577, 1.17243038090577, -0.273366906829197, -0.273366906829197, 
    6.54479953227488, 6.54479953227488, -0.361442939234647, -0.361442939234647, 
    -0.00644465331218001, -0.00644465331218001, 1.56556194846262, 
    1.56556194846262, 0.0239370819242502, 0.0239370819242502, -0.361442939234648, 
    -0.361442939234648, 5.93182594673928, 5.93182594673928, -0.204602385233392, 
    -0.204602385233392, 1.06988980588918, 1.06988980588918, 0.00274462207058321, 
    0.00274462207058321, -0.00644465331218008, -0.00644465331218008, 
    -0.204602385233392, -0.204602385233392, 0.866253880475053, 0.866253880475053, 
    0.850770380928311, 0.850770380928311, 1.17243038090577, 1.17243038090577, 
    1.56556194846262, 1.56556194846262, 1.06988980588918, 1.06988980588918, 
    0.850770380928312, 0.850770380928312, 2.9547519729988, 2.9547519729988
    ), dim = c(50L, 2L)), R = structure(c(2.96240897331513, 1.42238548072338, 
    0.417361718170828, 0.218899143583644, 0.181488154022618, 0.0785059709793652, 
    0.0194322452266972, 0.0103521416344979, 1.83626555995802, 0.891091637751762, 
    0.417361718170828, 0.218899143583644, 10.1434543553421, 5.14145677354892, 
    0.978147017146087, 0.487962654696781, 0.103068160412428, 0.0552264610695179, 
    3.50694460747186, 1.78958342885721, 0.181488154022618, 0.0785059709793652, 
    0.978147017146087, 0.487962654696781, 11.031411953902, 4.76481328555208, 
    0.119387259292939, 0.0584357929672563, 3.19791810224854, 1.54017974411235, 
    0.0194322452266972, 0.0103521416344979, 0.103068160412428, 0.0552264610695179, 
    0.119387259292939, 0.0584357929672563, 1.076643212419, 0.533937068328793, 
    0.840408791925489, 0.43779770546456, 1.83626555995802, 0.891091637751762, 
    3.50694460747186, 1.78958342885721, 3.19791810224854, 1.54017974411235, 
    0.840408791925489, 0.43779770546456, -1.52132333457777, -0.807845536912824, 
    1.42238548072338, 1.42238548072338, 0.218899143583644, 0.218899143583644, 
    0.0785059709793652, 0.0785059709793652, 0.0103521416344979, 0.0103521416344979, 
    0.891091637751762, 0.891091637751762, 0.218899143583644, 0.218899143583644, 
    5.14145677354892, 5.14145677354892, 0.487962654696781, 0.487962654696781, 
    0.0552264610695179, 0.0552264610695179, 1.78958342885721, 1.78958342885721, 
    0.0785059709793652, 0.0785059709793652, 0.487962654696781, 0.487962654696781, 
    4.76481328555208, 4.76481328555208, 0.0584357929672563, 0.0584357929672563, 
    1.54017974411235, 1.54017974411235, 0.0103521416344979, 0.0103521416344979, 
    0.0552264610695179, 0.0552264610695179, 0.0584357929672563, 0.0584357929672563, 
    0.533937068328793, 0.533937068328793, 0.43779770546456, 0.43779770546456, 
    0.891091637751762, 0.891091637751762, 1.78958342885721, 1.78958342885721, 
    1.54017974411235, 1.54017974411235, 0.43779770546456, 0.43779770546456, 
    -0.807845536912824, -0.807845536912824), dim = c(50L, 2L)))

# h_get_kr_comp works as expected on ar1h grouped mmrm

    list(P = structure(c(-0.718260171632992, -0.376656928472061, 
    -3.00843865658628, -1.40765750785259, -2.76391416003229, -1.07866695929769, 
    -0.431856139745158, -0.223854275009984, -2.43857162206673, -1.11194176460251, 
    -1.0942956942798, -0.493210001053829, -2.7534859528175, -1.48314024847623, 
    -3.53867477106767, -1.69313910910057, -0.235391027624912, -0.104161163793399, 
    -2.27890100144704, -1.18630188088423, -0.376656928472061, -0.376656928472061, 
    -1.40765750785259, -1.40765750785259, -1.07866695929769, -1.07866695929769, 
    -0.223854275009984, -0.223854275009984, -1.11194176460251, -1.11194176460251, 
    -0.493210001053829, -0.493210001053829, -1.48314024847623, -1.48314024847623, 
    -1.69313910910057, -1.69313910910057, -0.104161163793399, -0.104161163793399, 
    -1.18630188088423, -1.18630188088423), dim = c(20L, 2L)), Q = structure(c(1.61405151813123, 
    0.842304314976652, -0.194938371630068, -0.0963568841557508, 0.0151831896117182, 
    0.00600129895877371, 0.00222400715310905, 0.00136512716444657, 
    1.03021580973796, 0.521017635734831, -0.194938371630068, -0.0963568841557508, 
    6.49924886263715, 3.03241266433917, -0.289281557741161, -0.119594004843377, 
    0.00184837990662808, -0.0011467596348556, 1.64643807947665, 0.728347555279989, 
    0.0151831896117182, 0.0060012989587737, -0.28928155774116, -0.119594004843377, 
    5.9594577897997, 2.33712616841546, -0.157531101605681, -0.0661995439354867, 
    1.33499223250972, 0.564171470735483, 0.00222400715310904, 0.00136512716444657, 
    0.0018483799066281, -0.00114675963485559, -0.157531101605681, 
    -0.0661995439354867, 1.01717099403626, 0.513689726425864, 0.865497122409143, 
    0.410346867454723, 1.03021580973796, 0.521017635734831, 1.64643807947665, 
    0.728347555279989, 1.33499223250972, 0.564171470735483, 0.865497122409143, 
    0.410346867454723, 3.06915764749534, 1.39832890968095, 2.49619463451987, 
    1.14750942557791, -0.339307742580091, -0.183643101626147, 0.029313972341686, 
    0.0216458590558123, 0.00239052427812837, 0.000907819100087188, 
    1.34603884088911, 0.640031070999603, -0.33930774258009, -0.183643101626147, 
    6.30208832767771, 3.41176917161596, -0.441414889664325, -0.255569849674672, 
    -0.0143937897982884, -0.0062757233626728, 1.50911855360525, 0.851911284141987, 
    0.0293139723416859, 0.0216458590558122, -0.441414889664325, -0.255569849674672, 
    7.75847602783546, 3.76979060744093, -0.269025568377475, -0.149588398620923, 
    0.892434556838096, 0.447489969192127, 0.00239052427812837, 0.000907819100087192, 
    -0.0143937897982884, -0.00627572336267279, -0.269025568377476, 
    -0.149588398620923, 0.75181088914746, 0.363278630470307, 0.810210051561633, 
    0.433171437434735, 1.34603884088911, 0.640031070999604, 1.50911855360525, 
    0.851911284141986, 0.892434556838097, 0.447489969192127, 0.810210051561632, 
    0.433171437434735, 2.94117697334452, 1.56921183169663, 0.842304314976652, 
    0.842304314976652, -0.0963568841557508, -0.0963568841557508, 
    0.00600129895877371, 0.00600129895877371, 0.00136512716444657, 
    0.00136512716444657, 0.521017635734831, 0.521017635734831, -0.0963568841557508, 
    -0.0963568841557508, 3.03241266433917, 3.03241266433917, -0.119594004843377, 
    -0.119594004843377, -0.0011467596348556, -0.0011467596348556, 
    0.728347555279989, 0.728347555279989, 0.0060012989587737, 0.0060012989587737, 
    -0.119594004843377, -0.119594004843377, 2.33712616841546, 2.33712616841546, 
    -0.0661995439354867, -0.0661995439354867, 0.564171470735483, 
    0.564171470735483, 0.00136512716444657, 0.00136512716444657, 
    -0.00114675963485559, -0.00114675963485559, -0.0661995439354867, 
    -0.0661995439354867, 0.513689726425864, 0.513689726425864, 0.410346867454723, 
    0.410346867454723, 0.521017635734831, 0.521017635734831, 0.728347555279989, 
    0.728347555279989, 0.564171470735483, 0.564171470735483, 0.410346867454723, 
    0.410346867454723, 1.39832890968095, 1.39832890968095, 1.14750942557791, 
    1.14750942557791, -0.183643101626147, -0.183643101626147, 0.0216458590558123, 
    0.0216458590558123, 0.000907819100087188, 0.000907819100087188, 
    0.640031070999603, 0.640031070999603, -0.183643101626147, -0.183643101626147, 
    3.41176917161596, 3.41176917161596, -0.255569849674672, -0.255569849674672, 
    -0.0062757233626728, -0.0062757233626728, 0.851911284141987, 
    0.851911284141987, 0.0216458590558122, 0.0216458590558122, -0.255569849674672, 
    -0.255569849674672, 3.76979060744093, 3.76979060744093, -0.149588398620923, 
    -0.149588398620923, 0.447489969192127, 0.447489969192127, 0.000907819100087192, 
    0.000907819100087192, -0.00627572336267279, -0.00627572336267279, 
    -0.149588398620923, -0.149588398620923, 0.363278630470307, 0.363278630470307, 
    0.433171437434735, 0.433171437434735, 0.640031070999604, 0.640031070999604, 
    0.851911284141986, 0.851911284141986, 0.447489969192127, 0.447489969192127, 
    0.433171437434735, 0.433171437434735, 1.56921183169663, 1.56921183169663
    ), dim = c(100L, 2L)), R = structure(c(1.20638214030796, 0.636783855257291, 
    0.171668344709015, 0.0880587756730742, 0.0494727932997941, 0.023466446363362, 
    0.00899706494922053, 0.00500477965039436, 0.75725696379412, 0.381690648762004, 
    0.171668344709015, 0.0880587756730742, 5.31975454981535, 2.50375298782224, 
    0.47219814892482, 0.194822077785761, 0.0532562697233614, 0.0286811744241045, 
    1.90934126580531, 0.865749651756116, 0.0494727932997941, 0.023466446363362, 
    0.47219814892482, 0.194822077785761, 4.92410443522873, 1.90423810512876, 
    0.0820529426112383, 0.0348072893174903, 1.66206052843889, 0.703713339497124, 
    0.00899706494922053, 0.00500477965039436, 0.0532562697233614, 
    0.0286811744241045, 0.0820529426112383, 0.0348072893174903, 0.719406002206497, 
    0.379215306627979, 0.548484486095152, 0.272729889189781, 0.75725696379412, 
    0.381690648762004, 1.90934126580531, 0.865749651756116, 1.66206052843889, 
    0.703713339497124, 0.548484486095152, 0.272729889189781, -0.601804605067262, 
    -0.170663841213831, 1.78901201618981, 0.791450839152809, 0.241348862680719, 
    0.128079214815883, 0.150213923833012, 0.0629172850722615, 0.00801658585605418, 
    0.00397266306670601, 1.0918922361035, 0.51298351486652, 0.241348862680719, 
    0.128079214815883, 4.7220221838332, 2.52596158517651, 0.496240545049418, 
    0.288721088789936, 0.0473603140716624, 0.0235186081701361, 1.60613353693086, 
    0.895081116846602, 0.150213923833012, 0.0629172850722615, 0.496240545049418, 
    0.288721088789936, 6.40673970392387, 3.02147969375636, 0.0241553693290422, 
    0.0131601505825947, 1.58396813123353, 0.825375973293336, 0.00801658585605418, 
    0.00397266306670601, 0.0473603140716624, 0.0235186081701361, 
    0.0241553693290422, 0.0131601505825947, 0.391249785993066, 0.167670905767361, 
    0.275808098626194, 0.139163156761993, 1.0918922361035, 0.51298351486652, 
    1.60613353693086, 0.895081116846602, 1.58396813123353, 0.825375973293337, 
    0.275808098626194, 0.139163156761993, -0.852400645250967, -0.570443244254977, 
    0.636783855257291, 0.636783855257291, 0.0880587756730742, 0.0880587756730742, 
    0.023466446363362, 0.023466446363362, 0.00500477965039436, 0.00500477965039436, 
    0.381690648762004, 0.381690648762004, 0.0880587756730742, 0.0880587756730742, 
    2.50375298782224, 2.50375298782224, 0.194822077785761, 0.194822077785761, 
    0.0286811744241045, 0.0286811744241045, 0.865749651756116, 0.865749651756116, 
    0.023466446363362, 0.023466446363362, 0.194822077785761, 0.194822077785761, 
    1.90423810512876, 1.90423810512876, 0.0348072893174903, 0.0348072893174903, 
    0.703713339497124, 0.703713339497124, 0.00500477965039436, 0.00500477965039436, 
    0.0286811744241045, 0.0286811744241045, 0.0348072893174903, 0.0348072893174903, 
    0.379215306627979, 0.379215306627979, 0.272729889189781, 0.272729889189781, 
    0.381690648762004, 0.381690648762004, 0.865749651756116, 0.865749651756116, 
    0.703713339497124, 0.703713339497124, 0.272729889189781, 0.272729889189781, 
    -0.170663841213831, -0.170663841213831, 0.791450839152809, 0.791450839152809, 
    0.128079214815883, 0.128079214815883, 0.0629172850722615, 0.0629172850722615, 
    0.00397266306670601, 0.00397266306670601, 0.51298351486652, 0.51298351486652, 
    0.128079214815883, 0.128079214815883, 2.52596158517651, 2.52596158517651, 
    0.288721088789936, 0.288721088789936, 0.0235186081701361, 0.0235186081701361, 
    0.895081116846602, 0.895081116846602, 0.0629172850722615, 0.0629172850722615, 
    0.288721088789936, 0.288721088789936, 3.02147969375636, 3.02147969375636, 
    0.0131601505825947, 0.0131601505825947, 0.825375973293336, 0.825375973293336, 
    0.00397266306670601, 0.00397266306670601, 0.0235186081701361, 
    0.0235186081701361, 0.0131601505825947, 0.0131601505825947, 0.167670905767361, 
    0.167670905767361, 0.139163156761993, 0.139163156761993, 0.51298351486652, 
    0.51298351486652, 0.895081116846602, 0.895081116846602, 0.825375973293337, 
    0.825375973293337, 0.139163156761993, 0.139163156761993, -0.570443244254977, 
    -0.570443244254977), dim = c(100L, 2L)))

# h_get_kr_comp works as expected on cs ungrouped mmrm

    list(P = structure(c(-12.6467669835108, -6.16330011417841, -12.3347599528103, 
    -6.25879150544113, -6.16330011417841, -6.16330011417841, -6.25879150544113, 
    -6.25879150544113), dim = c(4L, 2L)), Q = structure(c(25.2935339670216, 
    12.3266002283568, 24.6695199056206, 12.5175830108823, 24.6695199056206, 
    12.5175830108823, 27.7268601940156, 14.445200476913, 12.3266002283568, 
    12.3266002283568, 12.5175830108823, 12.5175830108823, 12.5175830108823, 
    12.5175830108823, 14.445200476913, 14.445200476913), dim = c(8L, 
    2L)), R = structure(c(25.2935339670216, 12.3266002283568, 24.6695199056206, 
    12.5175830108823, 24.6695199056206, 12.5175830108823, -0.50996481636375, 
    -0.258761700506712, 12.3266002283568, 12.3266002283568, 12.5175830108823, 
    12.5175830108823, 12.5175830108823, 12.5175830108823, -0.258761700506712, 
    -0.258761700506712), dim = c(8L, 2L)))

# h_get_kr_comp works as expected on cs grouped mmrm

    list(P = structure(c(-5.79040987039101, -2.69622359371823, -5.54006698106742, 
    -2.61470704194564, -6.85238176173803, -3.4693427118829, -6.78847471226715, 
    -3.65278553240862, -2.69622359371823, -2.69622359371823, -2.61470704194564, 
    -2.61470704194564, -3.4693427118829, -3.4693427118829, -3.65278553240862, 
    -3.65278553240862), dim = c(8L, 2L)), Q = structure(c(11.580819740782, 
    5.39244718743646, 11.0801339621348, 5.22941408389129, 11.0801339621348, 
    5.22941408389129, 12.2063377093331, 5.76659516650927, 13.7047635234761, 
    6.9386854237658, 13.5769494245343, 7.30557106481723, 13.5769494245343, 
    7.30557106481723, 15.5103171982089, 8.72656270524852, 5.39244718743646, 
    5.39244718743646, 5.22941408389129, 5.22941408389129, 5.22941408389129, 
    5.22941408389129, 5.76659516650927, 5.76659516650927, 6.9386854237658, 
    6.9386854237658, 7.30557106481723, 7.30557106481723, 7.30557106481723, 
    7.30557106481723, 8.72656270524852, 8.72656270524852), dim = c(16L, 
    2L)), R = structure(c(11.580819740782, 5.39244718743646, 11.0801339621348, 
    5.22941408389129, 11.0801339621348, 5.22941408389129, -0.30931020819444, 
    -0.145982996645259, 13.704763523476, 6.9386854237658, 13.5769494245343, 
    7.30557106481723, 13.5769494245343, 7.30557106481723, -0.204804177059731, 
    -0.110202330663289, 5.39244718743646, 5.39244718743646, 5.22941408389129, 
    5.22941408389129, 5.22941408389129, 5.22941408389129, -0.145982996645259, 
    -0.145982996645259, 6.9386854237658, 6.9386854237658, 7.30557106481723, 
    7.30557106481723, 7.30557106481723, 7.30557106481723, -0.110202330663289, 
    -0.110202330663289), dim = c(16L, 2L)))

# h_get_kr_comp works as expected on csh ungrouped mmrm

    list(P = structure(c(-2.03701262608935, -1.00052247776723, -7.05923690958296, 
    -3.57799336955767, -8.16203988746347, -3.63862848227887, -1.07833827077964, 
    -0.53193609434129, -11.9031880039272, -5.93495681527675, -1.00052247776723, 
    -1.00052247776723, -3.57799336955767, -3.57799336955767, -3.63862848227887, 
    -3.63862848227887, -0.53193609434129, -0.53193609434129, -5.93495681527675, 
    -5.93495681527675), dim = c(10L, 2L)), Q = structure(c(4.18044917735307, 
    2.05482294917959, -0.0407848324886912, -0.0209703608295715, -0.0396118677345096, 
    -0.0186152239479709, -0.0260272249511593, -0.0141924088675787, 
    5.07626172482924, 2.50457037319024, -0.0407848324886912, -0.0209703608295715, 
    14.2398180613698, 7.21810271039126, -0.0399716788726617, -0.0198730848403028, 
    -0.0405877308424876, -0.0212725256060485, 7.5299681999349, 3.83018107293988, 
    -0.0396118677345096, -0.0186152239479709, -0.0399716788726621, 
    -0.019873084840303, 16.4436665422894, 7.33574262607663, -0.0400032207552723, 
    -0.0199973527306222, 7.20794308632108, 3.49372081136179, -0.0260272249511593, 
    -0.0141924088675787, -0.0405877308424876, -0.0212725256060485, 
    -0.0400032207552724, -0.0199973527306222, 2.26329471810819, 1.11933447588683, 
    3.99220299676926, 2.04144137306159, 5.07626172482924, 2.50457037319024, 
    7.5299681999349, 3.83018107293988, 7.20794308632108, 3.49372081136179, 
    3.99220299676926, 2.04144137306159, 24.8523743719767, 12.6002411792785, 
    2.05482294917959, 2.05482294917959, -0.0209703608295715, -0.0209703608295715, 
    -0.0186152239479709, -0.0186152239479709, -0.0141924088675787, 
    -0.0141924088675787, 2.50457037319024, 2.50457037319024, -0.0209703608295715, 
    -0.0209703608295715, 7.21810271039126, 7.21810271039126, -0.0198730848403028, 
    -0.0198730848403028, -0.0212725256060485, -0.0212725256060485, 
    3.83018107293988, 3.83018107293988, -0.0186152239479709, -0.0186152239479709, 
    -0.019873084840303, -0.019873084840303, 7.33574262607663, 7.33574262607663, 
    -0.0199973527306222, -0.0199973527306222, 3.49372081136179, 3.49372081136179, 
    -0.0141924088675787, -0.0141924088675787, -0.0212725256060485, 
    -0.0212725256060485, -0.0199973527306222, -0.0199973527306222, 
    1.11933447588683, 1.11933447588683, 2.04144137306159, 2.04144137306159, 
    2.50457037319024, 2.50457037319024, 3.83018107293988, 3.83018107293988, 
    3.49372081136179, 3.49372081136179, 2.04144137306159, 2.04144137306159, 
    12.6002411792785, 12.6002411792785), dim = c(50L, 2L)), R = structure(c(3.62646015171492, 
    1.77994657150706, 0.194577174570883, 0.101524296412967, 0.187676877584633, 
    0.0848483696009194, 0.0653110483082618, 0.0347257180135227, 4.65890587412076, 
    2.30151224712676, 0.194577174570883, 0.101524296412967, 13.3526664842825, 
    6.76574174074506, 0.440383367043367, 0.219945863885872, 0.130846793269214, 
    0.0687748380714383, 7.97163203126489, 4.06223522202594, 0.187676877584633, 
    0.0848483696009194, 0.440383367043367, 0.219945863885872, 15.5713163648869, 
    6.9121308813966, 0.12470316541203, 0.0603318496743565, 7.83585196706486, 
    3.80076116719439, 0.0653110483082618, 0.0347257180135227, 0.130846793269214, 
    0.0687748380714383, 0.12470316541203, 0.0603318496743565, 1.83581553456977, 
    0.900039782923264, 3.33998613540399, 1.70540499420641, 4.65890587412076, 
    2.30151224712676, 7.97163203126489, 4.06223522202594, 7.83585196706486, 
    3.80076116719439, 3.33998613540399, 1.70540499420641, -3.36914441237685, 
    -1.67986312450835, 1.77994657150706, 1.77994657150706, 0.101524296412967, 
    0.101524296412967, 0.0848483696009194, 0.0848483696009194, 0.0347257180135227, 
    0.0347257180135227, 2.30151224712676, 2.30151224712676, 0.101524296412967, 
    0.101524296412967, 6.76574174074506, 6.76574174074506, 0.219945863885872, 
    0.219945863885872, 0.0687748380714383, 0.0687748380714383, 4.06223522202594, 
    4.06223522202594, 0.0848483696009194, 0.0848483696009194, 0.219945863885872, 
    0.219945863885872, 6.9121308813966, 6.9121308813966, 0.0603318496743565, 
    0.0603318496743565, 3.80076116719439, 3.80076116719439, 0.0347257180135227, 
    0.0347257180135227, 0.0687748380714383, 0.0687748380714383, 0.0603318496743565, 
    0.0603318496743565, 0.900039782923264, 0.900039782923264, 1.70540499420641, 
    1.70540499420641, 2.30151224712676, 2.30151224712676, 4.06223522202594, 
    4.06223522202594, 3.80076116719439, 3.80076116719439, 1.70540499420641, 
    1.70540499420641, -1.67986312450835, -1.67986312450835), dim = c(50L, 
    2L)))

# h_get_kr_comp works as expected on csh grouped mmrm

    list(P = structure(c(-0.808423004039597, -0.42303528589623, -3.51395286784669, 
    -1.62808167702558, -3.66900095545319, -1.44462727308772, -0.561212736828637, 
    -0.275003207847231, -5.43263017639977, -2.46445513379045, -1.25145829463279, 
    -0.581848153274448, -3.53389060408957, -1.9242252079518, -4.58448065520947, 
    -2.24065885624875, -0.533419159079337, -0.265464016029177, -6.58726486945041, 
    -3.52120809211001, -0.42303528589623, -0.42303528589623, -1.62808167702558, 
    -1.62808167702558, -1.44462727308772, -1.44462727308772, -0.275003207847231, 
    -0.275003207847231, -2.46445513379045, -2.46445513379045, -0.581848153274448, 
    -0.581848153274448, -1.9242252079518, -1.9242252079518, -2.24065885624875, 
    -2.24065885624875, -0.265464016029177, -0.265464016029177, -3.52120809211001, 
    -3.52120809211001), dim = c(20L, 2L)), Q = structure(c(1.66842157990971, 
    0.871133663761099, -0.0209008142650711, -0.0100305523961556, 
    -0.0178269921929883, -0.00793341607742487, -0.0128477653724519, 
    -0.0070991234950584, 2.06949458234312, 1.02875752677384, -0.0209008142650711, 
    -0.0100305523961556, 7.0924352984277, 3.28527781088797, -0.0211513192481603, 
    -0.00876052658648782, -0.0224774292210814, -0.0103233778541602, 
    3.58347745264035, 1.60158544044135, -0.0178269921929883, -0.00793341607742488, 
    -0.0211513192481604, -0.00876052658648785, 7.39755207694861, 
    2.91451790593945, -0.0205718546010929, -0.00856941710009696, 
    3.2619138037878, 1.37406680318752, -0.0128477653724519, -0.00709912349505842, 
    -0.0224774292210815, -0.0103233778541603, -0.0205718546010929, 
    -0.00856941710009696, 1.1783225228519, 0.575998334143778, 1.95037451402827, 
    0.924500497178181, 2.06949458234312, 1.02875752677384, 3.58347745264035, 
    1.60158544044135, 3.2619138037878, 1.37406680318752, 1.95037451402827, 
    0.924500497178181, 11.2859622756427, 5.13653371726492, 2.55645673949381, 
    1.1915137370751, -0.0195671123949259, -0.0106330610200356, -0.0210355375405398, 
    -0.0102002681095835, -0.0129375002927734, -0.00698410139658193, 
    3.06445491567787, 1.50665726039307, -0.0195671123949259, -0.0106330610200356, 
    7.12411361043572, 3.88037443234093, -0.018782332161554, -0.0107604586347984, 
    -0.0179829577000994, -0.0105304967825001, 3.9923549887729, 2.24811368178813, 
    -0.0210355375405397, -0.0102002681095835, -0.018782332161554, 
    -0.0107604586347984, 9.22808909653114, 4.51328389050564, -0.0193099164101076, 
    -0.0110054512637606, 4.04214758135205, 2.15907062883514, -0.0129375002927734, 
    -0.00698410139658194, -0.0179829577000994, -0.0105304967825001, 
    -0.0193099164101075, -0.0110054512637606, 1.11706869256165, 0.559448081501197, 
    2.075572253098, 1.12857461320368, 3.06445491567787, 1.50665726039307, 
    3.9923549887729, 2.24811368178813, 4.04214758135205, 2.15907062883514, 
    2.075572253098, 1.12857461320368, 13.8603912746329, 7.62661624062883, 
    0.871133663761099, 0.871133663761099, -0.0100305523961556, -0.0100305523961556, 
    -0.00793341607742487, -0.00793341607742487, -0.0070991234950584, 
    -0.0070991234950584, 1.02875752677384, 1.02875752677384, -0.0100305523961556, 
    -0.0100305523961556, 3.28527781088797, 3.28527781088797, -0.00876052658648782, 
    -0.00876052658648782, -0.0103233778541602, -0.0103233778541602, 
    1.60158544044135, 1.60158544044135, -0.00793341607742488, -0.00793341607742488, 
    -0.00876052658648785, -0.00876052658648785, 2.91451790593945, 
    2.91451790593945, -0.00856941710009696, -0.00856941710009696, 
    1.37406680318752, 1.37406680318752, -0.00709912349505842, -0.00709912349505842, 
    -0.0103233778541603, -0.0103233778541603, -0.00856941710009696, 
    -0.00856941710009696, 0.575998334143778, 0.575998334143778, 0.924500497178181, 
    0.924500497178181, 1.02875752677384, 1.02875752677384, 1.60158544044135, 
    1.60158544044135, 1.37406680318752, 1.37406680318752, 0.924500497178181, 
    0.924500497178181, 5.13653371726492, 5.13653371726492, 1.1915137370751, 
    1.1915137370751, -0.0106330610200356, -0.0106330610200356, -0.0102002681095835, 
    -0.0102002681095835, -0.00698410139658193, -0.00698410139658193, 
    1.50665726039307, 1.50665726039307, -0.0106330610200356, -0.0106330610200356, 
    3.88037443234093, 3.88037443234093, -0.0107604586347984, -0.0107604586347984, 
    -0.0105304967825001, -0.0105304967825001, 2.24811368178813, 2.24811368178813, 
    -0.0102002681095835, -0.0102002681095835, -0.0107604586347984, 
    -0.0107604586347984, 4.51328389050564, 4.51328389050564, -0.0110054512637606, 
    -0.0110054512637606, 2.15907062883514, 2.15907062883514, -0.00698410139658194, 
    -0.00698410139658194, -0.0105304967825001, -0.0105304967825001, 
    -0.0110054512637606, -0.0110054512637606, 0.559448081501197, 
    0.559448081501197, 1.12857461320368, 1.12857461320368, 1.50665726039307, 
    1.50665726039307, 2.24811368178813, 2.24811368178813, 2.15907062883514, 
    2.15907062883514, 1.12857461320368, 1.12857461320368, 7.62661624062883, 
    7.62661624062883), dim = c(100L, 2L)), R = structure(c(1.43013019887986, 
    0.75250367968948, 0.0869588595738112, 0.0444342812523745, 0.0668747805230002, 
    0.0305368954583644, 0.0328821691025214, 0.0185957153922416, 1.84686708407433, 
    0.925500705725709, 0.0869588595738112, 0.0444342812523745, 6.64005555201499, 
    3.08192390073833, 0.22998071825887, 0.0950020182115941, 0.0709106058457135, 
    0.0348031538488619, 3.83635290905174, 1.72345937095788, 0.0668747805230002, 
    0.0305368954583644, 0.22998071825887, 0.0950020182115941, 6.97952185018945, 
    2.73793455592097, 0.0616245619350529, 0.0257810765845161, 3.54584342522518, 
    1.49675547218975, 0.0328821691025214, 0.0185957153922416, 0.0709106058457135, 
    0.0348031538488619, 0.0616245619350529, 0.0257810765845161, 0.957008136773988, 
    0.470826469868843, 1.63619693444828, 0.783194718707559, 1.84686708407433, 
    0.925500705725709, 3.83635290905174, 1.72345937095788, 3.54584342522518, 
    1.49675547218975, 1.63619693444828, 0.783194718707559, -1.61516767587601, 
    -0.732703707319704, 2.24407478047685, 1.03665537792168, 0.105040994363005, 
    0.0559337749841914, 0.121433656100556, 0.0549643542120603, 0.0323671583251628, 
    0.0161427994309649, 2.87144405597379, 1.40931992817964, 0.105040994363005, 
    0.0559337749841914, 6.6913492633272, 3.63649020985092, 0.210476580668222, 
    0.122000440002419, 0.0609143698207194, 0.0340259910660731, 4.17592225762125, 
    2.35136617465746, 0.121433656100556, 0.0549643542120603, 0.210476580668222, 
    0.122000440002419, 8.77348520041339, 4.27000651197236, 0.0635658732367762, 
    0.0343464063106608, 4.38718741253271, 2.3441664758411, 0.0323671583251628, 
    0.0161427994309649, 0.0609143698207194, 0.0340259910660731, 0.0635658732367762, 
    0.0343464063106608, 0.909990916776014, 0.446412835250656, 1.73997601277306, 
    0.937563605541819, 2.87144405597379, 1.40931992817964, 4.17592225762125, 
    2.35136617465746, 4.38718741253272, 2.3441664758411, 1.73997601277306, 
    0.937563605541819, -1.75324099255011, -0.937191154862655, 0.75250367968948, 
    0.75250367968948, 0.0444342812523745, 0.0444342812523745, 0.0305368954583644, 
    0.0305368954583644, 0.0185957153922416, 0.0185957153922416, 0.925500705725709, 
    0.925500705725709, 0.0444342812523745, 0.0444342812523745, 3.08192390073833, 
    3.08192390073833, 0.0950020182115941, 0.0950020182115941, 0.0348031538488619, 
    0.0348031538488619, 1.72345937095788, 1.72345937095788, 0.0305368954583644, 
    0.0305368954583644, 0.0950020182115941, 0.0950020182115941, 2.73793455592097, 
    2.73793455592097, 0.0257810765845161, 0.0257810765845161, 1.49675547218975, 
    1.49675547218975, 0.0185957153922416, 0.0185957153922416, 0.0348031538488619, 
    0.0348031538488619, 0.0257810765845161, 0.0257810765845161, 0.470826469868843, 
    0.470826469868843, 0.783194718707559, 0.783194718707559, 0.925500705725709, 
    0.925500705725709, 1.72345937095788, 1.72345937095788, 1.49675547218975, 
    1.49675547218975, 0.783194718707559, 0.783194718707559, -0.732703707319704, 
    -0.732703707319704, 1.03665537792168, 1.03665537792168, 0.0559337749841914, 
    0.0559337749841914, 0.0549643542120603, 0.0549643542120603, 0.0161427994309649, 
    0.0161427994309649, 1.40931992817964, 1.40931992817964, 0.0559337749841914, 
    0.0559337749841914, 3.63649020985092, 3.63649020985092, 0.122000440002419, 
    0.122000440002419, 0.0340259910660731, 0.0340259910660731, 2.35136617465746, 
    2.35136617465746, 0.0549643542120603, 0.0549643542120603, 0.122000440002419, 
    0.122000440002419, 4.27000651197236, 4.27000651197236, 0.0343464063106608, 
    0.0343464063106608, 2.3441664758411, 2.3441664758411, 0.0161427994309649, 
    0.0161427994309649, 0.0340259910660731, 0.0340259910660731, 0.0343464063106608, 
    0.0343464063106608, 0.446412835250656, 0.446412835250656, 0.937563605541819, 
    0.937563605541819, 1.40931992817964, 1.40931992817964, 2.35136617465746, 
    2.35136617465746, 2.3441664758411, 2.3441664758411, 0.937563605541819, 
    0.937563605541819, -0.937191154862655, -0.937191154862655), dim = c(100L, 
    2L)))

# h_get_kr_comp works as expected on toep ungrouped mmrm

    list(P = structure(c(-10.4649919809507, -5.09980194330786, -1.56048137311846, 
    -0.808812406678307, -2.48927157235529, -1.16791552528374, -2.77399300774652, 
    -1.49122481144767, -5.09980194330786, -5.09980194330786, -0.808812406678307, 
    -0.808812406678307, -1.16791552528374, -1.16791552528374, -1.49122481144767, 
    -1.49122481144767), dim = c(8L, 2L)), Q = structure(c(20.9299839619014, 
    10.1996038866157, 3.12096274623692, 1.61762481335661, 4.97854314471058, 
    2.33583105056747, 5.54798601549304, 2.98244962289535, 3.12096274623691, 
    1.61762481335661, 2.39381101566067, 1.14080841847656, 0.788915646491231, 
    0.526403375819015, -0.182914095108906, -0.1061023225055, 4.97854314471058, 
    2.33583105056747, 0.788915646491231, 0.526403375819015, 3.4876901449821, 
    1.62422435316422, -0.225379504120805, -0.115180771384814, 5.54798601549304, 
    2.98244962289535, -0.182914095108907, -0.1061023225055, -0.225379504120805, 
    -0.115180771384813, 4.00434285654571, 2.15522666817699, 10.1996038866157, 
    10.1996038866157, 1.61762481335661, 1.61762481335661, 2.33583105056747, 
    2.33583105056747, 2.98244962289535, 2.98244962289535, 1.61762481335661, 
    1.61762481335661, 1.14080841847656, 1.14080841847656, 0.526403375819015, 
    0.526403375819015, -0.1061023225055, -0.1061023225055, 2.33583105056747, 
    2.33583105056747, 0.526403375819015, 0.526403375819015, 1.62422435316422, 
    1.62422435316422, -0.115180771384814, -0.115180771384814, 2.98244962289535, 
    2.98244962289535, -0.1061023225055, -0.1061023225055, -0.115180771384813, 
    -0.115180771384813, 2.15522666817699, 2.15522666817699), dim = c(32L, 
    2L)), R = structure(c(20.9299839619014, 10.1996038866157, 3.12096274623692, 
    1.61762481335661, 4.97854314471058, 2.33583105056747, 5.54798601549304, 
    2.98244962289535, 3.12096274623692, 1.61762481335661, -1.8138633962374, 
    -0.940142730422131, 1.70194758263057e-15, 9.56685996663469e-16, 
    -1.56803271802754e-15, -8.01565031335252e-16, 4.97854314471058, 
    2.33583105056747, -8.57643629068556e-16, -2.99012038864644e-16, 
    -0.172174431287057, -0.08078073665815, -2.91009233818094e-16, 
    -1.553651241983e-16, 5.54798601549304, 2.98244962289535, -5.9467830854063e-16, 
    -3.023936195487e-16, 1.31769195754743e-15, 6.68990398368701e-16, 
    2.13528218072949, 1.14787087006128, 10.1996038866157, 10.1996038866157, 
    1.61762481335661, 1.61762481335661, 2.33583105056747, 2.33583105056747, 
    2.98244962289535, 2.98244962289535, 1.61762481335661, 1.61762481335661, 
    -0.940142730422131, -0.940142730422131, 9.56685996663469e-16, 
    9.56685996663469e-16, -8.01565031335252e-16, -8.01565031335252e-16, 
    2.33583105056747, 2.33583105056747, -2.99012038864644e-16, -2.99012038864644e-16, 
    -0.08078073665815, -0.08078073665815, -1.553651241983e-16, -1.553651241983e-16, 
    2.98244962289535, 2.98244962289535, -3.023936195487e-16, -3.023936195487e-16, 
    6.68990398368701e-16, 6.68990398368701e-16, 1.14787087006128, 
    1.14787087006128), dim = c(32L, 2L)))

# h_get_kr_comp works as expected on toep grouped mmrm

    list(P = structure(c(-4.77897465405157, -2.29386935385607, -0.793072415826694, 
    -0.374727333344531, -1.03995722991535, -0.478399236048439, -1.28519417397142, 
    -0.718022024194972, -5.70169720180231, -2.80911672522844, -0.767745383815121, 
    -0.425567819567383, -1.4568430061353, -0.694947215857784, -1.49112838670037, 
    -0.772726547700233, -2.29386935385607, -2.29386935385607, -0.374727333344531, 
    -0.374727333344531, -0.478399236048439, -0.478399236048439, -0.718022024194972, 
    -0.718022024194972, -2.80911672522844, -2.80911672522844, -0.425567819567383, 
    -0.425567819567383, -0.694947215857784, -0.694947215857784, -0.772726547700233, 
    -0.772726547700233), dim = c(16L, 2L)), Q = structure(c(9.55794930810314, 
    4.58773870771214, 1.58614483165339, 0.749454666689062, 2.07991445983069, 
    0.956798472096877, 2.57038834794284, 1.43604404838994, 1.58614483165339, 
    0.749454666689062, 1.08479590239467, 0.468142315398684, 0.390107557765571, 
    0.250423234368456, -0.0513606761411175, -0.0232584601838305, 
    2.07991445983069, 0.956798472096877, 0.39010755776557, 0.250423234368456, 
    1.37637431223237, 0.644632813061845, -0.053205257900069, -0.0358651307463664, 
    2.57038834794284, 1.43604404838994, -0.0513606761411175, -0.0232584601838305, 
    -0.0532052579000692, -0.0358651307463664, 1.79317462933322, 1.00314909048537, 
    11.4033944036046, 5.61823345045688, 1.53549076763024, 0.851135639134766, 
    2.9136860122706, 1.38989443171557, 2.98225677340074, 1.54545309540046, 
    1.53549076763024, 0.851135639134766, 1.33186315281313, 0.685827364006526, 
    0.395124600696467, 0.261628037489687, -0.138182513747744, -0.0856897842546906, 
    2.9136860122706, 1.38989443171557, 0.395124600696467, 0.261628037489687, 
    2.14851764031506, 1.00163097334135, -0.184710056369491, -0.0833486805934527, 
    2.98225677340074, 1.54545309540046, -0.138182513747744, -0.0856897842546906, 
    -0.184710056369491, -0.0833486805934525, 2.22076205079775, 1.15214113793894, 
    4.58773870771214, 4.58773870771214, 0.749454666689062, 0.749454666689062, 
    0.956798472096877, 0.956798472096877, 1.43604404838994, 1.43604404838994, 
    0.749454666689062, 0.749454666689062, 0.468142315398684, 0.468142315398684, 
    0.250423234368456, 0.250423234368456, -0.0232584601838305, -0.0232584601838305, 
    0.956798472096877, 0.956798472096877, 0.250423234368456, 0.250423234368456, 
    0.644632813061845, 0.644632813061845, -0.0358651307463664, -0.0358651307463664, 
    1.43604404838994, 1.43604404838994, -0.0232584601838305, -0.0232584601838305, 
    -0.0358651307463664, -0.0358651307463664, 1.00314909048537, 1.00314909048537, 
    5.61823345045688, 5.61823345045688, 0.851135639134766, 0.851135639134766, 
    1.38989443171557, 1.38989443171557, 1.54545309540046, 1.54545309540046, 
    0.851135639134766, 0.851135639134766, 0.685827364006526, 0.685827364006526, 
    0.261628037489687, 0.261628037489687, -0.0856897842546906, -0.0856897842546906, 
    1.38989443171557, 1.38989443171557, 0.261628037489687, 0.261628037489687, 
    1.00163097334135, 1.00163097334135, -0.0833486805934527, -0.0833486805934527, 
    1.54545309540046, 1.54545309540046, -0.0856897842546906, -0.0856897842546906, 
    -0.0833486805934525, -0.0833486805934525, 1.15214113793894, 1.15214113793894
    ), dim = c(64L, 2L)), R = structure(c(9.55794930810314, 4.58773870771214, 
    1.58614483165339, 0.749454666689062, 2.07991445983069, 0.956798472096877, 
    2.57038834794284, 1.43604404838994, 1.58614483165339, 0.749454666689062, 
    -0.883034458750025, -0.41723446859995, -1.18015865112958e-16, 
    -4.69890136130028e-17, -4.17217435446425e-16, -2.10414226674813e-16, 
    2.07991445983069, 0.956798472096877, 8.01364931809665e-16, 4.01139655344015e-16, 
    -0.13043312001117, -0.0600016069640068, 5.72259535084501e-17, 
    2.53490057568381e-17, 2.57038834794284, 1.43604404838994, -9.5063694619071e-17, 
    -4.75324707811443e-17, 3.60000567587197e-16, 1.82529291627502e-16, 
    0.91271179187259, 0.509920743168223, 11.4033944036046, 5.61823345045688, 
    1.53549076763024, 0.851135639134766, 2.9136860122706, 1.38989443171557, 
    2.98225677340074, 1.54545309540047, 1.53549076763024, 0.851135639134766, 
    -0.922181347520019, -0.511172992483027, 4.70282754075449e-16, 
    2.3568317251726e-16, -3.20161456300972e-17, -2.45534480440682e-17, 
    2.9136860122706, 1.38989443171557, 6.76534931017288e-17, 3.7224724001313e-17, 
    -0.0323250012977548, -0.0154197600976008, 4.46116797140687e-16, 
    2.30121641236407e-16, 2.98225677340074, 1.54545309540047, -6.65176478118635e-16, 
    -3.50383008868953e-16, 1.87043535347851e-16, 9.57079195884779e-17, 
    1.22400228299058, 0.634297533967185, 4.58773870771214, 4.58773870771214, 
    0.749454666689062, 0.749454666689062, 0.956798472096877, 0.956798472096877, 
    1.43604404838994, 1.43604404838994, 0.749454666689062, 0.749454666689062, 
    -0.41723446859995, -0.41723446859995, -4.69890136130028e-17, 
    -4.69890136130028e-17, -2.10414226674813e-16, -2.10414226674813e-16, 
    0.956798472096877, 0.956798472096877, 4.01139655344015e-16, 4.01139655344015e-16, 
    -0.0600016069640068, -0.0600016069640068, 2.53490057568381e-17, 
    2.53490057568381e-17, 1.43604404838994, 1.43604404838994, -4.75324707811443e-17, 
    -4.75324707811443e-17, 1.82529291627502e-16, 1.82529291627502e-16, 
    0.509920743168223, 0.509920743168223, 5.61823345045688, 5.61823345045688, 
    0.851135639134766, 0.851135639134766, 1.38989443171557, 1.38989443171557, 
    1.54545309540047, 1.54545309540047, 0.851135639134766, 0.851135639134766, 
    -0.511172992483027, -0.511172992483027, 2.3568317251726e-16, 
    2.3568317251726e-16, -2.45534480440682e-17, -2.45534480440682e-17, 
    1.38989443171557, 1.38989443171557, 3.7224724001313e-17, 3.7224724001313e-17, 
    -0.0154197600976008, -0.0154197600976008, 2.30121641236407e-16, 
    2.30121641236407e-16, 1.54545309540047, 1.54545309540047, -3.50383008868953e-16, 
    -3.50383008868953e-16, 9.57079195884779e-17, 9.57079195884779e-17, 
    0.634297533967185, 0.634297533967185), dim = c(64L, 2L)))

# h_get_kr_comp works as expected on toeph ungrouped mmrm

    list(P = structure(c(-3.00698932531873, -1.48201163181958, -5.47937172723774, 
    -2.77529910511584, -5.73724157545812, -2.4757324905986, -1.61910177737906, 
    -0.837469428192996, -4.15106334018347, -2.1186017870264, -3.98050322412734, 
    -1.93591221859969, -1.56116019632859, -0.834862299843971, -1.48201163181958, 
    -1.48201163181958, -2.77529910511584, -2.77529910511584, -2.4757324905986, 
    -2.4757324905986, -0.837469428192996, -0.837469428192996, -2.1186017870264, 
    -2.1186017870264, -1.93591221859969, -1.93591221859969, -0.834862299843971, 
    -0.834862299843971), dim = c(14L, 2L)), Q = structure(c(6.5311283002833, 
    3.2352857680526, -0.593459512463005, -0.303880262345611, 0.0747735253456771, 
    0.0303614287595468, 0.00153633747148627, 0.00225632917262039, 
    1.39989587260588, 0.753568251092083, 2.64530161508997, 1.20054151118485, 
    2.17884439266233, 1.16943865926876, -0.593459512463005, -0.303880262345611, 
    12.6457117513049, 6.40636748061512, -1.10439620741595, -0.549861692887666, 
    0.0108874230494882, -0.00202731515015272, 3.69205805056602, 1.86107700790178, 
    1.2116186156243, 0.686439224339102, -0.467094736153213, -0.256558174056112, 
    0.074773525345677, 0.0303614287595467, -1.10439620741595, -0.549861692887668, 
    12.8689033339538, 5.64739917654653, -0.364797500967244, -0.176433931221216, 
    2.07362105403505, 1.04741584070462, 2.16249417059151, 0.960761488085782, 
    -0.44968915739307, -0.238727047796987, 0.00153633747148552, 0.00225632917262, 
    0.0108874230494881, -0.00202731515015283, -0.364797500967244, 
    -0.176433931221216, 3.59057729520438, 1.85114377358474, 1.13655170316, 
    0.575142474354321, 1.94159204694891, 1.02408221358965, 1.86025989354113, 
    0.995571162272287, 1.39989587260588, 0.753568251092084, 3.69205805056602, 
    1.86107700790178, 2.07362105403504, 1.04741584070462, 1.13655170316, 
    0.575142474354321, 3.70516591603265, 1.87702614002169, 1.69393674880182, 
    0.920771467307149, 0.990011691676252, 0.522715249330153, 2.64530161508997, 
    1.20054151118485, 1.2116186156243, 0.686439224339103, 2.1624941705915, 
    0.960761488085782, 1.94159204694891, 1.02408221358965, 1.69393674880182, 
    0.920771467307149, 4.74394647596858, 2.2300931246091, 1.20411295961672, 
    0.669440520940178, 2.17884439266233, 1.16943865926876, -0.467094736153214, 
    -0.256558174056113, -0.44968915739307, -0.238727047796988, 1.86025989354113, 
    0.995571162272287, 0.990011691676252, 0.522715249330152, 1.20411295961672, 
    0.669440520940178, 2.32574872139835, 1.2400095101842, 3.2352857680526, 
    3.2352857680526, -0.303880262345611, -0.303880262345611, 0.0303614287595468, 
    0.0303614287595468, 0.00225632917262039, 0.00225632917262039, 
    0.753568251092083, 0.753568251092083, 1.20054151118485, 1.20054151118485, 
    1.16943865926876, 1.16943865926876, -0.303880262345611, -0.303880262345611, 
    6.40636748061512, 6.40636748061512, -0.549861692887666, -0.549861692887666, 
    -0.00202731515015272, -0.00202731515015272, 1.86107700790178, 
    1.86107700790178, 0.686439224339102, 0.686439224339102, -0.256558174056112, 
    -0.256558174056112, 0.0303614287595467, 0.0303614287595467, -0.549861692887668, 
    -0.549861692887668, 5.64739917654653, 5.64739917654653, -0.176433931221216, 
    -0.176433931221216, 1.04741584070462, 1.04741584070462, 0.960761488085782, 
    0.960761488085782, -0.238727047796987, -0.238727047796987, 0.00225632917262, 
    0.00225632917262, -0.00202731515015283, -0.00202731515015283, 
    -0.176433931221216, -0.176433931221216, 1.85114377358474, 1.85114377358474, 
    0.575142474354321, 0.575142474354321, 1.02408221358965, 1.02408221358965, 
    0.995571162272287, 0.995571162272287, 0.753568251092084, 0.753568251092084, 
    1.86107700790178, 1.86107700790178, 1.04741584070462, 1.04741584070462, 
    0.575142474354321, 0.575142474354321, 1.87702614002169, 1.87702614002169, 
    0.920771467307149, 0.920771467307149, 0.522715249330153, 0.522715249330153, 
    1.20054151118485, 1.20054151118485, 0.686439224339103, 0.686439224339103, 
    0.960761488085782, 0.960761488085782, 1.02408221358965, 1.02408221358965, 
    0.920771467307149, 0.920771467307149, 2.2300931246091, 2.2300931246091, 
    0.669440520940178, 0.669440520940178, 1.16943865926876, 1.16943865926876, 
    -0.256558174056113, -0.256558174056113, -0.238727047796988, -0.238727047796988, 
    0.995571162272287, 0.995571162272287, 0.522715249330152, 0.522715249330152, 
    0.669440520940178, 0.669440520940178, 1.2400095101842, 1.2400095101842
    ), dim = c(98L, 2L)), R = structure(c(6.08978788364807, 3.0055211932777, 
    0.701691778263758, 0.371244204757312, -0.0341047346347422, -0.0151957924699192, 
    -0.743396276639627, -0.397546341925934, 1.43986688796008, 0.761790652727582, 
    2.19977657348443, 0.980138055576815, 1.56116019632859, 0.834862299843971, 
    0.701691778263758, 0.371244204757312, 9.4073869266804, 4.76044091365443, 
    0.877272648719455, 0.433731153160151, -0.0276078991881398, -0.0148180613402049, 
    3.24002456079143, 1.65180411028486, 1.78072665064292, 0.955774163022878, 
    8.29107858922171e-17, 4.45009271709909e-17, -0.0341047346347422, 
    -0.0151957924699192, 0.877272648719455, 0.433731153160151, 10.1873377924412, 
    4.30544463934581, 0.443977444390381, 0.22748498116115, 2.7111964522234, 
    1.35681113429882, 2.19977657348443, 0.980138055576815, 2.72055851228794e-17, 
    1.39395865653808e-17, -0.743396276639627, -0.397546341925934, 
    -0.0276078991881398, -0.0148180613402049, 0.443977444390381, 
    0.22748498116115, 3.56523028619551, 1.85981827849098, 0.911038779392043, 
    0.46679767674154, 1.78072665064292, 0.955774163022878, 1.56116019632859, 
    0.834862299843971, 1.43986688796008, 0.761790652727582, 3.24002456079143, 
    1.65180411028486, 2.7111964522234, 1.35681113429882, 0.911038779392043, 
    0.46679767674154, -4.41301015049721, -2.25229306922496, 8.95773947626632e-16, 
    3.7053983962677e-16, -4.07584933439769e-18, -8.03763808739569e-18, 
    2.19977657348443, 0.980138055576815, 1.78072665064292, 0.955774163022878, 
    2.19977657348443, 0.980138055576815, 1.78072665064292, 0.955774163022878, 
    1.10697118265991e-15, 5.76654034714764e-16, 0.185048974723699, 
    0.0899983120313873, -2.17644680983035e-16, -1.11516692523047e-16, 
    1.56116019632859, 0.834862299843971, 8.29107858922171e-17, 4.45009271709909e-17, 
    2.72055851228794e-17, 1.39395865653808e-17, 1.56116019632859, 
    0.834862299843971, -2.7723197332311e-16, -1.50124535553202e-16, 
    4.93001350491584e-16, 2.58985653612848e-16, 1.6386708182908, 
    0.876312688001377, 3.0055211932777, 3.0055211932777, 0.371244204757312, 
    0.371244204757312, -0.0151957924699192, -0.0151957924699192, 
    -0.397546341925934, -0.397546341925934, 0.761790652727582, 0.761790652727582, 
    0.980138055576815, 0.980138055576815, 0.834862299843971, 0.834862299843971, 
    0.371244204757312, 0.371244204757312, 4.76044091365443, 4.76044091365443, 
    0.433731153160151, 0.433731153160151, -0.0148180613402049, -0.0148180613402049, 
    1.65180411028486, 1.65180411028486, 0.955774163022878, 0.955774163022878, 
    4.45009271709909e-17, 4.45009271709909e-17, -0.0151957924699192, 
    -0.0151957924699192, 0.433731153160151, 0.433731153160151, 4.30544463934581, 
    4.30544463934581, 0.22748498116115, 0.22748498116115, 1.35681113429882, 
    1.35681113429882, 0.980138055576815, 0.980138055576815, 1.39395865653808e-17, 
    1.39395865653808e-17, -0.397546341925934, -0.397546341925934, 
    -0.0148180613402049, -0.0148180613402049, 0.22748498116115, 0.22748498116115, 
    1.85981827849098, 1.85981827849098, 0.46679767674154, 0.46679767674154, 
    0.955774163022878, 0.955774163022878, 0.834862299843971, 0.834862299843971, 
    0.761790652727582, 0.761790652727582, 1.65180411028486, 1.65180411028486, 
    1.35681113429882, 1.35681113429882, 0.46679767674154, 0.46679767674154, 
    -2.25229306922496, -2.25229306922496, 3.7053983962677e-16, 3.7053983962677e-16, 
    -8.03763808739569e-18, -8.03763808739569e-18, 0.980138055576815, 
    0.980138055576815, 0.955774163022878, 0.955774163022878, 0.980138055576815, 
    0.980138055576815, 0.955774163022878, 0.955774163022878, 5.76654034714764e-16, 
    5.76654034714764e-16, 0.0899983120313873, 0.0899983120313873, 
    -1.11516692523047e-16, -1.11516692523047e-16, 0.834862299843971, 
    0.834862299843971, 4.45009271709909e-17, 4.45009271709909e-17, 
    1.39395865653808e-17, 1.39395865653808e-17, 0.834862299843971, 
    0.834862299843971, -1.50124535553202e-16, -1.50124535553202e-16, 
    2.58985653612848e-16, 2.58985653612848e-16, 0.876312688001377, 
    0.876312688001377), dim = c(98L, 2L)))

# h_get_kr_comp works as expected on toeph grouped mmrm

    list(P = structure(c(-1.16534642663848, -0.617730004029541, -2.93605237882595, 
    -1.36410532618533, -2.57022935505834, -0.993242967635988, -0.83929348605521, 
    -0.44262273305075, -2.25062910519018, -1.0347587187416, -1.64724939689702, 
    -0.838800243654627, -0.747425794514912, -0.417975196874121, -1.93149897196878, 
    -0.899922134708449, -2.35291168800038, -1.27077247596784, -3.46603842793893, 
    -1.62945911981695, -0.768920942343845, -0.385714041082597, -1.8105140408284, 
    -0.999314558850525, -2.48441219400465, -1.15819705558246, -0.793022313932502, 
    -0.406728560149045, -0.617730004029541, -0.617730004029541, -1.36410532618533, 
    -1.36410532618533, -0.993242967635988, -0.993242967635988, -0.44262273305075, 
    -0.44262273305075, -1.0347587187416, -1.0347587187416, -0.838800243654627, 
    -0.838800243654627, -0.417975196874121, -0.417975196874121, -0.899922134708449, 
    -0.899922134708449, -1.27077247596784, -1.27077247596784, -1.62945911981695, 
    -1.62945911981695, -0.385714041082597, -0.385714041082597, -0.999314558850525, 
    -0.999314558850525, -1.15819705558246, -1.15819705558246, -0.406728560149045, 
    -0.406728560149045), dim = c(28L, 2L)), Q = structure(c(2.52512805609827, 
    1.33631285988805, -0.194510066409994, -0.0938254669145597, 0.00770015020974288, 
    -0.00271950038154752, -0.00762528662106141, -0.00430788453286216, 
    0.784062874462438, 0.420801507866724, 0.920927746341893, 0.431074838052149, 
    0.987819891321598, 0.554387944157006, -0.194510066409994, -0.0938254669145597, 
    6.46573578461373, 2.99678167162854, -0.384835984555503, -0.157660720026383, 
    -0.0142849759963301, -0.0170848323169338, 1.76403010355829, 0.793317572908637, 
    0.767394976381576, 0.428923217829994, -0.224847064926918, -0.129328665451576, 
    0.00770015020974275, -0.00271950038154758, -0.384835984555503, 
    -0.157660720026383, 5.66074021143961, 2.20385805096424, -0.143145666977163, 
    -0.056991895284335, 1.40076448652414, 0.594413458279819, 0.545042151357083, 
    0.285930137356766, -0.141496868396007, -0.0778587722406688, -0.00762528662106118, 
    -0.00430788453286202, -0.0142849759963302, -0.0170848323169338, 
    -0.143145666977163, -0.056991895284335, 1.84364290170498, 0.963630078235631, 
    0.552400745835497, 0.260984898428013, 1.06113391971349, 0.531672294070345, 
    0.873375631031152, 0.488749887283482, 0.784062874462438, 0.420801507866724, 
    1.76403010355829, 0.793317572908637, 1.40076448652414, 0.594413458279819, 
    0.552400745835497, 0.260984898428013, 2.00311989747102, 0.908063047818195, 
    1.02706854641899, 0.488954226216658, 0.485396430884327, 0.283178394662565, 
    0.920927746341894, 0.431074838052149, 0.767394976381576, 0.428923217829993, 
    0.545042151357083, 0.285930137356766, 1.06113391971349, 0.531672294070344, 
    1.02706854641899, 0.488954226216658, 2.04605176276994, 0.984207356000674, 
    0.595377881181462, 0.324080792804815, 0.987819891321598, 0.554387944157006, 
    -0.224847064926918, -0.129328665451577, -0.141496868396007, -0.0778587722406688, 
    0.873375631031152, 0.488749887283482, 0.485396430884327, 0.283178394662566, 
    0.595377881181463, 0.324080792804815, 1.05815834179493, 0.594996263811497, 
    4.20309992283127, 1.98055169797221, -0.449619715340287, -0.243166329381912, 
    0.0974282284692847, 0.0564670613588065, 0.0120895079772999, 0.00599183946778872, 
    0.433492403912431, 0.223706976868754, 1.9499873841612, 0.888046839981789, 
    1.16054897795489, 0.594380527868517, -0.449619715340287, -0.243166329381912, 
    5.91457925516596, 3.21584014587567, -0.792897616956362, -0.457686450461697, 
    0.0337614531314446, 0.0265575859036322, 2.16258687700507, 1.19149411651926, 
    0.243888364890728, 0.125028926499639, -0.218347746629152, -0.107423692359673, 
    0.0974282284692846, 0.0564670613588064, -0.792897616956362, -0.457686450461698, 
    7.8667709871528, 3.79568297714231, -0.239224742787876, -0.135545348405521, 
    0.381422240022637, 0.234899283198939, 1.95726925570278, 0.861042885328497, 
    -0.348495305512027, -0.185487653661225, 0.0120895079773002, 0.00599183946778886, 
    0.0337614531314445, 0.0265575859036321, -0.239224742787875, -0.13554534840552, 
    1.73121566636682, 0.874424005199293, 0.643526560716657, 0.348528741114098, 
    0.817679383254582, 0.44227545935499, 0.992338702051291, 0.511987938450471, 
    0.433492403912432, 0.223706976868754, 2.16258687700507, 1.19149411651926, 
    0.381422240022637, 0.234899283198938, 0.643526560716658, 0.348528741114098, 
    2.11456734945215, 1.15812030993228, 0.406722255302426, 0.269369871911639, 
    0.537945268525199, 0.260848322981185, 1.9499873841612, 0.888046839981789, 
    0.243888364890727, 0.125028926499639, 1.95726925570278, 0.861042885328497, 
    0.817679383254582, 0.44227545935499, 0.406722255302426, 0.269369871911639, 
    3.01189861592364, 1.37471508064468, 0.56009847676798, 0.32090201063869, 
    1.16054897795489, 0.594380527868517, -0.218347746629152, -0.107423692359673, 
    -0.348495305512026, -0.185487653661225, 0.992338702051292, 0.511987938450471, 
    0.537945268525199, 0.260848322981185, 0.560098476767981, 0.32090201063869, 
    1.28283742354991, 0.651952120451489, 1.33631285988805, 1.33631285988805, 
    -0.0938254669145597, -0.0938254669145597, -0.00271950038154752, 
    -0.00271950038154752, -0.00430788453286216, -0.00430788453286216, 
    0.420801507866724, 0.420801507866724, 0.431074838052149, 0.431074838052149, 
    0.554387944157006, 0.554387944157006, -0.0938254669145597, -0.0938254669145597, 
    2.99678167162854, 2.99678167162854, -0.157660720026383, -0.157660720026383, 
    -0.0170848323169338, -0.0170848323169338, 0.793317572908637, 
    0.793317572908637, 0.428923217829994, 0.428923217829994, -0.129328665451576, 
    -0.129328665451576, -0.00271950038154758, -0.00271950038154758, 
    -0.157660720026383, -0.157660720026383, 2.20385805096424, 2.20385805096424, 
    -0.056991895284335, -0.056991895284335, 0.594413458279819, 0.594413458279819, 
    0.285930137356766, 0.285930137356766, -0.0778587722406688, -0.0778587722406688, 
    -0.00430788453286202, -0.00430788453286202, -0.0170848323169338, 
    -0.0170848323169338, -0.056991895284335, -0.056991895284335, 
    0.963630078235631, 0.963630078235631, 0.260984898428013, 0.260984898428013, 
    0.531672294070345, 0.531672294070345, 0.488749887283482, 0.488749887283482, 
    0.420801507866724, 0.420801507866724, 0.793317572908637, 0.793317572908637, 
    0.594413458279819, 0.594413458279819, 0.260984898428013, 0.260984898428013, 
    0.908063047818195, 0.908063047818195, 0.488954226216658, 0.488954226216658, 
    0.283178394662565, 0.283178394662565, 0.431074838052149, 0.431074838052149, 
    0.428923217829993, 0.428923217829993, 0.285930137356766, 0.285930137356766, 
    0.531672294070344, 0.531672294070344, 0.488954226216658, 0.488954226216658, 
    0.984207356000674, 0.984207356000674, 0.324080792804815, 0.324080792804815, 
    0.554387944157006, 0.554387944157006, -0.129328665451577, -0.129328665451577, 
    -0.0778587722406688, -0.0778587722406688, 0.488749887283482, 
    0.488749887283482, 0.283178394662566, 0.283178394662566, 0.324080792804815, 
    0.324080792804815, 0.594996263811497, 0.594996263811497, 1.98055169797221, 
    1.98055169797221, -0.243166329381912, -0.243166329381912, 0.0564670613588065, 
    0.0564670613588065, 0.00599183946778872, 0.00599183946778872, 
    0.223706976868754, 0.223706976868754, 0.888046839981789, 0.888046839981789, 
    0.594380527868517, 0.594380527868517, -0.243166329381912, -0.243166329381912, 
    3.21584014587567, 3.21584014587567, -0.457686450461697, -0.457686450461697, 
    0.0265575859036322, 0.0265575859036322, 1.19149411651926, 1.19149411651926, 
    0.125028926499639, 0.125028926499639, -0.107423692359673, -0.107423692359673, 
    0.0564670613588064, 0.0564670613588064, -0.457686450461698, -0.457686450461698, 
    3.79568297714231, 3.79568297714231, -0.135545348405521, -0.135545348405521, 
    0.234899283198939, 0.234899283198939, 0.861042885328497, 0.861042885328497, 
    -0.185487653661225, -0.185487653661225, 0.00599183946778886, 
    0.00599183946778886, 0.0265575859036321, 0.0265575859036321, 
    -0.13554534840552, -0.13554534840552, 0.874424005199293, 0.874424005199293, 
    0.348528741114098, 0.348528741114098, 0.44227545935499, 0.44227545935499, 
    0.511987938450471, 0.511987938450471, 0.223706976868754, 0.223706976868754, 
    1.19149411651926, 1.19149411651926, 0.234899283198938, 0.234899283198938, 
    0.348528741114098, 0.348528741114098, 1.15812030993228, 1.15812030993228, 
    0.269369871911639, 0.269369871911639, 0.260848322981185, 0.260848322981185, 
    0.888046839981789, 0.888046839981789, 0.125028926499639, 0.125028926499639, 
    0.861042885328497, 0.861042885328497, 0.44227545935499, 0.44227545935499, 
    0.269369871911639, 0.269369871911639, 1.37471508064468, 1.37471508064468, 
    0.32090201063869, 0.32090201063869, 0.594380527868517, 0.594380527868517, 
    -0.107423692359673, -0.107423692359673, -0.185487653661225, -0.185487653661225, 
    0.511987938450471, 0.511987938450471, 0.260848322981185, 0.260848322981185, 
    0.32090201063869, 0.32090201063869, 0.651952120451489, 0.651952120451489
    ), dim = c(196L, 2L)), R = structure(c(2.38636859006454, 1.27640950818973, 
    0.299811296302048, 0.158068174883225, 0.00279003270916513, 0.00133790304043232, 
    -0.358277065798788, -0.200355578054302, 0.730699387843839, 0.38524338492037, 
    0.705486705363002, 0.33830169982924, 0.747425794514912, 0.417975196874121, 
    0.299811296302048, 0.158068174883225, 5.12516256228642, 2.38623512092223, 
    0.443406450829786, 0.181928003449773, 0.0037244482336479, 0.00197935311544084, 
    1.81136854935842, 0.828637888036339, 0.941762691534018, 0.500498543825387, 
    0, 0, 0.00279003270916513, 0.00133790304043232, 0.443406450829786, 
    0.181928003449773, 4.51403041189552, 1.71864714631234, 0.180231814682217, 
    0.084572882469426, 1.51992971734634, 0.649515333821227, 0.705486705363002, 
    0.33830169982924, 0, 0, -0.358277065798788, -0.200355578054302, 
    0.0037244482336479, 0.00197935311544084, 0.180231814682217, 0.084572882469426, 
    1.85290777499334, 0.999048808570935, 0.439260555831765, 0.206120830705258, 
    0.941762691534018, 0.500498543825387, 0.747425794514912, 0.417975196874121, 
    0.730699387843839, 0.38524338492037, 1.81136854935842, 0.828637888036339, 
    1.51992971734634, 0.649515333821227, 0.439260555831765, 0.206120830705258, 
    -2.16385624599342, -0.994863663444867, 5.68133788598532e-16, 
    2.47142246708727e-16, 1.62197998054206e-16, 8.78171719502026e-17, 
    0.705486705363002, 0.33830169982924, 0.941762691534018, 0.500498543825387, 
    0.705486705363002, 0.33830169982924, 0.941762691534018, 0.500498543825387, 
    4.76269634975693e-16, 1.96713191949753e-16, -0.0195428315371362, 
    -0.00995145719035032, -3.37985414813524e-17, -2.68431839378769e-17, 
    0.747425794514912, 0.417975196874121, 0, 0, 0, 0, 0.747425794514912, 
    0.417975196874121, 1.40030786957636e-16, 7.52231631296611e-17, 
    5.80656121414861e-17, 2.35858708210969e-17, 0.787421252125022, 
    0.440341442983551, 3.92555625104901, 1.82400563295951, 0.359627361179614, 
    0.188286257097002, -0.0555723617532272, -0.0244174735934565, 
    -0.36661330653783, -0.188030147046157, 0.633090267412372, 0.331460310652171, 
    1.69801363056219, 0.746075957140217, 0.793022313932502, 0.406728560149045, 
    0.359627361179614, 0.188286257097002, 3.97252736398467, 2.13453044919508, 
    0.399405797266414, 0.232216089531637, -0.0257371464299575, -0.0134878438880299, 
    1.33620674377846, 0.740254974486479, 0.786398563442463, 0.412121098442241, 
    6.88047685999525e-17, 3.60579204129628e-17, -0.0555723617532272, 
    -0.0244174735934565, 0.399405797266414, 0.232216089531637, 6.31881283454396, 
    2.90396064888803, 0.269430585820709, 0.147158974807688, 1.17742377341603, 
    0.667854248198354, 1.69801363056219, 0.746075957140216, 2.98115026191718e-17, 
    1.62825989096625e-17, -0.36661330653783, -0.188030147046157, 
    -0.0257371464299575, -0.0134878438880299, 0.269430585820709, 
    0.147158974807688, 1.66076175183477, 0.825787098291692, 0.474307297049938, 
    0.259059584364047, 0.786398563442463, 0.412121098442241, 0.793022313932502, 
    0.406728560149045, 0.633090267412372, 0.331460310652171, 1.33620674377846, 
    0.740254974486479, 1.17742377341603, 0.667854248198354, 0.474307297049938, 
    0.259059584364047, -2.08100463525789, -1.14861204174762, 6.11240039446025e-16, 
    2.72598778647846e-16, 2.74958369634776e-16, 1.46178956428128e-16, 
    1.69801363056219, 0.746075957140217, 0.786398563442463, 0.412121098442241, 
    1.69801363056219, 0.746075957140217, 0.786398563442463, 0.412121098442241, 
    1.44065656968666e-15, 6.67807609956293e-16, 0.243407924472636, 
    0.113473256213263, -4.683472264395e-17, -2.93995157844416e-17, 
    0.793022313932502, 0.406728560149045, 6.88047685999525e-17, 3.60579204129628e-17, 
    2.98115026191718e-17, 1.62825989096625e-17, 0.793022313932502, 
    0.406728560149045, 3.97810899344248e-16, 2.10982311508024e-16, 
    2.89645151330948e-16, 1.42923519416834e-16, 0.818656962264193, 
    0.419876164475804, 1.27640950818973, 1.27640950818973, 0.158068174883225, 
    0.158068174883225, 0.00133790304043232, 0.00133790304043232, 
    -0.200355578054302, -0.200355578054302, 0.38524338492037, 0.38524338492037, 
    0.33830169982924, 0.33830169982924, 0.417975196874121, 0.417975196874121, 
    0.158068174883225, 0.158068174883225, 2.38623512092223, 2.38623512092223, 
    0.181928003449773, 0.181928003449773, 0.00197935311544084, 0.00197935311544084, 
    0.828637888036339, 0.828637888036339, 0.500498543825387, 0.500498543825387, 
    0, 0, 0.00133790304043232, 0.00133790304043232, 0.181928003449773, 
    0.181928003449773, 1.71864714631234, 1.71864714631234, 0.084572882469426, 
    0.084572882469426, 0.649515333821227, 0.649515333821227, 0.33830169982924, 
    0.33830169982924, 0, 0, -0.200355578054302, -0.200355578054302, 
    0.00197935311544084, 0.00197935311544084, 0.084572882469426, 
    0.084572882469426, 0.999048808570935, 0.999048808570935, 0.206120830705258, 
    0.206120830705258, 0.500498543825387, 0.500498543825387, 0.417975196874121, 
    0.417975196874121, 0.38524338492037, 0.38524338492037, 0.828637888036339, 
    0.828637888036339, 0.649515333821227, 0.649515333821227, 0.206120830705258, 
    0.206120830705258, -0.994863663444867, -0.994863663444867, 2.47142246708727e-16, 
    2.47142246708727e-16, 8.78171719502026e-17, 8.78171719502026e-17, 
    0.33830169982924, 0.33830169982924, 0.500498543825387, 0.500498543825387, 
    0.33830169982924, 0.33830169982924, 0.500498543825387, 0.500498543825387, 
    1.96713191949753e-16, 1.96713191949753e-16, -0.00995145719035032, 
    -0.00995145719035032, -2.68431839378769e-17, -2.68431839378769e-17, 
    0.417975196874121, 0.417975196874121, 0, 0, 0, 0, 0.417975196874121, 
    0.417975196874121, 7.52231631296611e-17, 7.52231631296611e-17, 
    2.35858708210969e-17, 2.35858708210969e-17, 0.440341442983551, 
    0.440341442983551, 1.82400563295951, 1.82400563295951, 0.188286257097002, 
    0.188286257097002, -0.0244174735934565, -0.0244174735934565, 
    -0.188030147046157, -0.188030147046157, 0.331460310652171, 0.331460310652171, 
    0.746075957140217, 0.746075957140217, 0.406728560149045, 0.406728560149045, 
    0.188286257097002, 0.188286257097002, 2.13453044919508, 2.13453044919508, 
    0.232216089531637, 0.232216089531637, -0.0134878438880299, -0.0134878438880299, 
    0.740254974486479, 0.740254974486479, 0.412121098442241, 0.412121098442241, 
    3.60579204129628e-17, 3.60579204129628e-17, -0.0244174735934565, 
    -0.0244174735934565, 0.232216089531637, 0.232216089531637, 2.90396064888803, 
    2.90396064888803, 0.147158974807688, 0.147158974807688, 0.667854248198354, 
    0.667854248198354, 0.746075957140216, 0.746075957140216, 1.62825989096625e-17, 
    1.62825989096625e-17, -0.188030147046157, -0.188030147046157, 
    -0.0134878438880299, -0.0134878438880299, 0.147158974807688, 
    0.147158974807688, 0.825787098291692, 0.825787098291692, 0.259059584364047, 
    0.259059584364047, 0.412121098442241, 0.412121098442241, 0.406728560149045, 
    0.406728560149045, 0.331460310652171, 0.331460310652171, 0.740254974486479, 
    0.740254974486479, 0.667854248198354, 0.667854248198354, 0.259059584364047, 
    0.259059584364047, -1.14861204174762, -1.14861204174762, 2.72598778647846e-16, 
    2.72598778647846e-16, 1.46178956428128e-16, 1.46178956428128e-16, 
    0.746075957140217, 0.746075957140217, 0.412121098442241, 0.412121098442241, 
    0.746075957140217, 0.746075957140217, 0.412121098442241, 0.412121098442241, 
    6.67807609956293e-16, 6.67807609956293e-16, 0.113473256213263, 
    0.113473256213263, -2.93995157844416e-17, -2.93995157844416e-17, 
    0.406728560149045, 0.406728560149045, 3.60579204129628e-17, 3.60579204129628e-17, 
    1.62825989096625e-17, 1.62825989096625e-17, 0.406728560149045, 
    0.406728560149045, 2.10982311508024e-16, 2.10982311508024e-16, 
    1.42923519416834e-16, 1.42923519416834e-16, 0.419876164475804, 
    0.419876164475804), dim = c(196L, 2L)))

# h_get_kr_comp works as expected on us ungrouped mmrm

    list(P = structure(c(-1.26996739294421, -0.588742202057682, -6.82514993036792, 
    -3.45693333931976, -9.83947420543731, -4.38608332957787, -1.71999429204381, 
    -0.878051126349348, -2.91611111559974, -1.47672797559794, -3.94753456029082, 
    -1.86082722842864, -4.88747892078001, -2.38135111967433, -1.61169975189743, 
    -0.853845012473485, -1.82471490268932, -0.964053659131878, -1.97423011219508, 
    -0.993978584151652, -0.588742202057682, -0.588742202057682, -3.45693333931976, 
    -3.45693333931976, -4.38608332957787, -4.38608332957787, -0.878051126349348, 
    -0.878051126349348, -1.47672797559794, -1.47672797559794, -1.86082722842864, 
    -1.86082722842864, -2.38135111967433, -2.38135111967433, -0.853845012473485, 
    -0.853845012473485, -0.964053659131878, -0.964053659131878, -0.993978584151652, 
    -0.993978584151652), dim = c(20L, 2L)), Q = structure(c(4.17025096006498, 
    2.02319792781898, -1.80511962631678, -0.938683713913343, -0.00287708209107499, 
    -0.00865096315836362, 0.177680534231297, 0.101621153368091, 0.325306272155041, 
    0.172612744782399, 2.19814924995239, 0.967728792449313, -1.06675331304615, 
    -0.543982541101265, 1.49372003893893, 0.792871796303542, -0.0122052068930913, 
    -0.00419709598845123, 0.615110147441059, 0.337766150856873, -1.80511962631678, 
    -0.938683713913344, 15.9007824520114, 8.08597989953135, -0.182519601153415, 
    -0.0829407674917452, -0.262843363805291, -0.150488739486749, 
    6.15111891875856, 3.11473579194738, 2.34260738530431, 1.16379184391045, 
    5.1260582228038, 2.55922737893736, 0.826878277833584, 0.421582534013841, 
    1.92203639435263, 1.01640388047344, -0.133351113162284, -0.098259368961203, 
    -0.00287708209107515, -0.00865096315836373, -0.182519601153415, 
    -0.0829407674917454, 20.0887142162932, 8.97376301357449, -0.224369122174088, 
    -0.11000462376864, -0.219596776367993, -0.109758968133157, 3.99343107951523, 
    1.89788284141236, 5.74338811097881, 2.77508653778193, -0.461895901273379, 
    -0.23409234779909, -0.4598795177469, -0.234885494096758, 0.530502987314139, 
    0.269288125845222, 0.177680534231297, 0.101621153368091, -0.262843363805291, 
    -0.150488739486749, -0.224369122174088, -0.11000462376864, 3.74952053583569, 
    1.91497446258599, -0.424606183346123, -0.224133617400738, -0.639118594190294, 
    -0.30774902091485, -0.0277351791764426, -0.0276291362693593, 
    1.36469708829573, 0.727328042428678, 2.199478135666, 1.15078602787552, 
    2.93619820279724, 1.47916226056241, 0.325306272155041, 0.172612744782399, 
    6.15111891875856, 3.11473579194738, -0.219596776367992, -0.109758968133157, 
    -0.424606183346123, -0.224133617400738, 2.97935377459155, 1.50913657614475, 
    1.82544016267791, 0.906808054712545, 1.66948076872456, 0.835570899109291, 
    0.602284636114881, 0.322749704625095, 0.480090183715655, 0.259094953942368, 
    -0.202595110558768, -0.102283547150483, 2.19814924995239, 0.967728792449313, 
    2.34260738530431, 1.16379184391045, 3.99343107951523, 1.89788284141236, 
    -0.639118594190294, -0.30774902091485, 1.82544016267791, 0.906808054712545, 
    4.62333874418206, 2.12561958061215, 1.75558333693911, 0.872712636713963, 
    0.374934479546347, 0.203575155113679, -0.287951791923108, -0.141992684740851, 
    -0.358187564499269, -0.15115023890313, -1.06675331304615, -0.543982541101266, 
    5.1260582228038, 2.55922737893736, 5.74338811097881, 2.77508653778193, 
    -0.0277351791764426, -0.0276291362693593, 1.66948076872456, 0.83557089910929, 
    1.75558333693911, 0.872712636713963, 4.65859735345759, 2.31253624337724, 
    -0.0651888760735431, -0.0555479422919294, 0.276097248394366, 
    0.142284996370325, 0.178937425795737, 0.063464722873287, 1.49372003893893, 
    0.792871796303542, 0.826878277833586, 0.421582534013842, -0.461895901273379, 
    -0.23409234779909, 1.36469708829573, 0.727328042428678, 0.602284636114882, 
    0.322749704625096, 0.374934479546347, 0.203575155113679, -0.0651888760735425, 
    -0.0555479422919291, 1.58225784898427, 0.829555601526655, 1.14920313692885, 
    0.608172473523674, 1.45353838624176, 0.757585173638742, -0.0122052068930913, 
    -0.00419709598845123, 1.92203639435263, 1.01640388047344, -0.4598795177469, 
    -0.234885494096758, 2.199478135666, 1.15078602787552, 0.480090183715655, 
    0.259094953942368, -0.287951791923108, -0.141992684740851, 0.276097248394367, 
    0.142284996370326, 1.14920313692885, 0.608172473523674, 2.11414662859421, 
    1.10875522552803, 1.93771968122464, 0.994915603897633, 0.615110147441059, 
    0.337766150856873, -0.133351113162284, -0.0982593689612029, 0.530502987314139, 
    0.269288125845223, 2.93619820279724, 1.47916226056241, -0.202595110558768, 
    -0.102283547150483, -0.358187564499269, -0.15115023890313, 0.178937425795738, 
    0.0634647228732871, 1.45353838624176, 0.757585173638743, 1.93771968122464, 
    0.994915603897633, 3.5047052395248, 1.75204389703656, 2.02319792781898, 
    2.02319792781898, -0.938683713913343, -0.938683713913343, -0.00865096315836362, 
    -0.00865096315836362, 0.101621153368091, 0.101621153368091, 0.172612744782399, 
    0.172612744782399, 0.967728792449313, 0.967728792449313, -0.543982541101265, 
    -0.543982541101265, 0.792871796303542, 0.792871796303542, -0.00419709598845123, 
    -0.00419709598845123, 0.337766150856873, 0.337766150856873, -0.938683713913344, 
    -0.938683713913344, 8.08597989953135, 8.08597989953135, -0.0829407674917452, 
    -0.0829407674917452, -0.150488739486749, -0.150488739486749, 
    3.11473579194738, 3.11473579194738, 1.16379184391045, 1.16379184391045, 
    2.55922737893736, 2.55922737893736, 0.421582534013841, 0.421582534013841, 
    1.01640388047344, 1.01640388047344, -0.098259368961203, -0.098259368961203, 
    -0.00865096315836373, -0.00865096315836373, -0.0829407674917454, 
    -0.0829407674917454, 8.97376301357449, 8.97376301357449, -0.11000462376864, 
    -0.11000462376864, -0.109758968133157, -0.109758968133157, 1.89788284141236, 
    1.89788284141236, 2.77508653778193, 2.77508653778193, -0.23409234779909, 
    -0.23409234779909, -0.234885494096758, -0.234885494096758, 0.269288125845222, 
    0.269288125845222, 0.101621153368091, 0.101621153368091, -0.150488739486749, 
    -0.150488739486749, -0.11000462376864, -0.11000462376864, 1.91497446258599, 
    1.91497446258599, -0.224133617400738, -0.224133617400738, -0.30774902091485, 
    -0.30774902091485, -0.0276291362693593, -0.0276291362693593, 
    0.727328042428678, 0.727328042428678, 1.15078602787552, 1.15078602787552, 
    1.47916226056241, 1.47916226056241, 0.172612744782399, 0.172612744782399, 
    3.11473579194738, 3.11473579194738, -0.109758968133157, -0.109758968133157, 
    -0.224133617400738, -0.224133617400738, 1.50913657614475, 1.50913657614475, 
    0.906808054712545, 0.906808054712545, 0.835570899109291, 0.835570899109291, 
    0.322749704625095, 0.322749704625095, 0.259094953942368, 0.259094953942368, 
    -0.102283547150483, -0.102283547150483, 0.967728792449313, 0.967728792449313, 
    1.16379184391045, 1.16379184391045, 1.89788284141236, 1.89788284141236, 
    -0.30774902091485, -0.30774902091485, 0.906808054712545, 0.906808054712545, 
    2.12561958061215, 2.12561958061215, 0.872712636713963, 0.872712636713963, 
    0.203575155113679, 0.203575155113679, -0.141992684740851, -0.141992684740851, 
    -0.15115023890313, -0.15115023890313, -0.543982541101266, -0.543982541101266, 
    2.55922737893736, 2.55922737893736, 2.77508653778193, 2.77508653778193, 
    -0.0276291362693593, -0.0276291362693593, 0.83557089910929, 0.83557089910929, 
    0.872712636713963, 0.872712636713963, 2.31253624337724, 2.31253624337724, 
    -0.0555479422919294, -0.0555479422919294, 0.142284996370325, 
    0.142284996370325, 0.063464722873287, 0.063464722873287, 0.792871796303542, 
    0.792871796303542, 0.421582534013842, 0.421582534013842, -0.23409234779909, 
    -0.23409234779909, 0.727328042428678, 0.727328042428678, 0.322749704625096, 
    0.322749704625096, 0.203575155113679, 0.203575155113679, -0.0555479422919291, 
    -0.0555479422919291, 0.829555601526655, 0.829555601526655, 0.608172473523674, 
    0.608172473523674, 0.757585173638742, 0.757585173638742, -0.00419709598845123, 
    -0.00419709598845123, 1.01640388047344, 1.01640388047344, -0.234885494096758, 
    -0.234885494096758, 1.15078602787552, 1.15078602787552, 0.259094953942368, 
    0.259094953942368, -0.141992684740851, -0.141992684740851, 0.142284996370326, 
    0.142284996370326, 0.608172473523674, 0.608172473523674, 1.10875522552803, 
    1.10875522552803, 0.994915603897633, 0.994915603897633, 0.337766150856873, 
    0.337766150856873, -0.0982593689612029, -0.0982593689612029, 
    0.269288125845223, 0.269288125845223, 1.47916226056241, 1.47916226056241, 
    -0.102283547150483, -0.102283547150483, -0.15115023890313, -0.15115023890313, 
    0.0634647228732871, 0.0634647228732871, 0.757585173638743, 0.757585173638743, 
    0.994915603897633, 0.994915603897633, 1.75204389703656, 1.75204389703656
    ), dim = c(200L, 2L)), R = structure(c(2.61069627234986, 1.19597793821527, 
    0.375213345486435, 0.203839695289073, -0.0703131832731097, -0.0285335761062659, 
    -0.375661648674759, -0.193799653282717, 0.395752470704743, 0.214997851245856, 
    1.33503477123511, 0.541766344180246, 0, 0, 0.90387571240611, 
    0.466299395461134, 0, 0, 0, 0, 0.375213345486435, 0.203839695289073, 
    13.5330871937705, 6.85220513017498, 0.134347537331823, 0.06658603867585, 
    -0.392348215852886, -0.20876418550039, 6.26532229426306, 3.17195585117358, 
    3.71526900655202, 1.84138132097239, 3.91864230407251, 1.94217827284272, 
    1.41998137390035, 0.755556525989617, 1.49771095254418, 0.796915582866156, 
    0, 0, -0.0703131832731097, -0.0285335761062659, 0.134347537331823, 
    0.06658603867585, 19.0937447006164, 8.47433613618729, 0.521169356199429, 
    0.259778060398858, -0.206385796418697, -0.102290022544584, 3.46489563284246, 
    1.64761215645213, 5.65924486403938, 2.72229363753345, -0.0785848782143751, 
    -0.0391708127048803, 0.125661502236639, 0.0626362638737905, 1.49208925020452, 
    0.743735307437749, -0.375661648674759, -0.193799653282717, -0.392348215852886, 
    -0.20876418550039, 0.521169356199429, 0.259778060398858, 3.68682909241583, 
    1.89888803108294, -0.622466737349616, -0.331207728678962, -0.620130290047966, 
    -0.309105364747496, 0.19707067344813, 0.0982303289724923, 0.978127295702775, 
    0.525004916201099, 2.02605735059782, 1.06855547152381, 2.45637097418564, 
    1.24422186086556, 0.395752470704743, 0.214997851245856, 6.26532229426306, 
    3.17195585117358, -0.206385796418697, -0.102290022544584, -0.622466737349616, 
    -0.331207728678962, 3.5325465226979, 1.78802440861172, 3.91864230407251, 
    1.94217827284272, 0, 0, 1.49771095254418, 0.796915582866156, 
    0, 0, 0, 0, 1.33503477123511, 0.541766344180246, 3.71526900655202, 
    1.84138132097239, 3.46489563284246, 1.64761215645213, -0.620130290047966, 
    -0.309105364747496, 3.91864230407251, 1.94217827284272, 9.16385406122816, 
    4.04830959984275, 0, 0, 1.49208925020452, 0.743735307437749, 
    0, 0, 0, 0, 0, 0, 3.91864230407251, 1.94217827284272, 5.65924486403938, 
    2.72229363753345, 0.19707067344813, 0.0982303289724923, 0, 0, 
    0, 0, 9.16385406122816, 4.04830959984275, 0, 0, 1.49208925020452, 
    0.743735307437749, 0, 0, 0.90387571240611, 0.466299395461134, 
    1.41998137390035, 0.755556525989617, -0.0785848782143751, -0.0391708127048803, 
    0.978127295702775, 0.525004916201099, 1.49771095254418, 0.796915582866156, 
    1.49208925020452, 0.743735307437749, 0, 0, 1.52443231089485, 
    0.791218846359356, 0, 0, 0, 0, 0, 0, 1.49771095254418, 0.796915582866156, 
    0.125661502236639, 0.0626362638737905, 2.02605735059782, 1.06855547152381, 
    0, 0, 0, 0, 1.49208925020452, 0.743735307437749, 0, 0, 1.52443231089485, 
    0.791218846359356, 0, 0, 0, 0, 0, 0, 1.49208925020452, 0.743735307437749, 
    2.45637097418564, 1.24422186086556, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 1.52443231089485, 0.791218846359356, 1.19597793821527, 1.19597793821527, 
    0.203839695289073, 0.203839695289073, -0.0285335761062659, -0.0285335761062659, 
    -0.193799653282717, -0.193799653282717, 0.214997851245856, 0.214997851245856, 
    0.541766344180246, 0.541766344180246, 0, 0, 0.466299395461134, 
    0.466299395461134, 0, 0, 0, 0, 0.203839695289073, 0.203839695289073, 
    6.85220513017498, 6.85220513017498, 0.06658603867585, 0.06658603867585, 
    -0.20876418550039, -0.20876418550039, 3.17195585117358, 3.17195585117358, 
    1.84138132097239, 1.84138132097239, 1.94217827284272, 1.94217827284272, 
    0.755556525989617, 0.755556525989617, 0.796915582866156, 0.796915582866156, 
    0, 0, -0.0285335761062659, -0.0285335761062659, 0.06658603867585, 
    0.06658603867585, 8.47433613618729, 8.47433613618729, 0.259778060398858, 
    0.259778060398858, -0.102290022544584, -0.102290022544584, 1.64761215645213, 
    1.64761215645213, 2.72229363753345, 2.72229363753345, -0.0391708127048803, 
    -0.0391708127048803, 0.0626362638737905, 0.0626362638737905, 
    0.743735307437749, 0.743735307437749, -0.193799653282717, -0.193799653282717, 
    -0.20876418550039, -0.20876418550039, 0.259778060398858, 0.259778060398858, 
    1.89888803108294, 1.89888803108294, -0.331207728678962, -0.331207728678962, 
    -0.309105364747496, -0.309105364747496, 0.0982303289724923, 0.0982303289724923, 
    0.525004916201099, 0.525004916201099, 1.06855547152381, 1.06855547152381, 
    1.24422186086556, 1.24422186086556, 0.214997851245856, 0.214997851245856, 
    3.17195585117358, 3.17195585117358, -0.102290022544584, -0.102290022544584, 
    -0.331207728678962, -0.331207728678962, 1.78802440861172, 1.78802440861172, 
    1.94217827284272, 1.94217827284272, 0, 0, 0.796915582866156, 
    0.796915582866156, 0, 0, 0, 0, 0.541766344180246, 0.541766344180246, 
    1.84138132097239, 1.84138132097239, 1.64761215645213, 1.64761215645213, 
    -0.309105364747496, -0.309105364747496, 1.94217827284272, 1.94217827284272, 
    4.04830959984275, 4.04830959984275, 0, 0, 0.743735307437749, 
    0.743735307437749, 0, 0, 0, 0, 0, 0, 1.94217827284272, 1.94217827284272, 
    2.72229363753345, 2.72229363753345, 0.0982303289724923, 0.0982303289724923, 
    0, 0, 0, 0, 4.04830959984275, 4.04830959984275, 0, 0, 0.743735307437749, 
    0.743735307437749, 0, 0, 0.466299395461134, 0.466299395461134, 
    0.755556525989617, 0.755556525989617, -0.0391708127048803, -0.0391708127048803, 
    0.525004916201099, 0.525004916201099, 0.796915582866156, 0.796915582866156, 
    0.743735307437749, 0.743735307437749, 0, 0, 0.791218846359356, 
    0.791218846359356, 0, 0, 0, 0, 0, 0, 0.796915582866156, 0.796915582866156, 
    0.0626362638737905, 0.0626362638737905, 1.06855547152381, 1.06855547152381, 
    0, 0, 0, 0, 0.743735307437749, 0.743735307437749, 0, 0, 0.791218846359356, 
    0.791218846359356, 0, 0, 0, 0, 0, 0, 0.743735307437749, 0.743735307437749, 
    1.24422186086556, 1.24422186086556, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0.791218846359356, 0.791218846359356), dim = c(200L, 2L)))

# h_get_kr_comp works as expected on us grouped mmrm

    list(P = structure(c(-0.257277368415714, -0.169479134665926, 
    -3.79750975730519, -1.74218823431874, -4.4587743852144, -1.75757140030638, 
    -1.00540009236647, -0.51030662401227, -1.60110214902488, -0.733190573743327, 
    -1.79565625605102, -0.774552808884573, -2.39459607522869, -0.990933070701979, 
    -0.883401153633387, -0.455147191960812, -1.07730298075127, -0.542456581813086, 
    -1.16338068894982, -0.522188855563902, -1.0444225513509, -0.440294187693969, 
    -2.85706550892782, -1.55687037292231, -5.97131657718835, -2.90518591570869, 
    -0.789224887978062, -0.390319423205436, -1.20648133352642, -0.650633716265337, 
    -2.3707966786549, -1.16208038994306, -2.60216049044855, -1.39771680951217, 
    -0.778686587866109, -0.408028935053751, -0.812364299100752, -0.427270231325097, 
    -0.932046432704986, -0.491674680285534, -0.169479134665926, -0.169479134665926, 
    -1.74218823431874, -1.74218823431874, -1.75757140030638, -1.75757140030638, 
    -0.51030662401227, -0.51030662401227, -0.733190573743327, -0.733190573743327, 
    -0.774552808884573, -0.774552808884573, -0.990933070701979, -0.990933070701979, 
    -0.455147191960812, -0.455147191960812, -0.542456581813086, -0.542456581813086, 
    -0.522188855563902, -0.522188855563902, -0.440294187693969, -0.440294187693969, 
    -1.55687037292231, -1.55687037292231, -2.90518591570869, -2.90518591570869, 
    -0.390319423205436, -0.390319423205436, -0.650633716265337, -0.650633716265337, 
    -1.16208038994306, -1.16208038994306, -1.39771680951217, -1.39771680951217, 
    -0.408028935053751, -0.408028935053751, -0.427270231325097, -0.427270231325097, 
    -0.491674680285534, -0.491674680285534), dim = c(40L, 2L)), Q = structure(c(1.339432205086, 
    0.732337215350167, -0.834609985948546, -0.404757867499704, -0.0827041431746714, 
    -0.0383720982472778, 0.0924366608686413, 0.049751019728667, 0.1361537355086, 
    0.0809145914136465, 0.463378503740289, 0.232673343887846, -0.454024903224069, 
    -0.193864731313794, 0.673287774675988, 0.381659055063122, -0.00307608832322177, 
    -0.00619358031374822, 0.210250411751333, 0.111169605381947, -0.834609985948546, 
    -0.404757867499704, 8.52513172151184, 3.94701728147071, 0.0521155301828697, 
    0.0246647350433522, -0.147617751135786, -0.0825476803768774, 
    3.21066518473265, 1.46421515764084, 1.39524244544311, 0.571105723314685, 
    2.82699526222123, 1.17451838940952, 0.50278210526703, 0.224622053100667, 
    1.14607944021524, 0.575476300571174, -0.037003913374142, -0.0299892115538772, 
    -0.0827041431746713, -0.0383720982472778, 0.0521155301828697, 
    0.0246647350433522, 8.99655974288759, 3.55004645202531, -0.0484223594669954, 
    -0.0211962882086273, 0.108517866176038, 0.0436829451771807, 2.05477004364249, 
    0.873934643231189, 2.37546174314867, 0.986948953538773, -0.0803365415824891, 
    -0.0397976393266222, -0.202468822293672, -0.0831642198988624, 
    0.683646518722964, 0.295528235992906, 0.0924366608686412, 0.049751019728667, 
    -0.147617751135787, -0.0825476803768775, -0.0484223594669953, 
    -0.0211962882086273, 2.11440363446709, 1.07460619688138, -0.253132488367528, 
    -0.122431546745018, -0.322078480723854, -0.128608092664572, 0.0407600483115483, 
    0.0142635297694602, 0.671068968906244, 0.343810915084456, 1.21407143190418, 
    0.598794663267608, 1.46986836079948, 0.667669081306827, 0.1361537355086, 
    0.0809145914136465, 3.21066518473265, 1.46421515764084, 0.108517866176038, 
    0.0436829451771807, -0.253132488367528, -0.122431546745018, 1.72076151002161, 
    0.788819010597714, 1.15726286759883, 0.479294474550772, 0.907555868006653, 
    0.37524953315728, 0.409010911162119, 0.21197188164824, 0.264889436474042, 
    0.133762468111953, -0.0977626941560133, -0.038217810642213, 0.463378503740288, 
    0.232673343887845, 1.39524244544311, 0.571105723314685, 2.05477004364249, 
    0.873934643231189, -0.322078480723854, -0.128608092664572, 1.15726286759883, 
    0.479294474550772, 2.03242510010734, 0.875856487379025, 0.889988880228666, 
    0.366159165469276, 0.255979920848951, 0.131458425582294, -0.0947355673633184, 
    -0.0375343100887905, -0.0757065026113968, -0.00857034026346875, 
    -0.454024903224069, -0.193864731313794, 2.82699526222123, 1.17451838940952, 
    2.37546174314867, 0.986948953538773, 0.0407600483115482, 0.0142635297694602, 
    0.907555868006654, 0.37524953315728, 0.889988880228665, 0.366159165469276, 
    2.25664538140855, 0.936573598490948, 0.0628065538447848, 0.0150360305289274, 
    0.263502583838897, 0.103837260433807, 0.244303366377307, 0.0901128765293574, 
    0.673287774675989, 0.381659055063122, 0.50278210526703, 0.224622053100667, 
    -0.0803365415824891, -0.0397976393266222, 0.671068968906245, 
    0.343810915084456, 0.409010911162119, 0.21197188164824, 0.255979920848951, 
    0.131458425582294, 0.0628065538447848, 0.0150360305289274, 0.813695962130338, 
    0.434430884854675, 0.584365250057949, 0.280040247744536, 0.617807263893298, 
    0.2959149315065, -0.00307608832322166, -0.00619358031374817, 
    1.14607944021524, 0.575476300571173, -0.202468822293672, -0.0831642198988624, 
    1.21407143190418, 0.598794663267608, 0.264889436474041, 0.133762468111953, 
    -0.0947355673633185, -0.0375343100887906, 0.263502583838897, 
    0.103837260433807, 0.584365250057948, 0.280040247744535, 1.20478438247567, 
    0.593120159610738, 0.956520184572744, 0.411855322039163, 0.210250411751333, 
    0.111169605381947, -0.0370039133741422, -0.0299892115538773, 
    0.683646518722964, 0.295528235992906, 1.46986836079948, 0.667669081306827, 
    -0.0977626941560132, -0.038217810642213, -0.0757065026113967, 
    -0.00857034026346874, 0.244303366377307, 0.0901128765293574, 
    0.617807263893298, 0.2959149315065, 0.956520184572744, 0.411855322039163, 
    1.677317216654, 0.727147557744041, 3.16403594491333, 1.45679664056603, 
    -1.26240812734839, -0.683155437340235, 0.0855450540640345, 0.0499706615114261, 
    0.101672231072814, 0.0569765106507174, -0.0777599472697726, -0.0465889678591512, 
    1.90031565494349, 0.834935896524902, -0.736251353065747, -0.422764875185668, 
    0.785700354199547, 0.396533888743571, -0.0327543923503037, -0.00952248196965764, 
    0.413375079234698, 0.232425224788084, -1.26240812734839, -0.683155437340235, 
    7.39582555528142, 4.02476881400103, -0.286029371199752, -0.156898899952465, 
    -0.133257038877654, -0.0709737308636973, 2.91377507874665, 1.58378917157589, 
    0.957573081381303, 0.56865399899359, 2.44010883922995, 1.39699689774268, 
    0.385435424722836, 0.210622676607635, 0.849834377053873, 0.448542111108491, 
    -0.110819572199011, -0.0764394945402638, 0.085545054064034, 0.0499706615114257, 
    -0.286029371199752, -0.156898899952465, 12.3083210193512, 6.01029980551492, 
    -0.165203547838775, -0.0929997356564978, -0.246688582887577, 
    -0.141036920178665, 2.21530790028557, 1.10155117896794, 3.52403846302214, 
    1.84499434061949, -0.326792760643151, -0.178554499377057, -0.232779969179998, 
    -0.143956421389843, 0.0297138928726045, 0.0120631316840429, 0.101672231072814, 
    0.0569765106507173, -0.133257038877655, -0.0709737308636977, 
    -0.165203547838775, -0.0929997356564979, 1.77523813159974, 0.887635802280349, 
    -0.176363881536455, -0.0948958510074036, -0.331603279300571, 
    -0.180980294600311, -0.0235749682892368, -0.0237927441521546, 
    0.713030157452985, 0.387455804133353, 1.04042858267793, 0.559477254901204, 
    1.53182346550168, 0.815300498639205, -0.0777599472697724, -0.0465889678591513, 
    2.91377507874666, 1.58378917157589, -0.246688582887577, -0.141036920178665, 
    -0.176363881536455, -0.0948958510074035, 1.27812938386599, 0.692163296068237, 
    0.662603939374628, 0.383452108900387, 0.83693917820919, 0.48135812971982, 
    0.230672799189561, 0.120682873358308, 0.24288148899653, 0.128901049435271, 
    -0.101096139930338, -0.0616869876597964, 1.90031565494349, 0.834935896524902, 
    0.957573081381305, 0.568653998993591, 2.21530790028557, 1.10155117896794, 
    -0.331603279300571, -0.180980294600311, 0.662603939374629, 0.383452108900388, 
    2.92735227789613, 1.39764589789658, 0.876743405074385, 0.483931686418062, 
    0.177653142568379, 0.0966646525855505, -0.154159544147917, -0.0919232841951358, 
    -0.232743371540165, -0.127217977567469, -0.736251353065747, -0.422764875185669, 
    2.44010883922995, 1.39699689774268, 3.52403846302214, 1.84499434061949, 
    -0.0235749682892367, -0.0237927441521545, 0.836939178209189, 
    0.48135812971982, 0.876743405074385, 0.483931686418061, 2.55645153530652, 
    1.42816171702594, -0.0703452228209685, -0.0512646922740202, 0.124796227036477, 
    0.0787482113204582, 0.0163928665889852, -0.0119890026118216, 
    0.785700354199547, 0.396533888743571, 0.385435424722836, 0.210622676607635, 
    -0.326792760643151, -0.178554499377057, 0.713030157452985, 0.387455804133353, 
    0.230672799189561, 0.120682873358308, 0.177653142568379, 0.0966646525855505, 
    -0.0703452228209684, -0.0512646922740201, 0.808193174022862, 
    0.413365130689092, 0.579405575735332, 0.32380695482438, 0.860593916724285, 
    0.467815102071465, -0.0327543923503037, -0.00952248196965766, 
    0.849834377053873, 0.448542111108491, -0.232779969179998, -0.143956421389843, 
    1.04042858267793, 0.559477254901204, 0.24288148899653, 0.128901049435271, 
    -0.154159544147918, -0.091923284195136, 0.124796227036477, 0.0787482113204582, 
    0.579405575735332, 0.32380695482438, 0.928816904904006, 0.507014141762348, 
    0.999521613673402, 0.567871370825594, 0.413375079234698, 0.232425224788084, 
    -0.110819572199011, -0.076439494540264, 0.0297138928726042, 0.0120631316840427, 
    1.53182346550168, 0.815300498639205, -0.101096139930338, -0.0616869876597965, 
    -0.232743371540164, -0.127217977567469, 0.0163928665889852, -0.0119890026118217, 
    0.860593916724285, 0.467815102071465, 0.999521613673403, 0.567871370825595, 
    2.01834098365048, 1.10243755598762, 0.732337215350167, 0.732337215350167, 
    -0.404757867499704, -0.404757867499704, -0.0383720982472778, 
    -0.0383720982472778, 0.049751019728667, 0.049751019728667, 0.0809145914136465, 
    0.0809145914136465, 0.232673343887846, 0.232673343887846, -0.193864731313794, 
    -0.193864731313794, 0.381659055063122, 0.381659055063122, -0.00619358031374822, 
    -0.00619358031374822, 0.111169605381947, 0.111169605381947, -0.404757867499704, 
    -0.404757867499704, 3.94701728147071, 3.94701728147071, 0.0246647350433522, 
    0.0246647350433522, -0.0825476803768774, -0.0825476803768774, 
    1.46421515764084, 1.46421515764084, 0.571105723314685, 0.571105723314685, 
    1.17451838940952, 1.17451838940952, 0.224622053100667, 0.224622053100667, 
    0.575476300571174, 0.575476300571174, -0.0299892115538772, -0.0299892115538772, 
    -0.0383720982472778, -0.0383720982472778, 0.0246647350433522, 
    0.0246647350433522, 3.55004645202531, 3.55004645202531, -0.0211962882086273, 
    -0.0211962882086273, 0.0436829451771807, 0.0436829451771807, 
    0.873934643231189, 0.873934643231189, 0.986948953538773, 0.986948953538773, 
    -0.0397976393266222, -0.0397976393266222, -0.0831642198988624, 
    -0.0831642198988624, 0.295528235992906, 0.295528235992906, 0.049751019728667, 
    0.049751019728667, -0.0825476803768775, -0.0825476803768775, 
    -0.0211962882086273, -0.0211962882086273, 1.07460619688138, 1.07460619688138, 
    -0.122431546745018, -0.122431546745018, -0.128608092664572, -0.128608092664572, 
    0.0142635297694602, 0.0142635297694602, 0.343810915084456, 0.343810915084456, 
    0.598794663267608, 0.598794663267608, 0.667669081306827, 0.667669081306827, 
    0.0809145914136465, 0.0809145914136465, 1.46421515764084, 1.46421515764084, 
    0.0436829451771807, 0.0436829451771807, -0.122431546745018, -0.122431546745018, 
    0.788819010597714, 0.788819010597714, 0.479294474550772, 0.479294474550772, 
    0.37524953315728, 0.37524953315728, 0.21197188164824, 0.21197188164824, 
    0.133762468111953, 0.133762468111953, -0.038217810642213, -0.038217810642213, 
    0.232673343887845, 0.232673343887845, 0.571105723314685, 0.571105723314685, 
    0.873934643231189, 0.873934643231189, -0.128608092664572, -0.128608092664572, 
    0.479294474550772, 0.479294474550772, 0.875856487379025, 0.875856487379025, 
    0.366159165469276, 0.366159165469276, 0.131458425582294, 0.131458425582294, 
    -0.0375343100887905, -0.0375343100887905, -0.00857034026346875, 
    -0.00857034026346875, -0.193864731313794, -0.193864731313794, 
    1.17451838940952, 1.17451838940952, 0.986948953538773, 0.986948953538773, 
    0.0142635297694602, 0.0142635297694602, 0.37524953315728, 0.37524953315728, 
    0.366159165469276, 0.366159165469276, 0.936573598490948, 0.936573598490948, 
    0.0150360305289274, 0.0150360305289274, 0.103837260433807, 0.103837260433807, 
    0.0901128765293574, 0.0901128765293574, 0.381659055063122, 0.381659055063122, 
    0.224622053100667, 0.224622053100667, -0.0397976393266222, -0.0397976393266222, 
    0.343810915084456, 0.343810915084456, 0.21197188164824, 0.21197188164824, 
    0.131458425582294, 0.131458425582294, 0.0150360305289274, 0.0150360305289274, 
    0.434430884854675, 0.434430884854675, 0.280040247744536, 0.280040247744536, 
    0.2959149315065, 0.2959149315065, -0.00619358031374817, -0.00619358031374817, 
    0.575476300571173, 0.575476300571173, -0.0831642198988624, -0.0831642198988624, 
    0.598794663267608, 0.598794663267608, 0.133762468111953, 0.133762468111953, 
    -0.0375343100887906, -0.0375343100887906, 0.103837260433807, 
    0.103837260433807, 0.280040247744535, 0.280040247744535, 0.593120159610738, 
    0.593120159610738, 0.411855322039163, 0.411855322039163, 0.111169605381947, 
    0.111169605381947, -0.0299892115538773, -0.0299892115538773, 
    0.295528235992906, 0.295528235992906, 0.667669081306827, 0.667669081306827, 
    -0.038217810642213, -0.038217810642213, -0.00857034026346874, 
    -0.00857034026346874, 0.0901128765293574, 0.0901128765293574, 
    0.2959149315065, 0.2959149315065, 0.411855322039163, 0.411855322039163, 
    0.727147557744041, 0.727147557744041, 1.45679664056603, 1.45679664056603, 
    -0.683155437340235, -0.683155437340235, 0.0499706615114261, 0.0499706615114261, 
    0.0569765106507174, 0.0569765106507174, -0.0465889678591512, 
    -0.0465889678591512, 0.834935896524902, 0.834935896524902, -0.422764875185668, 
    -0.422764875185668, 0.396533888743571, 0.396533888743571, -0.00952248196965764, 
    -0.00952248196965764, 0.232425224788084, 0.232425224788084, -0.683155437340235, 
    -0.683155437340235, 4.02476881400103, 4.02476881400103, -0.156898899952465, 
    -0.156898899952465, -0.0709737308636973, -0.0709737308636973, 
    1.58378917157589, 1.58378917157589, 0.56865399899359, 0.56865399899359, 
    1.39699689774268, 1.39699689774268, 0.210622676607635, 0.210622676607635, 
    0.448542111108491, 0.448542111108491, -0.0764394945402638, -0.0764394945402638, 
    0.0499706615114257, 0.0499706615114257, -0.156898899952465, -0.156898899952465, 
    6.01029980551492, 6.01029980551492, -0.0929997356564978, -0.0929997356564978, 
    -0.141036920178665, -0.141036920178665, 1.10155117896794, 1.10155117896794, 
    1.84499434061949, 1.84499434061949, -0.178554499377057, -0.178554499377057, 
    -0.143956421389843, -0.143956421389843, 0.0120631316840429, 0.0120631316840429, 
    0.0569765106507173, 0.0569765106507173, -0.0709737308636977, 
    -0.0709737308636977, -0.0929997356564979, -0.0929997356564979, 
    0.887635802280349, 0.887635802280349, -0.0948958510074036, -0.0948958510074036, 
    -0.180980294600311, -0.180980294600311, -0.0237927441521546, 
    -0.0237927441521546, 0.387455804133353, 0.387455804133353, 0.559477254901204, 
    0.559477254901204, 0.815300498639205, 0.815300498639205, -0.0465889678591513, 
    -0.0465889678591513, 1.58378917157589, 1.58378917157589, -0.141036920178665, 
    -0.141036920178665, -0.0948958510074035, -0.0948958510074035, 
    0.692163296068237, 0.692163296068237, 0.383452108900387, 0.383452108900387, 
    0.48135812971982, 0.48135812971982, 0.120682873358308, 0.120682873358308, 
    0.128901049435271, 0.128901049435271, -0.0616869876597964, -0.0616869876597964, 
    0.834935896524902, 0.834935896524902, 0.568653998993591, 0.568653998993591, 
    1.10155117896794, 1.10155117896794, -0.180980294600311, -0.180980294600311, 
    0.383452108900388, 0.383452108900388, 1.39764589789658, 1.39764589789658, 
    0.483931686418062, 0.483931686418062, 0.0966646525855505, 0.0966646525855505, 
    -0.0919232841951358, -0.0919232841951358, -0.127217977567469, 
    -0.127217977567469, -0.422764875185669, -0.422764875185669, 1.39699689774268, 
    1.39699689774268, 1.84499434061949, 1.84499434061949, -0.0237927441521545, 
    -0.0237927441521545, 0.48135812971982, 0.48135812971982, 0.483931686418061, 
    0.483931686418061, 1.42816171702594, 1.42816171702594, -0.0512646922740202, 
    -0.0512646922740202, 0.0787482113204582, 0.0787482113204582, 
    -0.0119890026118216, -0.0119890026118216, 0.396533888743571, 
    0.396533888743571, 0.210622676607635, 0.210622676607635, -0.178554499377057, 
    -0.178554499377057, 0.387455804133353, 0.387455804133353, 0.120682873358308, 
    0.120682873358308, 0.0966646525855505, 0.0966646525855505, -0.0512646922740201, 
    -0.0512646922740201, 0.413365130689092, 0.413365130689092, 0.32380695482438, 
    0.32380695482438, 0.467815102071465, 0.467815102071465, -0.00952248196965766, 
    -0.00952248196965766, 0.448542111108491, 0.448542111108491, -0.143956421389843, 
    -0.143956421389843, 0.559477254901204, 0.559477254901204, 0.128901049435271, 
    0.128901049435271, -0.091923284195136, -0.091923284195136, 0.0787482113204582, 
    0.0787482113204582, 0.32380695482438, 0.32380695482438, 0.507014141762348, 
    0.507014141762348, 0.567871370825594, 0.567871370825594, 0.232425224788084, 
    0.232425224788084, -0.076439494540264, -0.076439494540264, 0.0120631316840427, 
    0.0120631316840427, 0.815300498639205, 0.815300498639205, -0.0616869876597965, 
    -0.0616869876597965, -0.127217977567469, -0.127217977567469, 
    -0.0119890026118217, -0.0119890026118217, 0.467815102071465, 
    0.467815102071465, 0.567871370825595, 0.567871370825595, 1.10243755598762, 
    1.10243755598762), dim = c(400L, 2L)), R = structure(c(0.806959980781249, 
    0.465060408440826, -0.15012844166574, -0.0471719912295285, -0.0054772639582709, 
    2.50725023975482e-06, -0.13679953832581, -0.0789326551296845, 
    -0.174209775666478, -0.0547386086117789, -0.111801136366586, 
    5.11776368813804e-05, 0, 0, 0.354532266877077, 0.204563359615329, 
    0, 0, 0, 0, -0.15012844166574, -0.0471719912295285, 7.92306714608849, 
    3.6234927012265, 0.0361972235144752, 0.0149117879687545, -0.214116413326856, 
    -0.10685602932824, 3.64126254645513, 1.66352858802696, 2.06703251533223, 
    0.851533559772321, 2.39859460869578, 0.98812369444761, 0.853949422876518, 
    0.426168378023555, 0.990927073772362, 0.494527863660446, 0, 0, 
    -0.0054772639582709, 2.50725023975482e-06, 0.0361972235144752, 
    0.0149117879687545, 8.69733503472868, 3.41847801424302, 0.189493776143906, 
    0.0817504911507417, 0.117509859270436, 0.0484092959499556, 2.0026589575095, 
    0.855668117685105, 2.27997194104548, 0.946016883740383, 0.0465430434260183, 
    0.0200793753607915, -0.0257723982217154, -0.0111186037643669, 
    0.950030012179817, 0.409857366738337, -0.13679953832581, -0.0789326551296845, 
    -0.214116413326856, -0.10685602932824, 0.189493776143906, 0.0817504911507417, 
    2.17222236024171, 1.12465144133172, -0.382358332009327, -0.190818127878481, 
    -0.366577824373101, -0.158147237325162, 0.110625600716113, 0.0477255632159658, 
    0.511777574087161, 0.259483270921948, 1.18945128595189, 0.601503903730093, 
    1.37673136571981, 0.634520344389466, -0.174209775666478, -0.0547386086117789, 
    3.64126254645513, 1.66352858802696, 0.117509859270436, 0.0484092959499556, 
    -0.382358332009327, -0.190818127878481, 2.36741207206618, 1.07956876767698, 
    2.39859460869578, 0.98812369444761, 0, 0, 0.990927073772362, 
    0.494527863660446, 0, 0, 0, 0, -0.111801136366586, 5.11776368813804e-05, 
    2.06703251533223, 0.851533559772321, 2.0026589575095, 0.855668117685105, 
    -0.366577824373101, -0.158147237325162, 2.39859460869578, 0.98812369444761, 
    4.22530983175708, 1.65571419776689, 0, 0, 0.950030012179817, 
    0.409857366738337, 0, 0, 0, 0, 0, 0, 2.39859460869578, 0.98812369444761, 
    2.27997194104548, 0.946016883740383, 0.110625600716113, 0.0477255632159658, 
    0, 0, 0, 0, 4.22530983175708, 1.65571419776689, 0, 0, 0.950030012179817, 
    0.409857366738337, 0, 0, 0.354532266877077, 0.204563359615329, 
    0.853949422876518, 0.426168378023555, 0.0465430434260183, 0.0200793753607915, 
    0.511777574087161, 0.259483270921948, 0.990927073772362, 0.494527863660446, 
    0.950030012179817, 0.409857366738337, 0, 0, 0.963106686571615, 
    0.507086312723894, 0, 0, 0, 0, 0, 0, 0.990927073772362, 0.494527863660446, 
    -0.0257723982217154, -0.0111186037643669, 1.18945128595189, 0.601503903730093, 
    0, 0, 0, 0, 0.950030012179817, 0.409857366738337, 0, 0, 0.963106686571615, 
    0.507086312723894, 0, 0, 0, 0, 0, 0, 0.950030012179817, 0.409857366738337, 
    1.37673136571981, 0.634520344389466, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0.963106686571615, 0.507086312723894, 2.08093044739714, 
    0.84862262686829, 0.396010639367342, 0.208732069812958, -0.174377580742974, 
    -0.0706188642702161, -0.213718403319721, -0.106147457023095, 
    0.346040574983699, 0.182393497232817, 1.59481546108702, 0.64586316717256, 
    0, 0, 0.490855988901092, 0.243793300797131, 0, 0, 0, 0, 0.396010639367342, 
    0.208732069812958, 5.42124565435035, 2.95562102329317, 0.0874062697201757, 
    0.0503836240941352, -0.190531545582237, -0.100995971355638, 2.47699601625188, 
    1.34369470963603, 1.6823179487865, 0.969739074895106, 1.47003694454651, 
    0.847373867522753, 0.655365188881373, 0.347392572927912, 0.572668823108172, 
    0.303557313190093, 0, 0, -0.174377580742974, -0.0706188642702161, 
    0.0874062697201757, 0.0503836240941352, 11.7312183781329, 5.66918056593454, 
    0.298386087266575, 0.161426505658916, -0.160734261892654, -0.0926521021452356, 
    1.76871980506272, 0.873162746006739, 3.61858598177806, 1.88546724649484, 
    -0.0764076850185471, -0.041336463475966, 0.128991366705331, 0.0697841704958806, 
    0.698806331033213, 0.378053364298583, -0.213718403319721, -0.106147457023095, 
    -0.190531545582237, -0.100995971355638, 0.298386087266575, 0.161426505658916, 
    1.68431363759151, 0.826355769130688, -0.249339662290081, -0.132168672192943, 
    -0.304259857626438, -0.164604208188285, 0.115698054572536, 0.0625925050067547, 
    0.4875596829683, 0.266208459858425, 0.923068408388001, 0.481198978964221, 
    1.16528653437676, 0.605295996272485, 0.346040574983699, 0.182393497232817, 
    2.47699601625188, 1.34369470963603, -0.160734261892654, -0.0926521021452356, 
    -0.249339662290081, -0.132168672192943, 1.11019651400762, 0.605608033733418, 
    1.47003694454651, 0.847373867522753, 0, 0, 0.572668823108172, 
    0.303557313190093, 0, 0, 0, 0, 1.59481546108702, 0.64586316717256, 
    1.6823179487865, 0.969739074895106, 1.76871980506272, 0.873162746006739, 
    -0.304259857626438, -0.164604208188285, 1.47003694454651, 0.847373867522753, 
    5.50645044320825, 2.64237136200229, 0, 0, 0.698806331033213, 
    0.378053364298583, 0, 0, 0, 0, 0, 0, 1.47003694454651, 0.847373867522753, 
    3.61858598177806, 1.88546724649484, 0.115698054572536, 0.0625925050067547, 
    0, 0, 0, 0, 5.50645044320825, 2.64237136200229, 0, 0, 0.698806331033213, 
    0.378053364298583, 0, 0, 0.490855988901092, 0.243793300797131, 
    0.655365188881373, 0.347392572927912, -0.0764076850185471, -0.041336463475966, 
    0.4875596829683, 0.266208459858425, 0.572668823108172, 0.303557313190093, 
    0.698806331033213, 0.378053364298583, 0, 0, 0.668643329631978, 
    0.325725012526335, 0, 0, 0, 0, 0, 0, 0.572668823108172, 0.303557313190093, 
    0.128991366705331, 0.0697841704958806, 0.923068408388001, 0.481198978964221, 
    0, 0, 0, 0, 0.698806331033213, 0.378053364298583, 0, 0, 0.668643329631978, 
    0.325725012526335, 0, 0, 0, 0, 0, 0, 0.698806331033213, 0.378053364298583, 
    1.16528653437676, 0.605295996272485, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0.668643329631978, 0.325725012526335, 0.465060408440826, 
    0.465060408440826, -0.0471719912295285, -0.0471719912295285, 
    2.50725023975482e-06, 2.50725023975482e-06, -0.0789326551296845, 
    -0.0789326551296845, -0.0547386086117789, -0.0547386086117789, 
    5.11776368813804e-05, 5.11776368813804e-05, 0, 0, 0.204563359615329, 
    0.204563359615329, 0, 0, 0, 0, -0.0471719912295285, -0.0471719912295285, 
    3.6234927012265, 3.6234927012265, 0.0149117879687545, 0.0149117879687545, 
    -0.10685602932824, -0.10685602932824, 1.66352858802696, 1.66352858802696, 
    0.851533559772321, 0.851533559772321, 0.98812369444761, 0.98812369444761, 
    0.426168378023555, 0.426168378023555, 0.494527863660446, 0.494527863660446, 
    0, 0, 2.50725023975482e-06, 2.50725023975482e-06, 0.0149117879687545, 
    0.0149117879687545, 3.41847801424302, 3.41847801424302, 0.0817504911507417, 
    0.0817504911507417, 0.0484092959499556, 0.0484092959499556, 0.855668117685105, 
    0.855668117685105, 0.946016883740383, 0.946016883740383, 0.0200793753607915, 
    0.0200793753607915, -0.0111186037643669, -0.0111186037643669, 
    0.409857366738337, 0.409857366738337, -0.0789326551296845, -0.0789326551296845, 
    -0.10685602932824, -0.10685602932824, 0.0817504911507417, 0.0817504911507417, 
    1.12465144133172, 1.12465144133172, -0.190818127878481, -0.190818127878481, 
    -0.158147237325162, -0.158147237325162, 0.0477255632159658, 0.0477255632159658, 
    0.259483270921948, 0.259483270921948, 0.601503903730093, 0.601503903730093, 
    0.634520344389466, 0.634520344389466, -0.0547386086117789, -0.0547386086117789, 
    1.66352858802696, 1.66352858802696, 0.0484092959499556, 0.0484092959499556, 
    -0.190818127878481, -0.190818127878481, 1.07956876767698, 1.07956876767698, 
    0.98812369444761, 0.98812369444761, 0, 0, 0.494527863660446, 
    0.494527863660446, 0, 0, 0, 0, 5.11776368813804e-05, 5.11776368813804e-05, 
    0.851533559772321, 0.851533559772321, 0.855668117685105, 0.855668117685105, 
    -0.158147237325162, -0.158147237325162, 0.98812369444761, 0.98812369444761, 
    1.65571419776689, 1.65571419776689, 0, 0, 0.409857366738337, 
    0.409857366738337, 0, 0, 0, 0, 0, 0, 0.98812369444761, 0.98812369444761, 
    0.946016883740383, 0.946016883740383, 0.0477255632159658, 0.0477255632159658, 
    0, 0, 0, 0, 1.65571419776689, 1.65571419776689, 0, 0, 0.409857366738337, 
    0.409857366738337, 0, 0, 0.204563359615329, 0.204563359615329, 
    0.426168378023555, 0.426168378023555, 0.0200793753607915, 0.0200793753607915, 
    0.259483270921948, 0.259483270921948, 0.494527863660446, 0.494527863660446, 
    0.409857366738337, 0.409857366738337, 0, 0, 0.507086312723894, 
    0.507086312723894, 0, 0, 0, 0, 0, 0, 0.494527863660446, 0.494527863660446, 
    -0.0111186037643669, -0.0111186037643669, 0.601503903730093, 
    0.601503903730093, 0, 0, 0, 0, 0.409857366738337, 0.409857366738337, 
    0, 0, 0.507086312723894, 0.507086312723894, 0, 0, 0, 0, 0, 0, 
    0.409857366738337, 0.409857366738337, 0.634520344389466, 0.634520344389466, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.507086312723894, 0.507086312723894, 
    0.84862262686829, 0.84862262686829, 0.208732069812958, 0.208732069812958, 
    -0.0706188642702161, -0.0706188642702161, -0.106147457023095, 
    -0.106147457023095, 0.182393497232817, 0.182393497232817, 0.64586316717256, 
    0.64586316717256, 0, 0, 0.243793300797131, 0.243793300797131, 
    0, 0, 0, 0, 0.208732069812958, 0.208732069812958, 2.95562102329317, 
    2.95562102329317, 0.0503836240941352, 0.0503836240941352, -0.100995971355638, 
    -0.100995971355638, 1.34369470963603, 1.34369470963603, 0.969739074895106, 
    0.969739074895106, 0.847373867522753, 0.847373867522753, 0.347392572927912, 
    0.347392572927912, 0.303557313190093, 0.303557313190093, 0, 0, 
    -0.0706188642702161, -0.0706188642702161, 0.0503836240941352, 
    0.0503836240941352, 5.66918056593454, 5.66918056593454, 0.161426505658916, 
    0.161426505658916, -0.0926521021452356, -0.0926521021452356, 
    0.873162746006739, 0.873162746006739, 1.88546724649484, 1.88546724649484, 
    -0.041336463475966, -0.041336463475966, 0.0697841704958806, 0.0697841704958806, 
    0.378053364298583, 0.378053364298583, -0.106147457023095, -0.106147457023095, 
    -0.100995971355638, -0.100995971355638, 0.161426505658916, 0.161426505658916, 
    0.826355769130688, 0.826355769130688, -0.132168672192943, -0.132168672192943, 
    -0.164604208188285, -0.164604208188285, 0.0625925050067547, 0.0625925050067547, 
    0.266208459858425, 0.266208459858425, 0.481198978964221, 0.481198978964221, 
    0.605295996272485, 0.605295996272485, 0.182393497232817, 0.182393497232817, 
    1.34369470963603, 1.34369470963603, -0.0926521021452356, -0.0926521021452356, 
    -0.132168672192943, -0.132168672192943, 0.605608033733418, 0.605608033733418, 
    0.847373867522753, 0.847373867522753, 0, 0, 0.303557313190093, 
    0.303557313190093, 0, 0, 0, 0, 0.64586316717256, 0.64586316717256, 
    0.969739074895106, 0.969739074895106, 0.873162746006739, 0.873162746006739, 
    -0.164604208188285, -0.164604208188285, 0.847373867522753, 0.847373867522753, 
    2.64237136200229, 2.64237136200229, 0, 0, 0.378053364298583, 
    0.378053364298583, 0, 0, 0, 0, 0, 0, 0.847373867522753, 0.847373867522753, 
    1.88546724649484, 1.88546724649484, 0.0625925050067547, 0.0625925050067547, 
    0, 0, 0, 0, 2.64237136200229, 2.64237136200229, 0, 0, 0.378053364298583, 
    0.378053364298583, 0, 0, 0.243793300797131, 0.243793300797131, 
    0.347392572927912, 0.347392572927912, -0.041336463475966, -0.041336463475966, 
    0.266208459858425, 0.266208459858425, 0.303557313190093, 0.303557313190093, 
    0.378053364298583, 0.378053364298583, 0, 0, 0.325725012526335, 
    0.325725012526335, 0, 0, 0, 0, 0, 0, 0.303557313190093, 0.303557313190093, 
    0.0697841704958806, 0.0697841704958806, 0.481198978964221, 0.481198978964221, 
    0, 0, 0, 0, 0.378053364298583, 0.378053364298583, 0, 0, 0.325725012526335, 
    0.325725012526335, 0, 0, 0, 0, 0, 0, 0.378053364298583, 0.378053364298583, 
    0.605295996272485, 0.605295996272485, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0.325725012526335, 0.325725012526335), dim = c(400L, 2L
    )))

# h_get_kr_comp works as expected on adh ungrouped mmrm

    list(P = structure(c(-0.199998493859364, -0.0338505029498785, 
    -7.46984210486336, -3.79552782010193, -10.6223174582717, -4.77109384821867, 
    -0.923352021256601, -0.467001693195501, 0.337666061800144, 0.174969915857332, 
    -7.15256781743186, -3.49251066423575, -0.498033165968337, -0.245336038102161, 
    -0.0338505029498785, -0.0338505029498785, -3.79552782010193, 
    -3.79552782010193, -4.77109384821867, -4.77109384821867, -0.467001693195501, 
    -0.467001693195501, 0.174969915857332, 0.174969915857332, -3.49251066423575, 
    -3.49251066423575, -0.245336038102161, -0.245336038102161), dim = c(14L, 
    2L)), Q = structure(c(2.66994955045082, 1.2499432082193, -2.27410161435588, 
    -1.18437421745564, 0.00397307973192792, 0.00202767603424579, 
    0.000175971891870223, 0.00010433910185568, 1.09383741212022, 
    0.570596573095757, 0.296190663721209, 0.0508008322479264, -0.0011527818463965, 
    -0.000606376281817073, -2.27410161435588, -1.18437421745564, 
    17.2197224082459, 8.77843464492795, -0.00475683985819714, -0.0023888335498068, 
    -0.00117974430513892, -0.000615953718622215, -1.76662309977278, 
    -0.920088203049556, 6.82614406444955, 3.42752520050334, -0.0153348367422203, 
    -0.00825895206829987, 0.00397307973192791, 0.00202767603424578, 
    -0.00475683985819708, -0.00238883354980677, 21.6341849175066, 
    9.73457571117222, -0.388766240836767, -0.192026857219316, -0.00232281839228216, 
    -0.000330583318702068, 6.80015956480189, 3.30096116643757, -0.456961773432882, 
    -0.225689745634572, 0.000175971891870222, 0.00010433910185568, 
    -0.00117974430513891, -0.000615953718622213, -0.388766240836766, 
    -0.192026857219316, 2.23647405576324, 1.12654185822708, -0.000223617555450565, 
    -0.000117618442161413, 0.382641341891039, 0.205734129282669, 
    1.46951572395817, 0.72522715018901, 1.09383741212022, 0.570596573095757, 
    -1.76662309977278, -0.920088203049556, -0.00232281839228217, 
    -0.00033058331870207, -0.000223617555450565, -0.000117618442161412, 
    0.949616129254575, 0.494584889504873, -0.143482297194607, -0.0721561041406843, 
    0.000252195283908835, 0.000149244323088103, 0.296190663721209, 
    0.0508008322479266, 6.82614406444955, 3.42752520050334, 6.8001595648019, 
    3.30096116643758, 0.382641341891038, 0.205734129282669, -0.143482297194607, 
    -0.0721561041406843, 7.21425095396832, 3.52338225982823, 0.158413614747846, 
    0.0804034619712102, -0.0011527818463965, -0.000606376281817074, 
    -0.0153348367422203, -0.00825895206829987, -0.456961773432882, 
    -0.225689745634572, 1.46951572395817, 0.72522715018901, 0.000252195283908835, 
    0.000149244323088102, 0.158413614747846, 0.0804034619712104, 
    2.49705168003477, 1.23349408163164, 1.2499432082193, 1.2499432082193, 
    -1.18437421745564, -1.18437421745564, 0.00202767603424579, 0.00202767603424579, 
    0.00010433910185568, 0.00010433910185568, 0.570596573095757, 
    0.570596573095757, 0.0508008322479264, 0.0508008322479264, -0.000606376281817073, 
    -0.000606376281817073, -1.18437421745564, -1.18437421745564, 
    8.77843464492795, 8.77843464492795, -0.0023888335498068, -0.0023888335498068, 
    -0.000615953718622215, -0.000615953718622215, -0.920088203049556, 
    -0.920088203049556, 3.42752520050334, 3.42752520050334, -0.00825895206829987, 
    -0.00825895206829987, 0.00202767603424578, 0.00202767603424578, 
    -0.00238883354980677, -0.00238883354980677, 9.73457571117222, 
    9.73457571117222, -0.192026857219316, -0.192026857219316, -0.000330583318702068, 
    -0.000330583318702068, 3.30096116643757, 3.30096116643757, -0.225689745634572, 
    -0.225689745634572, 0.00010433910185568, 0.00010433910185568, 
    -0.000615953718622213, -0.000615953718622213, -0.192026857219316, 
    -0.192026857219316, 1.12654185822708, 1.12654185822708, -0.000117618442161413, 
    -0.000117618442161413, 0.205734129282669, 0.205734129282669, 
    0.72522715018901, 0.72522715018901, 0.570596573095757, 0.570596573095757, 
    -0.920088203049556, -0.920088203049556, -0.00033058331870207, 
    -0.00033058331870207, -0.000117618442161412, -0.000117618442161412, 
    0.494584889504873, 0.494584889504873, -0.0721561041406843, -0.0721561041406843, 
    0.000149244323088103, 0.000149244323088103, 0.0508008322479266, 
    0.0508008322479266, 3.42752520050334, 3.42752520050334, 3.30096116643758, 
    3.30096116643758, 0.205734129282669, 0.205734129282669, -0.0721561041406843, 
    -0.0721561041406843, 3.52338225982823, 3.52338225982823, 0.0804034619712102, 
    0.0804034619712102, -0.000606376281817074, -0.000606376281817074, 
    -0.00825895206829987, -0.00825895206829987, -0.225689745634572, 
    -0.225689745634572, 0.72522715018901, 0.72522715018901, 0.000149244323088102, 
    0.000149244323088102, 0.0804034619712104, 0.0804034619712104, 
    1.23349408163164, 1.23349408163164), dim = c(98L, 2L)), R = structure(c(1.04779440132992, 
    0.40337305522532, -0.647261105894036, -0.33700774594372, -0.000285113792096988, 
    0.00145600261924331, -0.000251193925056316, -0.000120306001086874, 
    -0.337666061800144, -0.174969915857331, 0.0335702207596369, -0.0836080274537508, 
    -0.000673919354171823, -0.000322764742568052, -0.647261105894036, 
    -0.33700774594372, 15.7006762730913, 7.98519437928407, -0.1068792415474, 
    -0.0534604480151164, -0.00685171592314677, -0.00367054512137328, 
    -0.337386510028311, -0.175666151142215, 7.11899759667222, 3.57611869168951, 
    -0.0183822278698048, -0.00984757651722605, -0.000285113792096988, 
    0.00145600261924331, -0.1068792415474, -0.0534604480151164, 21.1590615305177, 
    9.49895574609604, 0.19273774136532, 0.0952363957371877, -0.000148616294723383, 
    0.000758945096229841, 6.70796065625647, 3.2552220611118, 0.517089313192315, 
    0.255506379361955, -0.000251193925056316, -0.000120306001086874, 
    -0.00685171592314677, -0.00367054512137328, 0.19273774136532, 
    0.0952363957371877, 1.66106921099609, 0.842557841776273, -0.000130935477110125, 
    -6.2709811345913e-05, 0.444607161175376, 0.237288603123955, 0.498033165968339, 
    0.245336038102161, -0.337666061800144, -0.174969915857331, -0.337386510028312, 
    -0.175666151142216, -0.000148616294723375, 0.000758945096229845, 
    -0.000130935477110125, -6.27098113459132e-05, 0.506388250263545, 
    0.262397438070621, 0.0174985635933248, -0.0435808985525399, -0.000351282190253814, 
    -0.000168241949135513, 0.0335702207596369, -0.0836080274537508, 
    7.11899759667222, 3.57611869168951, 6.70796065625647, 3.2552220611118, 
    0.444607161175376, 0.237288603123955, 0.0174985635933259, -0.0435808985525394, 
    0.342626969939535, 0.167300524358854, 1.19282092850096, 0.636613254615048, 
    -0.000673919354171823, -0.000322764742568052, -0.0183822278698048, 
    -0.00984757651722605, 0.517089313192315, 0.255506379361955, 0.498033165968339, 
    0.245336038102161, -0.000351282190253813, -0.000168241949135513, 
    1.19282092850096, 0.636613254615048, -0.450132545185531, -0.221739720972079, 
    0.40337305522532, 0.40337305522532, -0.33700774594372, -0.33700774594372, 
    0.00145600261924331, 0.00145600261924331, -0.000120306001086874, 
    -0.000120306001086874, -0.174969915857331, -0.174969915857331, 
    -0.0836080274537508, -0.0836080274537508, -0.000322764742568052, 
    -0.000322764742568052, -0.33700774594372, -0.33700774594372, 
    7.98519437928407, 7.98519437928407, -0.0534604480151164, -0.0534604480151164, 
    -0.00367054512137328, -0.00367054512137328, -0.175666151142215, 
    -0.175666151142215, 3.57611869168951, 3.57611869168951, -0.00984757651722605, 
    -0.00984757651722605, 0.00145600261924331, 0.00145600261924331, 
    -0.0534604480151164, -0.0534604480151164, 9.49895574609604, 9.49895574609604, 
    0.0952363957371877, 0.0952363957371877, 0.000758945096229841, 
    0.000758945096229841, 3.2552220611118, 3.2552220611118, 0.255506379361955, 
    0.255506379361955, -0.000120306001086874, -0.000120306001086874, 
    -0.00367054512137328, -0.00367054512137328, 0.0952363957371877, 
    0.0952363957371877, 0.842557841776273, 0.842557841776273, -6.2709811345913e-05, 
    -6.2709811345913e-05, 0.237288603123955, 0.237288603123955, 0.245336038102161, 
    0.245336038102161, -0.174969915857331, -0.174969915857331, -0.175666151142216, 
    -0.175666151142216, 0.000758945096229845, 0.000758945096229845, 
    -6.27098113459132e-05, -6.27098113459132e-05, 0.262397438070621, 
    0.262397438070621, -0.0435808985525399, -0.0435808985525399, 
    -0.000168241949135513, -0.000168241949135513, -0.0836080274537508, 
    -0.0836080274537508, 3.57611869168951, 3.57611869168951, 3.2552220611118, 
    3.2552220611118, 0.237288603123955, 0.237288603123955, -0.0435808985525394, 
    -0.0435808985525394, 0.167300524358854, 0.167300524358854, 0.636613254615048, 
    0.636613254615048, -0.000322764742568052, -0.000322764742568052, 
    -0.00984757651722605, -0.00984757651722605, 0.255506379361955, 
    0.255506379361955, 0.245336038102161, 0.245336038102161, -0.000168241949135513, 
    -0.000168241949135513, 0.636613254615048, 0.636613254615048, 
    -0.221739720972079, -0.221739720972079), dim = c(98L, 2L)))

# h_get_kr_comp works as expected on adh grouped mmrm

    list(P = structure(c(-0.0651649024101271, -0.0481904987545267, 
    -3.71756084505125, -1.72791260195227, -4.45056966881246, -1.76012067194773, 
    -0.643839128385075, -0.329112807920804, 0.200045098836735, 0.0998867544950931, 
    -3.14900301934906, -1.34388953709984, -0.572141634618655, -0.242447521224394, 
    -0.122558165148272, 0.0382515860233461, -3.83431198575756, -2.09762820552378, 
    -6.35978294252535, -3.14429904450492, -0.284016588832016, -0.121827877345612, 
    0.15096608861453, 0.0786637604740175, -4.10217068434331, -2.18241470076928, 
    0.0824304238939354, 0.0445719808599124, -0.0481904987545267, 
    -0.0481904987545267, -1.72791260195227, -1.72791260195227, -1.76012067194773, 
    -1.76012067194773, -0.329112807920804, -0.329112807920804, 0.0998867544950931, 
    0.0998867544950931, -1.34388953709984, -1.34388953709984, -0.242447521224394, 
    -0.242447521224394, 0.0382515860233461, 0.0382515860233461, -2.09762820552378, 
    -2.09762820552378, -3.14429904450492, -3.14429904450492, -0.121827877345612, 
    -0.121827877345612, 0.0786637604740175, 0.0786637604740175, -2.18241470076928, 
    -2.18241470076928, 0.0445719808599124, 0.0445719808599124), dim = c(28L, 
    2L)), Q = structure(c(0.970557923816554, 0.516497993244614, -0.838412910909378, 
    -0.419316461882817, -0.00171967917633673, -0.000751652215158456, 
    -9.55289105837933e-05, -4.88816375847298e-05, 0.501511661050996, 
    0.250893030770849, 0.0260825465436639, 0.0305435437676028, 0.000844304456001384, 
    0.000417550848593389, -0.83841291090938, -0.419316461882818, 
    8.27267170866117, 3.87474179295433, -5.13495747022347e-05, 1.27158080316045e-05, 
    0.000914241925418845, 0.000387157024997438, -0.901894315490701, 
    -0.451025033249842, 3.13418912768821, 1.31815522056415, 0.0108811587475537, 
    0.00604187100786144, -0.00171967917633673, -0.000751652215158454, 
    -5.1349574702216e-05, 1.27158080316115e-05, 8.98804567766605, 
    3.5568220325484, -0.0851353112900849, -0.035841752245825, 0.00014729072294906, 
    0.000286701340352447, 2.9731720810779, 1.248383904193, 0.272523291323963, 
    0.114765984852745, -9.55289105837926e-05, -4.88816375847294e-05, 
    0.000914241925418845, 0.000387157024997438, -0.0851353112900849, 
    -0.035841752245825, 1.3719948550454, 0.69372909270002, 0.000145166043286004, 
    7.17921484536436e-05, 0.164562283388355, 0.0906964056749341, 
    0.860034514709793, 0.363669635739587, 0.501511661050997, 0.25089303077085, 
    -0.901894315490701, -0.451025033249842, 0.000147290722949065, 
    0.000286701340352449, 0.000145166043286004, 7.17921484536438e-05, 
    0.619395885311173, 0.309699390413276, -0.0715911298858738, -0.0311914678068739, 
    -0.000274168376567095, -0.000140341586499261, 0.0260825465436638, 
    0.0305435437676028, 3.13418912768821, 1.31815522056415, 2.9731720810779, 
    1.248383904193, 0.164562283388355, 0.0906964056749341, -0.0715911298858739, 
    -0.0311914678068739, 3.05733903962127, 1.28675278458534, 0.198539088684874, 
    0.0828944221249133, 0.000844304456001384, 0.000417550848593389, 
    0.0108811587475537, 0.00604187100786145, 0.272523291323963, 0.114765984852745, 
    0.860034514709793, 0.363669635739587, -0.000274168376567097, 
    -0.000140341586499262, 0.198539088684874, 0.0828944221249133, 
    1.1835047428722, 0.498347308719806, 1.86090632254487, 0.793224236993685, 
    -1.62345745139854, -0.874346797597236, 0.00728581592925054, 0.00450032187424458, 
    0.000381643220971998, 0.000119066682614241, 0.580618371636674, 
    0.315198326559312, 0.305965798358663, 0.00840342896648296, -0.000577430709512024, 
    -0.000652023588135316, -1.62345745139855, -0.874346797597238, 
    9.30836706333005, 5.07884752672705, -0.0161606066381669, -0.00929465074200784, 
    -0.000125033778220983, 5.03326597564921e-05, -0.877003577761416, 
    -0.472296339314683, 3.73674265351868, 2.14386224292653, -0.0168463328034341, 
    -0.00776368133965639, 0.00728581592925056, 0.00450032187424459, 
    -0.016160606638167, -0.00929465074200787, 13.0865605846564, 6.49236078436186, 
    -0.35811990889673, -0.198968366484254, -0.00544369286090146, 
    -0.00011209402692559, 3.97716974525771, 2.1234455344537, -0.78207045003099, 
    -0.434508959200361, 0.000381643220972, 0.000119066682614243, 
    -0.000125033778220968, 5.03326597565006e-05, -0.35811990889673, 
    -0.198968366484254, 0.925896477118012, 0.442454721833107, -0.000103278243418352, 
    -0.000117414165739022, 0.184463171551563, 0.0891181951918551, 
    0.634633365756063, 0.353780702408328, 0.580618371636676, 0.315198326559313, 
    -0.877003577761415, -0.472296339314683, -0.00544369286090147, 
    -0.00011209402692559, -0.000103278243418353, -0.000117414165739023, 
    0.348697642943256, 0.187717544100493, -0.074351927529349, -0.0388491609153247, 
    0.00028402601718668, 9.35377388881428e-05, 0.305965798358662, 
    0.00840342896648275, 3.73674265351868, 2.14386224292653, 3.97716974525771, 
    2.1234455344537, 0.184463171551563, 0.0891181951918551, -0.0743519275293496, 
    -0.038849160915325, 4.29307219615301, 2.30901914197571, -0.0274271946823554, 
    -0.0151717280988291, -0.000577430709512015, -0.00065202358813531, 
    -0.0168463328034341, -0.00776368133965638, -0.78207045003099, 
    -0.434508959200361, 0.634633365756064, 0.353780702408328, 0.000284026017186685, 
    9.35377388881455e-05, -0.0274271946823553, -0.015171728098829, 
    1.43965063799756, 0.799749794516437, 0.516497993244614, 0.516497993244614, 
    -0.419316461882817, -0.419316461882817, -0.000751652215158456, 
    -0.000751652215158456, -4.88816375847298e-05, -4.88816375847298e-05, 
    0.250893030770849, 0.250893030770849, 0.0305435437676028, 0.0305435437676028, 
    0.000417550848593389, 0.000417550848593389, -0.419316461882818, 
    -0.419316461882818, 3.87474179295433, 3.87474179295433, 1.27158080316045e-05, 
    1.27158080316045e-05, 0.000387157024997438, 0.000387157024997438, 
    -0.451025033249842, -0.451025033249842, 1.31815522056415, 1.31815522056415, 
    0.00604187100786144, 0.00604187100786144, -0.000751652215158454, 
    -0.000751652215158454, 1.27158080316115e-05, 1.27158080316115e-05, 
    3.5568220325484, 3.5568220325484, -0.035841752245825, -0.035841752245825, 
    0.000286701340352447, 0.000286701340352447, 1.248383904193, 1.248383904193, 
    0.114765984852745, 0.114765984852745, -4.88816375847294e-05, 
    -4.88816375847294e-05, 0.000387157024997438, 0.000387157024997438, 
    -0.035841752245825, -0.035841752245825, 0.69372909270002, 0.69372909270002, 
    7.17921484536436e-05, 7.17921484536436e-05, 0.0906964056749341, 
    0.0906964056749341, 0.363669635739587, 0.363669635739587, 0.25089303077085, 
    0.25089303077085, -0.451025033249842, -0.451025033249842, 0.000286701340352449, 
    0.000286701340352449, 7.17921484536438e-05, 7.17921484536438e-05, 
    0.309699390413276, 0.309699390413276, -0.0311914678068739, -0.0311914678068739, 
    -0.000140341586499261, -0.000140341586499261, 0.0305435437676028, 
    0.0305435437676028, 1.31815522056415, 1.31815522056415, 1.248383904193, 
    1.248383904193, 0.0906964056749341, 0.0906964056749341, -0.0311914678068739, 
    -0.0311914678068739, 1.28675278458534, 1.28675278458534, 0.0828944221249133, 
    0.0828944221249133, 0.000417550848593389, 0.000417550848593389, 
    0.00604187100786145, 0.00604187100786145, 0.114765984852745, 
    0.114765984852745, 0.363669635739587, 0.363669635739587, -0.000140341586499262, 
    -0.000140341586499262, 0.0828944221249133, 0.0828944221249133, 
    0.498347308719806, 0.498347308719806, 0.793224236993685, 0.793224236993685, 
    -0.874346797597236, -0.874346797597236, 0.00450032187424458, 
    0.00450032187424458, 0.000119066682614241, 0.000119066682614241, 
    0.315198326559312, 0.315198326559312, 0.00840342896648296, 0.00840342896648296, 
    -0.000652023588135316, -0.000652023588135316, -0.874346797597238, 
    -0.874346797597238, 5.07884752672705, 5.07884752672705, -0.00929465074200784, 
    -0.00929465074200784, 5.03326597564921e-05, 5.03326597564921e-05, 
    -0.472296339314683, -0.472296339314683, 2.14386224292653, 2.14386224292653, 
    -0.00776368133965639, -0.00776368133965639, 0.00450032187424459, 
    0.00450032187424459, -0.00929465074200787, -0.00929465074200787, 
    6.49236078436186, 6.49236078436186, -0.198968366484254, -0.198968366484254, 
    -0.00011209402692559, -0.00011209402692559, 2.1234455344537, 
    2.1234455344537, -0.434508959200361, -0.434508959200361, 0.000119066682614243, 
    0.000119066682614243, 5.03326597565006e-05, 5.03326597565006e-05, 
    -0.198968366484254, -0.198968366484254, 0.442454721833107, 0.442454721833107, 
    -0.000117414165739022, -0.000117414165739022, 0.0891181951918551, 
    0.0891181951918551, 0.353780702408328, 0.353780702408328, 0.315198326559313, 
    0.315198326559313, -0.472296339314683, -0.472296339314683, -0.00011209402692559, 
    -0.00011209402692559, -0.000117414165739023, -0.000117414165739023, 
    0.187717544100493, 0.187717544100493, -0.0388491609153247, -0.0388491609153247, 
    9.35377388881428e-05, 9.35377388881428e-05, 0.00840342896648275, 
    0.00840342896648275, 2.14386224292653, 2.14386224292653, 2.1234455344537, 
    2.1234455344537, 0.0891181951918551, 0.0891181951918551, -0.038849160915325, 
    -0.038849160915325, 2.30901914197571, 2.30901914197571, -0.0151717280988291, 
    -0.0151717280988291, -0.00065202358813531, -0.00065202358813531, 
    -0.00776368133965638, -0.00776368133965638, -0.434508959200361, 
    -0.434508959200361, 0.353780702408328, 0.353780702408328, 9.35377388881455e-05, 
    9.35377388881455e-05, -0.015171728098829, -0.015171728098829, 
    0.799749794516437, 0.799749794516437), dim = c(196L, 2L)), R = structure(c(0.412912202599812, 
    0.237480373378682, -0.281230242212267, -0.140835133962389, -0.00146240340295851, 
    -0.000317131460487939, 0.000110247835666731, 5.28895532476993e-05, 
    -0.200045098836735, -0.0998867544950932, -0.0778955083822437, 
    -0.0152225514565592, 0.000454081776976727, 0.000217838129673758, 
    -0.281230242212267, -0.140835133962389, 7.66033754971461, 3.57306807927229, 
    0.0524451567350758, 0.0217299807857399, 0.00356922586509131, 
    0.00186227780890339, -0.199087883892608, -0.0996996929552871, 
    3.22689852773131, 1.3591120885564, 0.014700700593808, 0.00767023145241078, 
    -0.00146240340295851, -0.000317131460487939, 0.0524451567350758, 
    0.0217299807857399, 8.71492412602505, 3.44187912291535, 0.135232458267755, 
    0.0569493716548446, -0.00103526134530228, -0.000224502994015348, 
    2.93703445490814, 1.23355982436521, 0.55698685224787, 0.234559451642309, 
    0.000110247835666731, 5.28895532476993e-05, 0.00356922586509131, 
    0.00186227780890339, 0.135232458267755, 0.0569493716548446, 1.14876632480164, 
    0.599361076824612, 7.80464011763824e-05, 3.74414542094745e-05, 
    0.211968564440926, 0.110329712734636, 0.572141634618655, 0.242447521224394, 
    -0.200045098836735, -0.0998867544950932, -0.199087883892608, 
    -0.099699692955287, -0.00103526134530228, -0.000224502994015349, 
    7.80464011763819e-05, 3.74414542094742e-05, 0.295160022774761, 
    0.147379650404385, -0.0551436140244644, -0.0107763145709105, 
    0.000321452555675922, 0.000154211481406534, -0.0778955083822437, 
    -0.0152225514565592, 3.22689852773131, 1.3591120885564, 2.93703445490814, 
    1.23355982436521, 0.211968564440926, 0.110329712734636, -0.0551436140244641, 
    -0.0107763145709104, -0.163887960133049, -0.0699419192443228, 
    0.873042648161359, 0.454419007039002, 0.000454081776976727, 0.000217838129673758, 
    0.014700700593808, 0.00767023145241078, 0.55698685224787, 0.234559451642309, 
    0.572141634618655, 0.242447521224394, 0.000321452555675924, 0.000154211481406535, 
    0.873042648161358, 0.454419007039002, -0.375734797606488, -0.159219264611218, 
    0.665920458276907, 0.142764846577321, -0.414571456721853, -0.223585585769347, 
    -0.00633372019300415, 0.00452092545173804, 0.000101048934494407, 
    -0.000203358306404576, -0.150966088614529, -0.0786637604740175, 
    0.13336630496408, -0.0923870284063589, 0.000199369769176782, 
    -0.000401226384136742, -0.414571456721853, -0.223585585769347, 
    8.26867145977783, 4.52515139303254, -0.177099274958902, -0.102560577259905, 
    -0.00837675658194904, -0.00374881895572721, -0.148730079176995, 
    -0.0802127144431478, 3.96880437937923, 2.27480172917564, -0.0165273590914083, 
    -0.00739642801409493, -0.00633372019300415, 0.00452092545173804, 
    -0.177099274958902, -0.102560577259905, 12.9365023577285, 6.40527650697121, 
    -0.0335034775258938, -0.0186387661531941, -0.00227226136897908, 
    0.00162191002175391, 3.92508761608473, 2.09784626194878, -0.066102434571704, 
    -0.0367743264616807, 0.000101048934494407, -0.000203358306404576, 
    -0.00837675658194904, -0.00374881895572721, -0.0335034775258938, 
    -0.0186387661531941, 0.609812362837381, 0.26624669810655, 3.62519314449273e-05, 
    -7.29560526236246e-05, 0.177083068258586, 0.0845684388205002, 
    -0.0824304238939355, -0.0445719808599124, -0.150966088614529, 
    -0.0786637604740175, -0.148730079176995, -0.0802127144431477, 
    -0.00227226136897905, 0.00162191002175392, 3.6251931444927e-05, 
    -7.29560526236247e-05, 0.223593998874818, 0.116507918648053, 
    0.0478459883700078, -0.0331444189584526, 7.15251401763946e-05, 
    -0.000143942451688357, 0.13336630496408, -0.0923870284063589, 
    3.96880437937923, 2.27480172917564, 3.92508761608473, 2.09784626194878, 
    0.177083068258586, 0.0845684388205002, 0.047845988370008, -0.0331444189584524, 
    0.572632962211662, 0.304649097036744, 0.34938528170017, 0.166853715099956, 
    0.000199369769176782, -0.000401226384136742, -0.0165273590914083, 
    -0.00739642801409493, -0.066102434571704, -0.0367743264616807, 
    -0.0824304238939355, -0.0445719808599124, 7.1525140176396e-05, 
    -0.000143942451688356, 0.34938528170017, 0.166853715099956, 0.0894949627535054, 
    0.0483919356285306, 0.237480373378682, 0.237480373378682, -0.140835133962389, 
    -0.140835133962389, -0.000317131460487939, -0.000317131460487939, 
    5.28895532476993e-05, 5.28895532476993e-05, -0.0998867544950932, 
    -0.0998867544950932, -0.0152225514565592, -0.0152225514565592, 
    0.000217838129673758, 0.000217838129673758, -0.140835133962389, 
    -0.140835133962389, 3.57306807927229, 3.57306807927229, 0.0217299807857399, 
    0.0217299807857399, 0.00186227780890339, 0.00186227780890339, 
    -0.0996996929552871, -0.0996996929552871, 1.3591120885564, 1.3591120885564, 
    0.00767023145241078, 0.00767023145241078, -0.000317131460487939, 
    -0.000317131460487939, 0.0217299807857399, 0.0217299807857399, 
    3.44187912291535, 3.44187912291535, 0.0569493716548446, 0.0569493716548446, 
    -0.000224502994015348, -0.000224502994015348, 1.23355982436521, 
    1.23355982436521, 0.234559451642309, 0.234559451642309, 5.28895532476993e-05, 
    5.28895532476993e-05, 0.00186227780890339, 0.00186227780890339, 
    0.0569493716548446, 0.0569493716548446, 0.599361076824612, 0.599361076824612, 
    3.74414542094745e-05, 3.74414542094745e-05, 0.110329712734636, 
    0.110329712734636, 0.242447521224394, 0.242447521224394, -0.0998867544950932, 
    -0.0998867544950932, -0.099699692955287, -0.099699692955287, 
    -0.000224502994015349, -0.000224502994015349, 3.74414542094742e-05, 
    3.74414542094742e-05, 0.147379650404385, 0.147379650404385, -0.0107763145709105, 
    -0.0107763145709105, 0.000154211481406534, 0.000154211481406534, 
    -0.0152225514565592, -0.0152225514565592, 1.3591120885564, 1.3591120885564, 
    1.23355982436521, 1.23355982436521, 0.110329712734636, 0.110329712734636, 
    -0.0107763145709104, -0.0107763145709104, -0.0699419192443228, 
    -0.0699419192443228, 0.454419007039002, 0.454419007039002, 0.000217838129673758, 
    0.000217838129673758, 0.00767023145241078, 0.00767023145241078, 
    0.234559451642309, 0.234559451642309, 0.242447521224394, 0.242447521224394, 
    0.000154211481406535, 0.000154211481406535, 0.454419007039002, 
    0.454419007039002, -0.159219264611218, -0.159219264611218, 0.142764846577321, 
    0.142764846577321, -0.223585585769347, -0.223585585769347, 0.00452092545173804, 
    0.00452092545173804, -0.000203358306404576, -0.000203358306404576, 
    -0.0786637604740175, -0.0786637604740175, -0.0923870284063589, 
    -0.0923870284063589, -0.000401226384136742, -0.000401226384136742, 
    -0.223585585769347, -0.223585585769347, 4.52515139303254, 4.52515139303254, 
    -0.102560577259905, -0.102560577259905, -0.00374881895572721, 
    -0.00374881895572721, -0.0802127144431478, -0.0802127144431478, 
    2.27480172917564, 2.27480172917564, -0.00739642801409493, -0.00739642801409493, 
    0.00452092545173804, 0.00452092545173804, -0.102560577259905, 
    -0.102560577259905, 6.40527650697121, 6.40527650697121, -0.0186387661531941, 
    -0.0186387661531941, 0.00162191002175391, 0.00162191002175391, 
    2.09784626194878, 2.09784626194878, -0.0367743264616807, -0.0367743264616807, 
    -0.000203358306404576, -0.000203358306404576, -0.00374881895572721, 
    -0.00374881895572721, -0.0186387661531941, -0.0186387661531941, 
    0.26624669810655, 0.26624669810655, -7.29560526236246e-05, -7.29560526236246e-05, 
    0.0845684388205002, 0.0845684388205002, -0.0445719808599124, 
    -0.0445719808599124, -0.0786637604740175, -0.0786637604740175, 
    -0.0802127144431477, -0.0802127144431477, 0.00162191002175392, 
    0.00162191002175392, -7.29560526236247e-05, -7.29560526236247e-05, 
    0.116507918648053, 0.116507918648053, -0.0331444189584526, -0.0331444189584526, 
    -0.000143942451688357, -0.000143942451688357, -0.0923870284063589, 
    -0.0923870284063589, 2.27480172917564, 2.27480172917564, 2.09784626194878, 
    2.09784626194878, 0.0845684388205002, 0.0845684388205002, -0.0331444189584524, 
    -0.0331444189584524, 0.304649097036744, 0.304649097036744, 0.166853715099956, 
    0.166853715099956, -0.000401226384136742, -0.000401226384136742, 
    -0.00739642801409493, -0.00739642801409493, -0.0367743264616807, 
    -0.0367743264616807, -0.0445719808599124, -0.0445719808599124, 
    -0.000143942451688356, -0.000143942451688356, 0.166853715099956, 
    0.166853715099956, 0.0483919356285306, 0.0483919356285306), dim = c(196L, 
    2L)))

# h_get_kr_comp works as expected on ad ungrouped mmrm

    list(P = structure(c(-15.8993698389697, -7.68775292928497, -0.0427459571922485, 
    -0.0728124759607912, -6.90291962788626, -3.38002577170616, -0.528264413533309, 
    -0.229683903125313, -7.68775292928497, -7.68775292928497, -0.0728124759607912, 
    -0.0728124759607912, -3.38002577170616, -3.38002577170616, -0.229683903125313, 
    -0.229683903125313), dim = c(8L, 2L)), Q = structure(c(31.7987396779393, 
    15.3755058585699, 0.0854919143844969, 0.145624951921582, 13.8058392557725, 
    6.76005154341231, 1.05652882706662, 0.459367806250627, 0.0854919143844969, 
    0.145624951921582, 0.163519592681788, 0.0667423522809982, 0.0786683221085024, 
    0.0694168638072341, -0.121998549309934, -0.0624519452337463, 
    13.8058392557725, 6.76005154341231, 0.0786683221085025, 0.0694168638072341, 
    8.45946044094796, 4.18248155650054, 0.650865710916738, 0.327559170380666, 
    1.05652882706662, 0.459367806250627, -0.121998549309934, -0.0624519452337463, 
    0.650865710916737, 0.327559170380666, 1.24279483199986, 0.631405824013756, 
    15.3755058585699, 15.3755058585699, 0.145624951921582, 0.145624951921582, 
    6.76005154341231, 6.76005154341231, 0.459367806250627, 0.459367806250627, 
    0.145624951921582, 0.145624951921582, 0.0667423522809982, 0.0667423522809982, 
    0.0694168638072341, 0.0694168638072341, -0.0624519452337463, 
    -0.0624519452337463, 6.76005154341231, 6.76005154341231, 0.0694168638072341, 
    0.0694168638072341, 4.18248155650054, 4.18248155650054, 0.327559170380666, 
    0.327559170380666, 0.459367806250627, 0.459367806250627, -0.0624519452337463, 
    -0.0624519452337463, 0.327559170380666, 0.327559170380666, 0.631405824013756, 
    0.631405824013756), dim = c(32L, 2L)), R = structure(c(31.7987396779393, 
    15.3755058585699, 0.0854919143844979, 0.145624951921583, 13.8058392557725, 
    6.76005154341231, 1.05652882706662, 0.459367806250626, 0.0854919143844974, 
    0.145624951921583, -0.0638853024552986, -0.108820748319042, 0.730920058415065, 
    0.323877689619449, -0.316079086188582, -0.164221338232246, 13.8058392557725, 
    6.76005154341231, 0.730920058415064, 0.323877689619449, 9.62598523889269, 
    4.71337925681211, 2.10858391744658, 1.09344300061053, 1.05652882706662, 
    0.459367806250626, -0.316079086188582, -0.164221338232246, 2.10858391744658, 
    1.09344300061053, -0.337332268845133, -0.146668581440574, 15.3755058585699, 
    15.3755058585699, 0.145624951921583, 0.145624951921583, 6.76005154341231, 
    6.76005154341231, 0.459367806250626, 0.459367806250626, 0.145624951921583, 
    0.145624951921583, -0.108820748319042, -0.108820748319042, 0.323877689619449, 
    0.323877689619449, -0.164221338232246, -0.164221338232246, 6.76005154341231, 
    6.76005154341231, 0.323877689619449, 0.323877689619449, 4.71337925681211, 
    4.71337925681211, 1.09344300061053, 1.09344300061053, 0.459367806250626, 
    0.459367806250626, -0.164221338232246, -0.164221338232246, 1.09344300061053, 
    1.09344300061053, -0.146668581440574, -0.146668581440574), dim = c(32L, 
    2L)))

# h_get_kr_comp works as expected on ad grouped mmrm

    list(P = structure(c(-7.9946144790692, -3.57042447320526, -0.108141996687663, 
    -0.0452753802606195, -3.47163923624866, -1.45681055651067, -0.265601729498665, 
    -0.0538494385421337, -8.03126680224721, -4.07524156112617, 0.0191803747737689, 
    -0.0288972733106294, -3.5261219385481, -1.88866845330211, -0.301898516534215, 
    -0.186064951768661, -3.57042447320526, -3.57042447320526, -0.0452753802606195, 
    -0.0452753802606195, -1.45681055651067, -1.45681055651067, -0.0538494385421337, 
    -0.0538494385421337, -4.07524156112617, -4.07524156112617, -0.0288972733106294, 
    -0.0288972733106294, -1.88866845330211, -1.88866845330211, -0.186064951768661, 
    -0.186064951768661), dim = c(16L, 2L)), Q = structure(c(15.9892289581384, 
    7.14084894641051, 0.216283993375326, 0.0905507605212389, 6.94327847249731, 
    2.91362111302134, 0.531203458997331, 0.107698877084267, 0.216283993375326, 
    0.090550760521239, 0.11539235714713, 0.0621899877808169, 0.0976867152218088, 
    0.0360795325760812, -0.0807001398623341, -0.0489314385836247, 
    6.94327847249731, 2.91362111302134, 0.0976867152218086, 0.0360795325760811, 
    4.30583219637445, 1.78571009988193, 0.336551640101438, 0.134693412275057, 
    0.531203458997331, 0.107698877084267, -0.0807001398623341, -0.0489314385836247, 
    0.336551640101438, 0.134693412275057, 0.680665451268489, 0.322997069533122, 
    16.0625336044944, 8.15048312225233, -0.0383607495475378, 0.0577945466212587, 
    7.05224387709622, 3.77733690660423, 0.60379703306843, 0.372129903537323, 
    -0.0383607495475378, 0.0577945466212588, 0.0457112332311423, 
    0.0152928366395851, -0.00635635411668304, 0.0293621148937726, 
    -0.0436964341704709, -0.0190229287732437, 7.05224387709622, 3.77733690660423, 
    -0.00635635411668298, 0.0293621148937726, 4.26064693537731, 2.35395397766856, 
    0.334918189052063, 0.197992580515324, 0.603797033068431, 0.372129903537323, 
    -0.043696434170471, -0.0190229287732438, 0.334918189052063, 0.197992580515324, 
    0.588579042759473, 0.316652155577672, 7.14084894641051, 7.14084894641051, 
    0.0905507605212389, 0.0905507605212389, 2.91362111302134, 2.91362111302134, 
    0.107698877084267, 0.107698877084267, 0.090550760521239, 0.090550760521239, 
    0.0621899877808169, 0.0621899877808169, 0.0360795325760812, 0.0360795325760812, 
    -0.0489314385836247, -0.0489314385836247, 2.91362111302134, 2.91362111302134, 
    0.0360795325760811, 0.0360795325760811, 1.78571009988193, 1.78571009988193, 
    0.134693412275057, 0.134693412275057, 0.107698877084267, 0.107698877084267, 
    -0.0489314385836247, -0.0489314385836247, 0.134693412275057, 
    0.134693412275057, 0.322997069533122, 0.322997069533122, 8.15048312225233, 
    8.15048312225233, 0.0577945466212587, 0.0577945466212587, 3.77733690660423, 
    3.77733690660423, 0.372129903537323, 0.372129903537323, 0.0577945466212588, 
    0.0577945466212588, 0.0152928366395851, 0.0152928366395851, 0.0293621148937726, 
    0.0293621148937726, -0.0190229287732437, -0.0190229287732437, 
    3.77733690660423, 3.77733690660423, 0.0293621148937726, 0.0293621148937726, 
    2.35395397766856, 2.35395397766856, 0.197992580515324, 0.197992580515324, 
    0.372129903537323, 0.372129903537323, -0.0190229287732438, -0.0190229287732438, 
    0.197992580515324, 0.197992580515324, 0.316652155577672, 0.316652155577672
    ), dim = c(64L, 2L)), R = structure(c(15.9892289581384, 7.14084894641051, 
    0.216283993375327, 0.0905507605212392, 6.94327847249731, 2.91362111302134, 
    0.53120345899733, 0.107698877084267, 0.216283993375326, 0.0905507605212389, 
    -0.153837284201922, -0.0644064448025637, 0.354801968445114, 0.16683160753261, 
    -0.232160519203297, -0.133242996906564, 6.94327847249731, 2.91362111302134, 
    0.354801968445114, 0.16683160753261, 5.04528875271416, 2.1171640874588, 
    0.989236709897254, 0.459202592199774, 0.53120345899733, 0.107698877084267, 
    -0.232160519203297, -0.133242996906564, 0.989236709897254, 0.459202592199774, 
    -0.130509476854767, -0.0264601516952551, 16.0625336044944, 8.15048312225233, 
    -0.0383607495475377, 0.0577945466212589, 7.05224387709622, 3.77733690660423, 
    0.60379703306843, 0.372129903537323, -0.0383607495475378, 0.0577945466212588, 
    0.0284595823688335, -0.042877385855008, 0.331545436206184, 0.134454780342784, 
    -0.100537704638006, -0.0468090817445305, 7.05224387709621, 3.77733690660423, 
    0.331545436206184, 0.134454780342784, 4.67336914332101, 2.50315928531395, 
    1.12913665960621, 0.621955960581572, 0.60379703306843, 0.372129903537323, 
    -0.100537704638006, -0.0468090817445305, 1.12913665960621, 0.621955960581572, 
    -0.216051577137332, -0.133156090798627, 7.14084894641051, 7.14084894641051, 
    0.0905507605212392, 0.0905507605212392, 2.91362111302134, 2.91362111302134, 
    0.107698877084267, 0.107698877084267, 0.0905507605212389, 0.0905507605212389, 
    -0.0644064448025637, -0.0644064448025637, 0.16683160753261, 0.16683160753261, 
    -0.133242996906564, -0.133242996906564, 2.91362111302134, 2.91362111302134, 
    0.16683160753261, 0.16683160753261, 2.1171640874588, 2.1171640874588, 
    0.459202592199774, 0.459202592199774, 0.107698877084267, 0.107698877084267, 
    -0.133242996906564, -0.133242996906564, 0.459202592199774, 0.459202592199774, 
    -0.0264601516952551, -0.0264601516952551, 8.15048312225233, 8.15048312225233, 
    0.0577945466212589, 0.0577945466212589, 3.77733690660423, 3.77733690660423, 
    0.372129903537323, 0.372129903537323, 0.0577945466212588, 0.0577945466212588, 
    -0.042877385855008, -0.042877385855008, 0.134454780342784, 0.134454780342784, 
    -0.0468090817445305, -0.0468090817445305, 3.77733690660423, 3.77733690660423, 
    0.134454780342784, 0.134454780342784, 2.50315928531395, 2.50315928531395, 
    0.621955960581572, 0.621955960581572, 0.372129903537323, 0.372129903537323, 
    -0.0468090817445305, -0.0468090817445305, 0.621955960581572, 
    0.621955960581572, -0.133156090798627, -0.133156090798627), dim = c(64L, 
    2L)))

# h_get_kr_comp works as expected on spatial mmrm

    list(P = structure(c(-4.89380140648058, -2.34964529466607, -1.14964760599207, 
    -0.575685114744495, -2.34964529466607, -2.34964529466607, -0.575685114744495, 
    -0.575685114744495), dim = c(4L, 2L)), Q = structure(c(4.89380140648058, 
    2.34964529466607, 1.14964760599207, 0.575685114744495, 1.14964760599207, 
    0.575685114744495, 0.328897402706865, 0.168443424249605, 2.34964529466607, 
    2.34964529466607, 0.575685114744495, 0.575685114744495, 0.575685114744495, 
    0.575685114744495, 0.168443424249605, 0.168443424249605), dim = c(8L, 
    2L)), R = structure(c(4.89380140648058, 2.34964529466607, 1.14964760599207, 
    0.575685114744495, 1.14964760599207, 0.575685114744495, 0.959553326098124, 
    0.473967669930741, 2.34964529466607, 2.34964529466607, 0.575685114744495, 
    0.575685114744495, 0.575685114744495, 0.575685114744495, 0.473967669930741, 
    0.473967669930741), dim = c(8L, 2L)))

# h_get_kr_comp works as expected on grouped spatial mmrm

    list(P = structure(c(-2.27250743795934, -1.05580388789638, -0.522082682399275, 
    -0.247448577313772, -2.62398723262137, -1.29551324859429, -0.627067467112632, 
    -0.328169756278635, -1.05580388789638, -1.05580388789638, -0.247448577313772, 
    -0.247448577313772, -1.29551324859429, -1.29551324859429, -0.328169756278635, 
    -0.328169756278635), dim = c(8L, 2L)), Q = structure(c(2.27250743795935, 
    1.05580388789638, 0.522082682399275, 0.247448577313772, 0.522082682399275, 
    0.247448577313772, 0.147167905842805, 0.0700408683803743, 2.62398723262137, 
    1.29551324859429, 0.627067467112632, 0.328169756278635, 0.627067467112632, 
    0.328169756278635, 0.181349407866767, 0.0983065081281383, 1.05580388789638, 
    1.05580388789638, 0.247448577313772, 0.247448577313772, 0.247448577313772, 
    0.247448577313772, 0.0700408683803743, 0.0700408683803743, 1.29551324859429, 
    1.29551324859429, 0.328169756278635, 0.328169756278635, 0.328169756278635, 
    0.328169756278635, 0.0983065081281383, 0.0983065081281383), dim = c(16L, 
    2L)), R = structure(c(2.27250743795934, 1.05580388789638, 0.522082682399275, 
    0.247448577313772, 0.522082682399275, 0.247448577313772, 0.446551675734914, 
    0.214366671939396, 2.62398723262137, 1.29551324859429, 0.627067467112632, 
    0.328169756278635, 0.627067467112632, 0.328169756278635, 0.513312944165689, 
    0.259722016708985, 1.05580388789638, 1.05580388789638, 0.247448577313772, 
    0.247448577313772, 0.247448577313772, 0.247448577313772, 0.214366671939396, 
    0.214366671939396, 1.29551324859429, 1.29551324859429, 0.328169756278635, 
    0.328169756278635, 0.328169756278635, 0.328169756278635, 0.259722016708985, 
    0.259722016708985), dim = c(16L, 2L)))

# h_df_1d_kr works as expected in the standard case

    list(est = 4.22574283798881, se = 0.958582835484051, df = 188.469542953831, 
        t_stat = 4.40832308024267, p_val = 1.74717113178929e-05)

---

    list(est = 44.5138538316888, se = 0.690340153834085, df = 183.109526300275, 
        t_stat = 64.4810439961561, p_val = 8.00428173980469e-128)

# h_df_md_kr works as expected in the standard case

    list(num_df = 2L, denom_df = 188.648444482487, f_stat = 3913.7241325595, 
        p_val = 2.57603724255367e-154)

---

    list(num_df = 2L, denom_df = 188.648444482487, f_stat = 3913.7241325595, 
        p_val = 2.57603724255367e-154)

# h_kr_df works as expected in the standard case

    list(m = 188.469542953831, lambda = 1)

# h_var_adj works as expected in the standard case for Kenward-Roger

    structure(c(0.444119599330238, -0.444119599330238, -0.444119599330237, 
    0.922715039314076), dim = c(2L, 2L), dimnames = list(c("(Intercept)", 
    "ARMCDTRT"), c("(Intercept)", "ARMCDTRT")))

# h_var_adj works as expected in the standard case for Kenward-Roger-Linear

    structure(c(0.442311524488976, -0.442311524488976, -0.442311524488976, 
    0.918881052484644), dim = c(2L, 2L), dimnames = list(c("(Intercept)", 
    "ARMCDTRT"), c("(Intercept)", "ARMCDTRT")))

